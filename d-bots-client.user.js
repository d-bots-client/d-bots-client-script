// ==UserScript==
// @name         d-bots-client
// @namespace    http://github.com/davidmann4/
// @version      0.01
// @description  to be writen
// @author       David
// @license      
// @match        http://agar.io/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.4/socket.io.min.js
// @grant        none
// @run-at       document-start
// ==/UserScript==

//http://agar.io/img/background.png

var engine = 'CiAgICAoZnVuY3Rpb24gKGMsIGUpIHsKICAgICAgICB2YXIgZmlyc3QgPSB0cnVlOwogICAgICAgIGZ1bmN0aW9uIHVhKGEsIGIpIHsKICAgICAgICAgICAgaWYgKGIpIHsKICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGU7CiAgICAgICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyA4NjRFNSAqIGIpOwogICAgICAgICAgICAgICAgZCA9ICI7IGV4cGlyZXM9IiArIGQudG9HTVRTdHJpbmcoKQogICAgICAgICAgICB9IGVsc2UgZCA9ICIiOwogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAiYWdhcmlvX3JlZGlyZWN0PSIgKyBhICsgZCArICI7IHBhdGg9LyIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRjKCkgewogICAgICAgICAgICBmb3IgKHZhciBhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCI7IiksIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKykgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IGFbYl07CiAgICAgICAgICAgICAgICAgICAgIiAiID09IGQuY2hhckF0KDApIDspIGQgPSBkLnN1YnN0cmluZygxLCBkLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBpZiAoMCA9PSBkLmluZGV4T2YoImFnYXJpb19yZWRpcmVjdD0iKSkgcmV0dXJuIGQuc3Vic3RyaW5nKDE2LCBkLmxlbmd0aCkKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSWIoKSB7CiAgICAgICAgICAgIGMub25rZXlkb3duID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSCBDRSBDT0RFIEEgUkFQQVRSSUVSIERBTlMgTk9UUkVLRVlET1dOCiAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDY5KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgc3BsaXQgIScgKyBiWzBdKTsKICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgnc3BsaXQnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICJjbGllbnRfdXVpZCI6IDgKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChhLmtleUNvZGUgPT0gODIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZW1pdCBmZWVkICEnKTsKICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgnZmVlZCcsIHsKICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgIDMyICE9IGEua2V5Q29kZSB8fCB2YSB8fCAoIm5pY2siICE9IGEudGFyZ2V0LmlkICYmIGEucHJldmVudERlZmF1bHQoKSwgZWIoKSwgdmEgPSAhMCk7CiAgICAgICAgICAgICAgICA4MSA9PSBhLmtleUNvZGUgJiYgKFgoMTgpLCB3YSA9ICEwKTsKICAgICAgICAgICAgICAgIDg3ICE9IGEua2V5Q29kZSB8fCB4YSB8fCAoSmIoKSwgeGEgPSAhMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgMjcgPT0gYS5rZXlDb2RlICYmIChhLnByZXZlbnREZWZhdWx0KCksIHlhKDMwMCksIGUoIiNvZmVyd2FsbENvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VPZmZlcndhbGwoKSwgZSgiI3ZpZGVvQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgYy5jbG9zZVZpZGVvQ29udGFpbmVyKCkpCiAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICB9CiAgICAgICAgICAgIGMub25rZXl1cCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAzMiA9PSBhLmtleUNvZGUgJiYgKHZhID0gITEpOwogICAgICAgICAgICAgICAgODcgPT0gYS5rZXlDb2RlICYmICh4YSA9ICExKTsKICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiB3YSAmJiAoWCgxOSksIHdhID0gITEpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEtiKGEpIHsKICAgICAgICAgICAgYS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgIFAgKj0gTWF0aC5wb3coLjksIGEud2hlZWxEZWx0YSAvIC0xMjAgfHwgYS5kZXRhaWwgfHwgMCk7CiAgICAgICAgICAgIGlmICgxIDwgUCkKICAgICAgICAgICAgICAgIFAgPSAxOwogICAgICAgICAgICAvKgogICAgICAgICAgICBQICo9IE1hdGgucG93KC45LCBhLndoZWVsRGVsdGEgLyAtMTIwIHx8IGEuZGV0YWlsIHx8IDApOwogICAgICAgICAgICAxID4gUCAmJiAoUCA9IDEpOwogICAgICAgICAgICBQID4gNCAvIGwgJiYgKFAgPSA0IC8gbCkqLwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdWMoKSB7CiAgICAgICAgICAgIGlmICguNCA+IGwpIGlhID0gbnVsbDsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLCBiID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLCBkID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBjID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBnID0gMDsgZyA8IEEubGVuZ3RoOyBnKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IEFbZ107CiAgICAgICAgICAgICAgICAgICAgIWUuUigpIHx8IGUuViB8fCAyMCA+PSBlLnNpemUgKiBsIHx8IChhID0gTWF0aC5taW4oZS54IC0gZS5zaXplLCBhKSwgYiA9IE1hdGgubWluKGUueSAtIGUuc2l6ZSwgYiksIGQgPSBNYXRoLm1heChlLnggKyBlLnNpemUsIGQpLCBjID0gTWF0aC5tYXgoZS55ICsgZS5zaXplLCBjKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlhID0gdmMuaW5pdCh7CiAgICAgICAgICAgICAgICAgICAgemE6IGEgLSAxMCwKICAgICAgICAgICAgICAgICAgICBBYTogYiAtIDEwLAogICAgICAgICAgICAgICAgICAgIHhhOiBkICsgMTAsCiAgICAgICAgICAgICAgICAgICAgeWE6IGMgKyAxMCwKICAgICAgICAgICAgICAgICAgICBIYTogMiwKICAgICAgICAgICAgICAgICAgICBJYTogNAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBmb3IgKGcgPSAwOyBnIDwgQS5sZW5ndGg7IGcrKykKICAgICAgICAgICAgICAgICAgICBpZiAoZSA9IEFbZ10sIGUuUigpICYmICEoMjAgPj0gZS5zaXplICogbCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYSA9IDA7IGEgPCBlLmEubGVuZ3RoOyArK2EpIGIgPSBlLmFbYV0ueCwgZCA9IGUuYVthXS55LCBiIDwgeSAtIHIgLyAyIC8gbCB8fCBkIDwgeiAtIHQgLyAyIC8gbCB8fCBiID4geSArIHIgLyAyIC8gbCB8fCBkID4geiArIHQgLyAyIC8gbCB8fCBpYS50YShlLmFbYV0pCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGZiKCkgewogICAgICAgICAgICB6YSA9IChZIC0gciAvIDIpIC8gbCArIHk7CiAgICAgICAgICAgIEFhID0gKFogLSB0IC8gMikgLyBsICsgegogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gTGIoKSB7CiAgICAgICAgICAgIG51bGwgPT0gQmEgJiYgKEJhID0ge30sIGUoIiNyZWdpb24iKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGEgPSBlKHRoaXMpLAogICAgICAgICAgICAgICAgICAgIGIgPSBhLnZhbCgpOwogICAgICAgICAgICAgICAgYiAmJiAoQmFbYl0gPSBhLnRleHQoKSkKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBlLmdldChDYSArICJpbmZvIiwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIHZhciBiID0ge30sCiAgICAgICAgICAgICAgICAgICAgZDsKICAgICAgICAgICAgICAgIGZvciAoZCBpbiBhLnJlZ2lvbnMpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGQuc3BsaXQoIjoiKVswXTsKICAgICAgICAgICAgICAgICAgICBiW2NdID0gYltjXSB8fCAwOwogICAgICAgICAgICAgICAgICAgIGJbY10gKz0gYS5yZWdpb25zW2RdLm51bVBsYXllcnMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAoZCBpbiBiKSBlKCcjcmVnaW9uIG9wdGlvblt2YWx1ZT0iJyArIGQgKyAnIl0nKS50ZXh0KEJhW2RdICsgIiAoIiArIGJbZF0gKyAiIHBsYXllcnMpIikKICAgICAgICAgICAgfSwgImpzb24iKQogICAgICAgIH0KCgogICAgICAgIGZ1bmN0aW9uIE1iKCkgewogICAgICAgICAgICBlKCIjYWRzQm90dG9tIikuaGlkZSgpOwogICAgICAgICAgICBlKCIjb3ZlcmxheXMiKS5oaWRlKCk7CiAgICAgICAgICAgIGUoIiNzdGF0cyIpLmhpZGUoKTsKICAgICAgICAgICAgZSgiI21haW5QYW5lbCIpLmhpZGUoKTsKICAgICAgICAgICAgYWEgPSBqYSA9ICExOwogICAgICAgICAgICBOYigpOwogICAgICAgICAgICBjLmRlc3Ryb3lBZChjLmFkU2xvdHMuYWEpOwogICAgICAgICAgICBjLmRlc3Ryb3lBZChjLmFkU2xvdHMuYWMpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBEYShhKSB7CiAgICAgICAgICAgIGEgJiYgKGEgPT0gRyA/IGUoIi5idG4tbmVlZHMtc2VydmVyIikucHJvcCgiZGlzYWJsZWQiLCAhMSkgOiAoZSgiI3JlZ2lvbiIpLnZhbCgpICE9IGEgJiYgZSgiI3JlZ2lvbiIpLnZhbChhKSwgRyA9IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uID0gYSwgZSgiLnJlZ2lvbi1tZXNzYWdlIikuaGlkZSgpLCBlKCIucmVnaW9uLW1lc3NhZ2UuIiArIGEpLnNob3coKSwgZSgiLmJ0bi1uZWVkcy1zZXJ2ZXIiKS5wcm9wKCJkaXNhYmxlZCIsICExKSwgZ2IgJiYgUSgpKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHlhKGEpIHsKICAgICAgICAgICAgamEgfHwgYWEgfHwgKEVhID8gZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITApIDogZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITEpLCBOID0gbnVsbCwgaGIgfHwgKGUoIiNhZHNCb3R0b20iKS5zaG93KCksIGUoIiNnMzAweDI1MCIpLmhpZGUoKSwgZSgiI2EzMDB4MjUwIikuc2hvdygpLCBlKCIjZzcyOHg5MCIpLmhpZGUoKSwgZSgiI2E3Mjh4OTAiKS5zaG93KCkpLCBjLnJlZnJlc2hBZChoYiA/IGMuYWRTbG90cy5hYyA6IGMuYWRTbG90cy5hYSksIGhiID0gITEsIDFFMyA+IGEgJiYgKEIgPSAxKSwgamEgPSAhMCwgZSgiI21haW5QYW5lbCIpLnNob3coKSwgMCA8IGEgPyBlKCIjb3ZlcmxheXMiKS5mYWRlSW4oYSkgOiBlKCIjb3ZlcmxheXMiKS5zaG93KCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBrYShhKSB7CiAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtZ2FtZW1vZGUiLCBhKTsKICAgICAgICAgICAgbGEgPSBhOwogICAgICAgICAgICBlKCIjZ2FtZW1vZGUiKS52YWwoYSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE5iKCkgewogICAgICAgICAgICBlKCIjcmVnaW9uIikudmFsKCkgPyBjLmxvY2FsU3RvcmFnZS5sb2NhdGlvbiA9IGUoIiNyZWdpb24iKS52YWwoKSA6IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uICYmIGUoIiNyZWdpb24iKS52YWwoYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24pOwogICAgICAgICAgICBlKCIjcmVnaW9uIikudmFsKCkgPyBlKCIjbG9jYXRpb25Lbm93biIpLmFwcGVuZChlKCIjcmVnaW9uIikpIDogZSgiI2xvY2F0aW9uVW5rbm93biIpLmFwcGVuZChlKCIjcmVnaW9uIikpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpYihhKSB7CiAgICAgICAgICAgICJlbnZfbG9jYWwiIGluIEVudkNvbmZpZyA/ICJ0cnVlIiA9PSBFbnZDb25maWcubG9hZF9sb2NhbF9jb25maWd1cmF0aW9uID8gYy5NQy51cGRhdGVDb25maWd1cmF0aW9uSUQoImJhc2UiKSA6IGMuTUMudXBkYXRlQ29uZmlndXJhdGlvbklEKEVudkNvbmZpZy5jb25maWdJRCkgOiBjLk1DLnVwZGF0ZUNvbmZpZ3VyYXRpb25JRChhKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gd2MoKSB7CiAgICAgICAgICAgICJjb25maWdJRCIgaW4gRCA/IGliKEQuY29uZmlnSUQpIDogZS5nZXQoQ2EgKyAiZ2V0TGF0ZXN0SUQiLCBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgaWIoYSk7CiAgICAgICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5sYXN0X2NvbmZpZ19pZCA9IGEKICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgICAgIGlmIChhID0gImxhc3RfY29uZmlnX2lkIiBpbiBjLmxvY2FsU3RvcmFnZSkgYSA9IGMubG9jYWxTdG9yYWdlLmxhc3RfY29uZmlnX2lkLCBhID0gIShudWxsID09IGEgfHwgdm9pZCAwID09IGEgfHwgIiIgPT09IGEpOwogICAgICAgICAgICAgICAgYSAmJiAoYSA9IGMubG9jYWxTdG9yYWdlLmxhc3RfY29uZmlnX2lkLCBjb25zb2xlLmxvZygiRmFsbGJhY2sgdG8gc3RvcmVkIGNvbmZpZ0lEOiAiICsgYSksIGliKGEpKQogICAgICAgICAgICB9KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24geGMoKSB7CiAgICAgICAgICAgIGUuZ2V0KGpiICsgIi8vZ2MuYWdhci5pbyIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICB2YXIgYiA9IGEuc3BsaXQoIiAiKTsKICAgICAgICAgICAgICAgIGEgPSBiWzBdOwogICAgICAgICAgICAgICAgYiA9IGJbMV0gfHwgIiI7IC0xID09IFsiVUEiXS5pbmRleE9mKGEpICYmIE9iLnB1c2goInVzc3IiKTsKICAgICAgICAgICAgICAgIG1hLmhhc093blByb3BlcnR5KGEpICYmICgic3RyaW5nIiA9PSB0eXBlb2YgbWFbYV0gPyBHIHx8IERhKG1hW2FdKSA6IG1hW2FdLmhhc093blByb3BlcnR5KGIpICYmIChHIHx8IERhKG1hW2FdW2JdKSkpCiAgICAgICAgICAgIH0sICJ0ZXh0IikKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFIoYSkgewogICAgICAgICAgICByZXR1cm4gYy5pMThuW2FdIHx8IGMuaTE4bl9kaWN0LmVuW2FdIHx8IGEKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFBiKCkgewogICAgICAgICAgICB2YXIgYSA9ICsra2I7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGaW5kICIgKyBHICsgbGEpOwogICAgICAgICAgICBRYigpOwogICAgICAgICAgICBlLmFqYXgoQ2EgKyAiZmluZFNlcnZlciIsIHsKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBnZXQgc2VydmVyLiBXaWxsIHJldHJ5IGluIDMwIHNlY29uZHMiKTsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KFBiLCAzRTQpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PSBrYikgewogICAgICAgICAgICAgICAgICAgICAgICBiLmFsZXJ0ICYmIGFsZXJ0KGIuYWxlcnQpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGIuaXA7CiAgICAgICAgICAgICAgICAgICAgICAgICJnYW1lX3NlcnZlcl9wb3J0IiBpbiBFbnZDb25maWcgJiYgKGQgPSBjLmxvY2F0aW9uLmhvc3RuYW1lICsgIjoiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVudkNvbmZpZy5nYW1lX3NlcnZlcl9wb3J0KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGIoIndzIiArIChtYiA/ICJzIiA6ICIiKSArICI6Ly8iICsgZCwgYi50b2tlbikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgY2FjaGU6ICExLAogICAgICAgICAgICAgICAgY3Jvc3NEb21haW46ICEwLAogICAgICAgICAgICAgICAgZGF0YTogKEcgKyBsYSB8fCAiPyIpICsgIlxuMjIwMDA0OTcxNSIKICAgICAgICAgICAgfSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFEoKSB7CiAgICAgICAgICAgIGdiICYmIEcgJiYgKGUoIiNjb25uZWN0aW5nIikuc2hvdygpLCBQYigpKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUWIoKSB7CiAgICAgICAgICAgIGlmICh3KSB7CiAgICAgICAgICAgICAgICB3Lm9ub3BlbiA9IG51bGw7CiAgICAgICAgICAgICAgICB3Lm9ubWVzc2FnZSA9IG51bGw7CiAgICAgICAgICAgICAgICB3Lm9uY2xvc2UgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB3LmNsb3NlKCkKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGEpIHsgfQogICAgICAgICAgICAgICAgdyA9IG51bGwKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbGIoYSwgYikgewogICAgICAgICAgICBRYigpOwogICAgICAgICAgICBELmlwICYmIChhID0gIndzIiArIChtYiA/ICJzIiA6ICIiKSArICI6Ly8iICsgRC5pcCk7CiAgICAgICAgICAgIGlmIChudWxsICE9IFMpIHsKICAgICAgICAgICAgICAgIHZhciBkID0gUzsKICAgICAgICAgICAgICAgIFMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZChiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtYiAmJiAhRW52Q29uZmlnLmVudl9kZXZlbG9wbWVudCAmJiAhRW52Q29uZmlnLmVudl9sb2NhbCkgewogICAgICAgICAgICAgICAgdmFyIGMgPSBhLnNwbGl0KCI6Iik7CiAgICAgICAgICAgICAgICBhID0gIndzczovL2lwLSIgKyBjWzFdLnJlcGxhY2UoL1wuL2csICItIikucmVwbGFjZSgvXC8vZywgIiIpICsgIi50ZWNoLmFnYXIuaW86IiArICtjWzJdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgRSA9IFtdOwogICAgICAgICAgICBxID0gW107CiAgICAgICAgICAgIEsgPSB7fTsKICAgICAgICAgICAgQSA9IFtdOwogICAgICAgICAgICBiYSA9IFtdOwogICAgICAgICAgICBDID0gW107CiAgICAgICAgICAgIEggPSBJID0gbnVsbDsKICAgICAgICAgICAgVCA9IDA7CiAgICAgICAgICAgIG5hID0gITE7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJDb25uZWN0aW5nIHRvICIgKyBhKTsKICAgICAgICAgICAgbS5jYWNoZS5zZW50R2FtZVNlcnZlckxvZ2luID0gITE7CiAgICAgICAgICAgIHcgPSBuZXcgV2ViU29ja2V0KGEpOwogICAgICAgICAgICB3LmJpbmFyeVR5cGUgPSAiYXJyYXlidWZmZXIiOwogICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgIGlwID0gYTsKICAgICAgICAgICAgcm9vbSA9IGI7CiAgICAgICAgICAgIGNoYW5nZUdhbWVNb2RlKCk7CiAgICAgICAgICAgIHcub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICBGYSA9IHggPSBEYXRlLm5vdygpOwogICAgICAgICAgICAgICAgb2EgPSAxMjA7CiAgICAgICAgICAgICAgICBHYSA9IDA7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic29ja2V0IG9wZW4iKTsKICAgICAgICAgICAgICAgIGEgPSBVKDUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50OCgwLCAyNTQpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50MzIoMSwgNSwgITApOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIGEgPSBVKDUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50OCgwLCAyNTUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50MzIoMSwgMjIwMDA0OTcxNSwgITApOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIGEgPSBVKDEgKyBiLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDgwKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgYi5sZW5ndGg7ICsrZCkgYS5zZXRVaW50OChkICsgMSwgYi5jaGFyQ29kZUF0KGQpKTsKICAgICAgICAgICAgICAgIFYoYSk7CiAgICAgICAgICAgICAgICBtLmNvcmUucHJveHkub25Tb2NrZXRPcGVuKCkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdy5vbm1lc3NhZ2UgPSB5YzsKICAgICAgICAgICAgdy5vbmNsb3NlID0gemM7CiAgICAgICAgICAgIHcub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgc29ja2V0IGVycm9yIiwgYXJndW1lbnRzKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBVKGEpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoYSkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBWKGEpIHsKICAgICAgICAgICAgdy5zZW5kKGEuYnVmZmVyKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gemMoKSB7CiAgICAgICAgICAgIG5hICYmIChJYSA9IDUwMCk7CiAgICAgICAgICAgIG0uY29yZS5wcm94eS5vblNvY2tldENsb3NlZCgpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhIYS5MKCkgKyAiIHNvY2tldCBjbG9zZSIpOwogICAgICAgICAgICBzZXRUaW1lb3V0KFEsIElhKTsKICAgICAgICAgICAgSWEgKj0gMgogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24geWMoYSkgewogICAgICAgICAgICBBYyhuZXcgRGF0YVZpZXcoYS5kYXRhKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEFjKGEpIHsKICAgICAgICAgICAgZnVuY3Rpb24gYigpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAiIjsgOykgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5nZXRVaW50MTYoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gMjsKICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSBjKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBiICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGQgPSAwOwogICAgICAgICAgICBpZiAoMjQwID09IGEuZ2V0VWludDgoZCkpIEphKCk7CiAgICAgICAgICAgIGVsc2Ugc3dpdGNoIChhLmdldFVpbnQ4KGQrKykpIHsKICAgICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICAgICAgQmMoYSwgZCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgICAgIHBhID0gYS5nZXRGbG9hdDMyKGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgcWEgPSBhLmdldEZsb2F0MzIoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICByYSA9IGEuZ2V0RmxvYXQzMihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICAgICAgICBFID0gW107CiAgICAgICAgICAgICAgICAgICAgcSA9IFtdOwogICAgICAgICAgICAgICAgICAgIEsgPSB7fTsKICAgICAgICAgICAgICAgICAgICBBID0gW107CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgICAgIHEgPSBbXTsKICAgICAgICAgICAgICAgICAgICBFID0gW107CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgICAgIG5iID0gYS5nZXRJbnQxNihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSAyOwogICAgICAgICAgICAgICAgICAgIG9iID0gYS5nZXRJbnQxNihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSAyOwogICAgICAgICAgICAgICAgICAgIHBiIHx8IChwYiA9ICEwLCBLYSA9IG5iLCBMYSA9IG9iKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgICAgICAgRS5wdXNoKGEuZ2V0VWludDMyKGQsICEwKSk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA0OToKICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBJKSBicmVhazsKICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IGEuZ2V0VWludDMyKGQsICEwKSwKICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGQgKyA0OwogICAgICAgICAgICAgICAgICAgIEMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBnID0gMDsgZyA8IHU7ICsrZykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGEuZ2V0VWludDMyKGQsICEwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBkICsgNDsKICAgICAgICAgICAgICAgICAgICAgICAgQy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYigpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhYm8gPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgYWJvLmFjdGlvbiA9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGFiby5sZWFkZXJCb2FyZCA9IEM7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoYWJvKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFJiKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDUwOgogICAgICAgICAgICAgICAgICAgIEkgPSBbXTsKICAgICAgICAgICAgICAgICAgICB1ID0gYS5nZXRVaW50MzIoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBmb3IgKGcgPSAwOyBnIDwgdTsgKytnKSBJLnB1c2goYS5nZXRGbG9hdDMyKGQsICEwKSksIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBSYigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA2NDoKICAgICAgICAgICAgICAgICAgICBNYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA4OwogICAgICAgICAgICAgICAgICAgIE5hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgT2EgPSBhLmdldEZsb2F0NjQoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBQYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgbWFwQ29vcmRzKE1hLCBOYSwgT2EsIFBhKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgcGEgPSAoT2EgKyBNYSkgLyAyOwogICAgICAgICAgICAgICAgICAgIHFhID0gKFBhICsgTmEpIC8gMjsKICAgICAgICAgICAgICAgICAgICByYSA9IDE7CiAgICAgICAgICAgICAgICAgICAgMCA9PSBxLmxlbmd0aCAmJiAoeSA9IHBhLCB6ID0gcWEsIGwgPSByYSk7CiAgICAgICAgICAgICAgICAgICAgYS5ieXRlTGVuZ3RoID4gZCAmJiAodSA9IGEuZ2V0VWludDMyKGQsICEwKSwgZCArPSA0LCBxYiA9ICEhKHUgJiAxKSwgcmIgPSBiKCksIGMuTUMudXBkYXRlU2VydmVyVmVyc2lvbihyYiksIGNvbnNvbGUubG9nKCJTZXJ2ZXIgdmVyc2lvbiAiICsgcmIpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTAyOgogICAgICAgICAgICAgICAgICAgIHUgPSBhLmJ1ZmZlci5zbGljZShkKTsKICAgICAgICAgICAgICAgICAgICBtLmNvcmUucHJveHkuZm9yd2FyZFByb3RvTWVzc2FnZSh1KTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTA0OgogICAgICAgICAgICAgICAgICAgIGMubG9nb3V0KCkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQmMoYSwgYikgewogICAgICAgICAgICBmdW5jdGlvbiBkKCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9ICIiOyA7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLmdldFVpbnQxNihiLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYiArPSAyOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09CiAgICAgICAgICAgICAgICAgICAgICAgIGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gdSgpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAiIjsgOykgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5nZXRVaW50OChiKyspOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09IGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGQKICAgICAgICAgICAgfQogICAgICAgICAgICB4ID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgdmFyIGcgPSB4IC0gRmE7CiAgICAgICAgICAgIEZhID0geDsKICAgICAgICAgICAgb2EgPSBDYyAqIG9hICsgRGMgKiBnOwogICAgICAgICAgICBHYSA9IEVjICogR2EgKyBGYyAqIE1hdGguYWJzKGcgLSBvYSk7CiAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyAmJiAobS5kZWJ1Zy51cGRhdGVDaGFydCgibmV0d29ya1VwZGF0ZSIsIHgsIGcpLCBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJydHRNZWFuIiwgeCwgb2EpLCBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJydHRTRGV2IiwgeCwgR2EpKTsKICAgICAgICAgICAgbmEgfHwgKG5hID0gITAsIGUoIiNjb25uZWN0aW5nIikuaGlkZSgpLCBTYigpLCBTICYmIChTKCksIFMgPSBudWxsKSk7CiAgICAgICAgICAgIHNiID0gITE7CiAgICAgICAgICAgIGcgPSBhLmdldFVpbnQxNihiLCAhMCk7CiAgICAgICAgICAgIGIgKz0gMjsKICAgICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBnOyArK3ApIHsKICAgICAgICAgICAgICAgIHZhciBMID0gS1thLmdldFVpbnQzMihiLCAhMCldLAogICAgICAgICAgICAgICAgICAgIGsgPSBLW2EuZ2V0VWludDMyKGIgKyA0LCAhMCldOwogICAgICAgICAgICAgICAgYiArPSA4OwogICAgICAgICAgICAgICAgTCAmJiBrICYmIChrLmNhKCksIGsucyA9IGsueCwgay51ID0gay55LCBrLm8gPSBrLnNpemUsIGsubmEoTC54LCBMLnkpLCBrLmcgPSBrLnNpemUsIGsuVSA9IHgsIEdjKEwsIGspKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAocCA9IDA7IDspIHsKICAgICAgICAgICAgICAgIGcgPSBhLmdldFVpbnQzMihiLCAhMCk7CiAgICAgICAgICAgICAgICBiICs9IDQ7CiAgICAgICAgICAgICAgICBpZiAoMCA9PSBnKSBicmVhazsKICAgICAgICAgICAgICAgICsrcDsKICAgICAgICAgICAgICAgIHZhciB0YiwgTCA9IGEuZ2V0SW50MzIoYiwgITApOwogICAgICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICAgICAgayA9IGEuZ2V0SW50MzIoYiwgITApOwogICAgICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICAgICAgdGIgPSBhLmdldEludDE2KGIsICEwKTsKICAgICAgICAgICAgICAgIGIgKz0gMjsKICAgICAgICAgICAgICAgIHZhciBuID0gYS5nZXRVaW50OChiKyspLAogICAgICAgICAgICAgICAgICAgIGYgPSBhLmdldFVpbnQ4KGIrKyksCiAgICAgICAgICAgICAgICAgICAgaCA9IGEuZ2V0VWludDgoYisrKSwKICAgICAgICAgICAgICAgICAgICBmID0gSGMobiA8PCAxNiB8IGYgPDwgOCB8IGgpLAogICAgICAgICAgICAgICAgICAgIGggPSBhLmdldFVpbnQ4KGIrKyksCiAgICAgICAgICAgICAgICAgICAgbCA9ICEhKGggJiAxKSwKICAgICAgICAgICAgICAgICAgICByID0gISEoaCAmIDE2KSwKICAgICAgICAgICAgICAgICAgICB0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGggJiAyICYmIChiICs9IDQgKyBhLmdldFVpbnQzMihiLCAhMCkpOwogICAgICAgICAgICAgICAgaCAmIDQgJiYgKHQgPSB1KCkpOwogICAgICAgICAgICAgICAgdmFyIHYgPSBkKCksCiAgICAgICAgICAgICAgICAgICAgbiA9IG51bGw7CiAgICAgICAgICAgICAgICBLLmhhc093blByb3BlcnR5KGcpID8gKG4gPSBLW2ddLCBuLlQoKSwgbi5zID0gbi54LCBuLnUgPSBuLnksIG4ubyA9IG4uc2l6ZSwgbi5jb2xvciA9IGYpIDogKG4gPSBuZXcgY2EoZywgTCwgaywgdGIsIGYsIHYpLCBBLnB1c2gobiksIEtbZ10gPSBuKTsKICAgICAgICAgICAgICAgIG4uYyA9IGw7CiAgICAgICAgICAgICAgICBuLmggPSByOwogICAgICAgICAgICAgICAgbi5uYShMLCBrKTsKICAgICAgICAgICAgICAgIG4uZyA9IHRiOwogICAgICAgICAgICAgICAgbi5VID0geDsKICAgICAgICAgICAgICAgIG4uZWEgPSBoOwogICAgICAgICAgICAgICAgdCAmJiAobi5DID0gdCk7CiAgICAgICAgICAgICAgICB2ICYmIG4uQSh2KTsgLTEgIT0gRS5pbmRleE9mKGcpICYmIC0xID09IHEuaW5kZXhPZihuKSAmJiAocS5wdXNoKG4pLCBuLkkgPSAhMCwgMSA9PSBxLmxlbmd0aCAmJiAobi51YSA9ICEwLCB5ID0gbi54LCB6ID0gbi55LCBUYigpLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3ZlcmxheXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiLCBGID0gW10sIHViID0gMCwgdmIgPSBxWzBdLmNvbG9yLCBFYSA9ICEwLCBSYSA9IERhdGUubm93KCksIFcgPSB3YiA9IHhiID0gMCkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgTCA9IGEuZ2V0VWludDMyKGIsICEwKTsKICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICBmb3IgKHAgPSAwOyBwIDwgTDsgcCsrKSBnID0gYS5nZXRVaW50MzIoYiwgITApLCBiICs9IDQsIG4gPSBLW2ddLCBudWxsICE9IG4gJiYgbi5jYSgpOwogICAgICAgICAgICBzYiAmJiAwID09IHEubGVuZ3RoICYmICgwID09IGMuTUMuaXNVc2VyTG9nZ2VkSW4oKSA/IEphKCkgOiBVYiA9IHNldFRpbWVvdXQoSmEsIDJFMykpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBTYSgpIHsKICAgICAgICAgICAgaWYgKGRhKCkpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gWSAtIHIgLyAyLAogICAgICAgICAgICAgICAgICAgIGIgPSBaIC0gdCAvIDI7CgogICAgICAgICAgICAgICAgLy8gQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgaWYgKDY0ID4gYSAqIGEgKyBiICogYiB8fCAuMDEgPiBNYXRoLmFicyhWYiAtIHphKSAmJiAuMDEgPiBNYXRoLmFicyhXYiAtIEFhKSB8fCAoVmIgPSB6YSwgV2IgPSBBYSwgYSA9IFUoMTMpLCBhLnNldFVpbnQ4KDAsIDE2KSwgaGV5KGEsIHphLCBBYSksIHh0KSkgewoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKCiAgICAgICAgICAgICAgICAvKiA2NCA+IGEgKiBhICsgYiAqIGIgfHwgLjAxID4gTWF0aC5hYnMoVmIgLQogICAgICAgICAgICAgICAgICAgICB6YSkgJiYgLjAxID4gTWF0aC5hYnMoV2IgLSBBYSkgfHwgKFZiID0gemEsIFdiID0gQWEsIGEgPSBVKDEzKSwgYS5zZXRVaW50OCgwLCAxNiksIGEuc2V0SW50MzIoMSwgemEsICEwKSwgYS5zZXRJbnQzMig1LCBBYSwgITApLCBhLnNldFVpbnQzMig5LCAwLCAhMCksIFYoYSkpCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBTYigpIHsKICAgICAgICAgICAgaWYgKGRhKCkgJiYgbmEgJiYgbnVsbCAhPSBOKSB7CiAgICAgICAgICAgICAgICB2YXIgYSA9IFUoMSArIDIgKiBOLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBzdG9wTW92ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvRmVlZEludGVydmFsKTsKICAgICAgICAgICAgICAgIGF1dG9GZWVkSW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDApOwogICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBOLmxlbmd0aDsgKytiKSBhLnNldFVpbnQxNigxICsgMiAqIGIsIE4uY2hhckNvZGVBdChiKSwgITApOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIE4gPSBudWxsCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGViKCkgewogICAgICAgICAgICBTYSgpOwogICAgICAgICAgICBYKDE3KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSmIoKSB7CiAgICAgICAgICAgIFNhKCk7CiAgICAgICAgICAgIFgoMjEpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkYSgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gdyAmJiB3LnJlYWR5U3RhdGUgPT0gdy5PUEVOCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBYKGEpIHsKICAgICAgICAgICAgaWYgKGRhKCkpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gVSgxKTsKICAgICAgICAgICAgICAgIGIuc2V0VWludDgoMCwgYSk7CiAgICAgICAgICAgICAgICBWKGIpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFhiKCkgewogICAgICAgICAgICByID0gMSAqIGMuaW5uZXJXaWR0aDsKICAgICAgICAgICAgdCA9IDEgKiBjLmlubmVySGVpZ2h0OwogICAgICAgICAgICB5Yi53aWR0aCA9IE8ud2lkdGggPSByOwogICAgICAgICAgICB5Yi5oZWlnaHQgPSBPLmhlaWdodCA9IHQ7CiAgICAgICAgICAgIHZhciBhID0gZSgiI2hlbGxvQ29udGFpbmVyIik7CiAgICAgICAgICAgIGEuY3NzKCJ0cmFuc2Zvcm0iLCAibm9uZSIpOwogICAgICAgICAgICB2YXIgYiA9IGEuaGVpZ2h0KCksCiAgICAgICAgICAgICAgICBkID0gYy5pbm5lckhlaWdodDsKICAgICAgICAgICAgMCAhPSBiIC8gMiAlIDIgJiYgKGIrKywgYS5oZWlnaHQoYikpOwogICAgICAgICAgICBiID4gZCAvIDEuMSA/IGEuY3NzKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKC01MCUsIC01MCUpIHNjYWxlKCIgKyBkIC8gYiAvIDEuMSArICIpIikgOiBhLmNzcygidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgtNTAlLCAtNTAlKSIpOwogICAgICAgICAgICBZYigpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBaYigpIHsKICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgIGEgPSAxICogTWF0aC5tYXgodCAvIDEwODAsIHIgLyAxOTIwKTsKICAgICAgICAgICAgcmV0dXJuIGEgKj0gUAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSWMoKSB7CiAgICAgICAgICAgIGlmICgwICE9IHEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gMCwgYiA9IDA7IGIgPCBxLmxlbmd0aDsgYisrKSBhICs9IHFbYl0uc2l6ZTsKICAgICAgICAgICAgICAgIGwgPSAoOSAqIGwgKyBNYXRoLnBvdyhNYXRoLm1pbig2NCAvIGEsIDEpLCAuNCkgKiBaYigpKSAvIDEwCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFliKCkgewogICAgICAgICAgICB2YXIgYSwgYiA9IERhdGUubm93KCk7CiAgICAgICAgICAgICsrSmM7CiAgICAgICAgICAgICRiICYmICgrK1RhLCAxODAgPCBUYSAmJiAoVGEgPSAwKSk7CiAgICAgICAgICAgIHggPQogICAgICAgICAgICAgICAgYjsKICAgICAgICAgICAgaWYgKDAgPCBxLmxlbmd0aCkgewogICAgICAgICAgICAgICAgSWMoKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSBhID0gMCwgYyA9IDA7IGMgPCBxLmxlbmd0aDsgYysrKSBxW2NdLlQoKSwgYSArPSBxW2NdLnggLyBxLmxlbmd0aCwgZCArPSBxW2NdLnkgLyBxLmxlbmd0aDsKICAgICAgICAgICAgICAgIHBhID0gYTsKICAgICAgICAgICAgICAgIHFhID0gZDsKICAgICAgICAgICAgICAgIHJhID0gbDsKICAgICAgICAgICAgICAgIHkgPSAoeSArIGEpIC8gMjsKICAgICAgICAgICAgICAgIHogPSAoeiArIGQpIC8gMgogICAgICAgICAgICB9IGVsc2UgeSA9ICgyOSAqIHkgKyBwYSkgLyAzMCwgeiA9ICgyOSAqIHogKyBxYSkgLyAzMCwgbCA9ICg5ICogbCArIHJhICogWmIoKSkgLyAxMDsKICAgICAgICAgICAgdWMoKTsKICAgICAgICAgICAgZmIoKTsKICAgICAgICAgICAgemIgfHwgZi5jbGVhclJlY3QoMCwgMCwgciwgdCk7CiAgICAgICAgICAgIHpiID8gKGYuZmlsbFN0eWxlID0gZWEgPyAiIzExMTExMSIgOiAiI0YyRkJGRiIsIGYuZ2xvYmFsQWxwaGEgPSAuMDUsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCksIGYuZ2xvYmFsQWxwaGEgPSAxKSA6IEtjKCk7CiAgICAgICAgICAgIEEuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgcmV0dXJuIGEuc2l6ZSA9PSBiLnNpemUgPyBhLmlkIC0gYi5pZCA6IGEuc2l6ZSAtIGIuc2l6ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgIGYudHJhbnNsYXRlKHIgLyAyLCB0IC8gMik7CiAgICAgICAgICAgIGYuc2NhbGUobCwgbCk7CiAgICAgICAgICAgIGYudHJhbnNsYXRlKC15LCAteik7CiAgICAgICAgICAgIGZvciAoYyA9IDA7IGMgPCBiYS5sZW5ndGg7IGMrKykgYmFbY10udyhmKTsKICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8CiAgICAgICAgICAgICAgICBBLmxlbmd0aDsgYysrKSBBW2NdLncoZik7CiAgICAgICAgICAgIGlmIChwYikgewogICAgICAgICAgICAgICAgS2EgPSAoMyAqIEthICsgbmIpIC8gNDsKICAgICAgICAgICAgICAgIExhID0gKDMgKiBMYSArIG9iKSAvIDQ7CiAgICAgICAgICAgICAgICBmLnNhdmUoKTsKICAgICAgICAgICAgICAgIGYuc3Ryb2tlU3R5bGUgPSAiI0ZGQUFBQSI7CiAgICAgICAgICAgICAgICBmLmxpbmVXaWR0aCA9IDEwOwogICAgICAgICAgICAgICAgZi5saW5lQ2FwID0gInJvdW5kIjsKICAgICAgICAgICAgICAgIGYubGluZUpvaW4gPSAicm91bmQiOwogICAgICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IC41OwogICAgICAgICAgICAgICAgZi5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgIGZvciAoYyA9IDA7IGMgPCBxLmxlbmd0aDsgYysrKSBmLm1vdmVUbyhxW2NdLngsIHFbY10ueSksIGYubGluZVRvKEthLCBMYSk7CiAgICAgICAgICAgICAgICBmLnN0cm9rZSgpOwogICAgICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBmLnJlc3RvcmUoKTsKICAgICAgICAgICAgSCAmJiBILndpZHRoICYmIGYuZHJhd0ltYWdlKEgsIHIgLSBILndpZHRoIC0gMTAsIDEwKTsKICAgICAgICAgICAgVCA9IE1hdGgubWF4KFQsIGFjKCkpOwogICAgICAgICAgICAwICE9IFQgJiYgKG51bGwgPT0gVWEgJiYgKFVhID0gbmV3IFZhKDI0LCAiI0ZGRkZGRiIpKSwgVWEuQihSKCJzY29yZSIpICsgIjogIiArIH5+KFQgLyAxMDApKSwgZCA9IFVhLk8oKSwgYSA9IGQud2lkdGgsIGYuZ2xvYmFsQWxwaGEgPSAuMiwgZi5maWxsU3R5bGUgPSAiIzAwMDAwMCIsIGYuZmlsbFJlY3QoMTAsIHQgLSAxMCAtIDI0IC0gMTAsIGEgKyAxMCwgMzQpLAogICAgICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IDEsIGYuZHJhd0ltYWdlKGQsIDE1LCB0IC0gMTAgLSAyNCAtIDUpKTsKICAgICAgICAgICAgTGMoKTsKICAgICAgICAgICAgYiA9IERhdGUubm93KCkgLSBiOwogICAgICAgICAgICBiID4gMUUzIC8gNjAgPyBNIC09IC4wMSA6IGIgPCAxRTMgLyA2NSAmJiAoTSArPSAuMDEpOwogICAgICAgICAgICAuNCA+IE0gJiYgKE0gPSAuNCk7CiAgICAgICAgICAgIDEgPCBNICYmIChNID0gMSk7CiAgICAgICAgICAgIGIgPSB4IC0gYmM7CiAgICAgICAgICAgICFkYSgpIHx8IGphIHx8IGFhID8gKEIgKz0gYiAvIDJFMywgMSA8IEIgJiYgKEIgPSAxKSkgOiAoQiAtPSBiIC8gMzAwLCAwID4gQiAmJiAoQiA9IDApKTsKICAgICAgICAgICAgMCA8IEIgPyAoZi5maWxsU3R5bGUgPSAiIzAwMDAwMCIsIGNjID8gKGYuZ2xvYmFsQWxwaGEgPSBCLCBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpLCBKLmNvbXBsZXRlICYmIEoud2lkdGggJiYgKEoud2lkdGggLyBKLmhlaWdodCA8IHIgLyB0ID8gKGIgPSByLCBhID0gSi5oZWlnaHQgKiByIC8gSi53aWR0aCkgOiAoYiA9IEoud2lkdGggKiB0IC8gSi5oZWlnaHQsIGEgPSB0KSwgZi5kcmF3SW1hZ2UoSiwgKHIgLSBiKSAvIDIsICh0IC0gYSkgLyAyLCBiLCBhKSwgZi5nbG9iYWxBbHBoYSA9IC41ICogQiwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSkpIDogKGYuZ2xvYmFsQWxwaGEgPSAuNSAqIEIsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCkpLCBmLmdsb2JhbEFscGhhID0gMSkgOiBjYyA9ICExOwogICAgICAgICAgICBiYyA9IHgKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEtjKCkgewogICAgICAgICAgICBmLmZpbGxTdHlsZSA9CiAgICAgICAgICAgICAgICBlYSA/ICIjMTExMTExIiA6ICIjRjJGQkZGIjsKICAgICAgICAgICAgZi5maWxsUmVjdCgwLCAwLCByLCB0KTsKICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgIGYuc3Ryb2tlU3R5bGUgPSBlYSA/ICIjQUFBQUFBIiA6ICIjMDAwMDAwIjsKICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IC4yICogbDsKICAgICAgICAgICAgZm9yICh2YXIgYSA9IHIgLyBsLCBiID0gdCAvIGwsIGQgPSAoLXkgKyBhIC8gMikgJSA1MDsgZCA8IGE7IGQgKz0gNTApIGYuYmVnaW5QYXRoKCksIGYubW92ZVRvKGQgKiBsIC0gLjUsIDApLCBmLmxpbmVUbyhkICogbCAtIC41LCBiICogbCksIGYuc3Ryb2tlKCk7CiAgICAgICAgICAgIGZvciAoZCA9ICgteiArIGIgLyAyKSAlIDUwOyBkIDwgYjsgZCArPSA1MCkgZi5iZWdpblBhdGgoKSwgZi5tb3ZlVG8oMCwgZCAqIGwgLSAuNSksIGYubGluZVRvKGEgKiBsLCBkICogbCAtIC41KSwgZi5zdHJva2UoKTsKICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIExjKCkgewogICAgICAgICAgICBpZiAoZGMgJiYgQWIud2lkdGgpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gciAvIDU7CiAgICAgICAgICAgICAgICBmLmRyYXdJbWFnZShBYiwgNSwgNSwgYSwgYSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYWMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGEgPSAwLCBiID0gMDsgYiA8IHEubGVuZ3RoOyBiKyspIGEgKz0gcVtiXS5nICogcVtiXS5nOwogICAgICAgICAgICByZXR1cm4gYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUmIoKSB7CiAgICAgICAgICAgIEggPSBudWxsOwogICAgICAgICAgICBpZiAobnVsbCAhPSBJIHx8IDAgIT0gQy5sZW5ndGgpCiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBJIHx8IGZhKSB7CiAgICAgICAgICAgICAgICAgICAgSCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgIHZhciBhID0gSC5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgICAgICBiID0gNjAsCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBudWxsID09IEkgPyBiICsgMjQgKiBDLmxlbmd0aCA6IGIgKyAxODAsCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBNYXRoLm1pbigyMDAsIC4zICogcikgLyAyMDA7CiAgICAgICAgICAgICAgICAgICAgSC53aWR0aCA9IDIwMCAqIGQ7CiAgICAgICAgICAgICAgICAgICAgSC5oZWlnaHQgPSBiICogZDsKICAgICAgICAgICAgICAgICAgICBhLnNjYWxlKGQsIGQpOwogICAgICAgICAgICAgICAgICAgIGEuZ2xvYmFsQWxwaGEgPSAuNDsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9ICIjMDAwMDAwIjsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxSZWN0KDAsIDAsIDIwMCwgYik7CiAgICAgICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSAiI0ZGRkZGRiI7CiAgICAgICAgICAgICAgICAgICAgZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgZCA9IFIoImxlYWRlcmJvYXJkIik7CiAgICAgICAgICAgICAgICAgICAgYS5mb250ID0gIjMwcHggVWJ1bnR1IjsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxUZXh0KGQsIDEwMCAtIGEubWVhc3VyZVRleHQoZCkud2lkdGggLyAyLCA0MCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMsIGU7CiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gSSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhLmZvbnQgPSAiMjBweCBVYnVudHUiLCBiID0gMDsgYiA8IEMubGVuZ3RoOyArK2IpIGQgPSBDW2JdLm5hbWUgfHwgUigidW5uYW1lZF9jZWxsIiksIGZhIHx8IChkID0gUigidW5uYW1lZF9jZWxsIikpLCAxID09IENbYl0uaWQgfHwgLTEgIT0gRS5pbmRleE9mKENbYl0uaWQpID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIChxWzBdLm5hbWUgJiYgKGQgPSBxWzBdLm5hbWUpLCBhLmZpbGxTdHlsZSA9ICIjRkZBQUFBIikgOiBhLmZpbGxTdHlsZSA9ICIjRkZGRkZGIiwgZCA9IGIgKyAxICsgIi4gIiArIGQsIGUgPSBhLm1lYXN1cmVUZXh0KGQpLndpZHRoLCBjID0gNzAgKyAyNCAqIGIsIDIwMCA8IGUgPyBhLmZpbGxUZXh0KGQsIDEwLCBjKSA6IGEuZmlsbFRleHQoZCwgKDIwMCAtIGUpIC8gMiwgYyk7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSBkID0gMDsgYiA8IEkubGVuZ3RoOyArK2IpIGMgPSBkICsgSVtiXSAqIE1hdGguUEkgKiAyLCBhLmZpbGxTdHlsZSA9IE1jW2IgKyAxXSwgYS5iZWdpblBhdGgoKSwgYS5tb3ZlVG8oMTAwLCAxNDApLCBhLmFyYygxMDAsIDE0MCwgODAsIGQsIGMsICExKSwgYS5maWxsKCksIGQgPSBjCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBOYyhhKSB7CiAgICAgICAgICAgIGlmIChudWxsID09IGEgfHwgMCA9PSBhLmxlbmd0aCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIGlmICgiJSIgPT0gYVswXSkgewogICAgICAgICAgICAgICAgaWYgKCFjLk1DIHx8ICFjLk1DLmdldFNraW5JbmZvKSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIGEgPSBjLk1DLmdldFNraW5JbmZvKCJza2luXyIgKyBhLnNsaWNlKDEpKTsKICAgICAgICAgICAgICAgIGlmIChudWxsID09IGEpIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgZm9yIChhID0gKCthLmNvbG9yKS50b1N0cmluZygxNikgOyA2ID4KICAgICAgICAgICAgICAgICAgICBhLmxlbmd0aDspIGEgPSAiMCIgKyBhOwogICAgICAgICAgICAgICAgcmV0dXJuICIjIiArIGEKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZWMoYSkgewogICAgICAgICAgICBpZiAobnVsbCA9PSBhIHx8IDAgPT0gYS5sZW5ndGgpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAoIXNhLmhhc093blByb3BlcnR5KGEpKSB7CiAgICAgICAgICAgICAgICB2YXIgYiA9IG5ldyBJbWFnZTsKICAgICAgICAgICAgICAgIGlmICgiOiIgPT0gYVswXSkgYi5zcmMgPSBhLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoIiUiID09IGFbMF0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWMuTUMgfHwgIWMuTUMuZ2V0U2tpbkluZm8pIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBkID0gYy5NQy5nZXRTa2luSW5mbygic2tpbl8iICsgYS5zbGljZSgxKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgICAgYi5zcmMgPSBjLkFTU0VUU19ST09UICsgZC51cmwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNhW2FdID0gYgogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAwICE9IHNhW2FdLndpZHRoICYmIHNhW2FdLmNvbXBsZXRlID8gc2FbYV0gOiBudWxsCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBCYihhLCBiLCBkLCBjLCBlKSB7CiAgICAgICAgICAgIHRoaXMuJCA9IGE7CiAgICAgICAgICAgIHRoaXMueCA9IGI7CiAgICAgICAgICAgIHRoaXMueSA9IGQ7CiAgICAgICAgICAgIHRoaXMuZiA9IGM7CiAgICAgICAgICAgIHRoaXMuYiA9IGUKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNhKGEsIGIsIGQsIGMsIGUsIHApIHsKICAgICAgICAgICAgdGhpcy5pZCA9IGE7CiAgICAgICAgICAgIHRoaXMucyA9IHRoaXMueCA9IHRoaXMuTSA9IHRoaXMuSiA9IGI7CiAgICAgICAgICAgIHRoaXMudSA9IHRoaXMueSA9IHRoaXMuTiA9IHRoaXMuSyA9IGQ7CiAgICAgICAgICAgIHRoaXMubyA9IHRoaXMuc2l6ZSA9IGM7CiAgICAgICAgICAgIHRoaXMuY29sb3IgPSBlOwogICAgICAgICAgICB0aGlzLmEgPSBbXTsKICAgICAgICAgICAgdGhpcy5iYSgpOwogICAgICAgICAgICB0aGlzLkEocCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEhjKGEpIHsKICAgICAgICAgICAgZm9yIChhID0gYS50b1N0cmluZygxNikgOyA2ID4gYS5sZW5ndGg7KSBhID0gIjAiICsgYTsKICAgICAgICAgICAgcmV0dXJuICIjIiArIGEKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFZhKGEsIGIsIGQsIGMpIHsKICAgICAgICAgICAgYSAmJiAodGhpcy52ID0gYSk7CiAgICAgICAgICAgIGIgJiYgKHRoaXMuVyA9IGIpOwogICAgICAgICAgICB0aGlzLlkgPSAhIWQ7CiAgICAgICAgICAgIGMgJiYgKHRoaXMuWiA9IGMpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBPYyhhKSB7CiAgICAgICAgICAgIGZvciAodmFyIGIgPSBhLmxlbmd0aCwgZCwgYzsgMCA8IGI7KSBjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYiksIGItLSwgZCA9IGFbYl0sIGFbYl0gPSBhW2NdLCBhW2NdID0gZAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUGMoKSB7CiAgICAgICAgICAgIGggPSBXYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZmMoYSkgewogICAgICAgICAgICBoLmNvbnRleHQgPSAiZ29vZ2xlIiA9PSBhID8gImdvb2dsZSIgOiAiZmFjZWJvb2siOwogICAgICAgICAgICBYYSgpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBYYSgpIHsKICAgICAgICAgICAgYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvID0gSlNPTi5zdHJpbmdpZnkoaCk7CiAgICAgICAgICAgIGggPSBKU09OLnBhcnNlKGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyk7CiAgICAgICAgICAgIGMuc3RvcmFnZUluZm8gPSBoOwogICAgICAgICAgICAiZ29vZ2xlIiA9PSBoLmNvbnRleHQgPyAoZSgiI2dQbHVzU2hhcmUiKS5zaG93KCksIGUoIiNmYlNoYXJlIikuaGlkZSgpKSA6IChlKCIjZ1BsdXNTaGFyZSIpLmhpZGUoKSwgZSgiI2ZiU2hhcmUiKS5zaG93KCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnYyhhKSB7CiAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIpOwogICAgICAgICAgICAiIiAhPSBhLmRpc3BsYXlOYW1lICYmIChhLm5hbWUgPSBhLmRpc3BsYXlOYW1lKTsKICAgICAgICAgICAgaWYgKG51bGwgPT0gYS5uYW1lIHx8IHZvaWQgMCA9PSBhLm5hbWUpIGEubmFtZSA9ICIiOwogICAgICAgICAgICB2YXIgYiA9IGEubmFtZS5sYXN0SW5kZXhPZigiXyIpOyAtMSAhPSBiICYmIChhLm5hbWUgPSBhLm5hbWUuc3Vic3RyaW5nKDAsIGIpKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjEiKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1sb2dnZWQtaW4iLCAiMSIpOwogICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChhLmxldmVsKTsKICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLnRleHQoYS54cCArICIvIiArIGEueHBOZWVkZWQgKyAiIFhQIik7CiAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIGEueHAgLyBhLnhwTmVlZGVkKS50b0ZpeGVkKDIpICsgIiUiKTsKICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLW5hbWUiKS50ZXh0KGEubmFtZSk7CiAgICAgICAgICAgICIiICE9IGEucGljdHVyZSAmJiBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEucGljdHVyZSk7CiAgICAgICAgICAgIENiKCk7CiAgICAgICAgICAgIGgudXNlckluZm8ubGV2ZWwgPSBhLmxldmVsOwogICAgICAgICAgICBoLnVzZXJJbmZvLnhwID0gYS54cDsKICAgICAgICAgICAgaC51c2VySW5mby54cE5lZWRlZCA9IGEueHBOZWVkZWQ7CiAgICAgICAgICAgIGgudXNlckluZm8uZGlzcGxheU5hbWUgPSBhLm5hbWU7CiAgICAgICAgICAgIGgudXNlckluZm8ubG9nZ2VkSW4gPSAiMSI7CiAgICAgICAgICAgIGMudXBkYXRlU3RvcmFnZSgpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnYShhLCBiKSB7CiAgICAgICAgICAgIHZhciBkID0gYTsKICAgICAgICAgICAgaWYgKGgudXNlckluZm8ubG9nZ2VkSW4pIHsKICAgICAgICAgICAgICAgIHZhciB1ID0gZSgiI2hlbGxvQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgIjEiID09IGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIpOwogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCB8fCB2b2lkIDAgPT0gZCkgZCA9IGgudXNlckluZm87CiAgICAgICAgICAgICAgICBpZiAodSkgewogICAgICAgICAgICAgICAgICAgIHZhciBnID0gK2UoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS5maXJzdCgpLnRleHQoKS5zcGxpdCgiLyIpWzBdLAogICAgICAgICAgICAgICAgICAgICAgICB1ID0gK2UoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS5maXJzdCgpLnRleHQoKS5zcGxpdCgiLyIpWzFdLnNwbGl0KCIgIilbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikuZmlyc3QoKS50ZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHAgIT0gZC5sZXZlbCkgZ2EoewogICAgICAgICAgICAgICAgICAgICAgICB4cDogdSwKICAgICAgICAgICAgICAgICAgICAgICAgeHBOZWVkZWQ6IHUsCiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBwCiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChkLmxldmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXIiKS5jc3MoIndpZHRoIiwgIjEwMCUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnByb2dyZXNzLWJhci1zdGFyIikuYWRkQ2xhc3MoImFuaW1hdGVkIHRhZGEiKS5vbmUoIndlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIucHJvZ3Jlc3MtYmFyLXN0YXIiKS5yZW1vdmVDbGFzcygiYW5pbWF0ZWQgdGFkYSIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KGQueHBOZWVkZWQgKyAiLyIgKyBkLnhwTmVlZGVkICsgIiBYUCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwTmVlZGVkOiBkLnhwTmVlZGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBkLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDFFMykKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gKERhdGUubm93KCkgLSBmKSAvIDFFMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gMCA+IGEgPyAwIDogMSA8IGEgPyAxIDogYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gYSAqIGEgKiAoMyAtIDIgKiBhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikudGV4dCh+fihnICsgKGQueHAgLSBnKSAqIGEpICsgIi8iICsgZC54cE5lZWRlZCArICIgWFAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhciIpLmNzcygid2lkdGgiLCAoODggKiAoZyArIChkLnhwIC0gZykgKiBhKSAvIGQueHBOZWVkZWQpLnRvRml4ZWQoMikgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgYigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPiBhICYmIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBjLnJlcXVlc3RBbmltYXRpb25GcmFtZShrKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQ2IoKSB7CiAgICAgICAgICAgIHZhciBhOwogICAgICAgICAgICAoInVuZGVmaW5lZCIgIT09IHR5cGVvZiBhICYmIGEgfHwgIm5vbmUiID09IGUoIiNzZXR0aW5ncyIpLmNzcygiZGlzcGxheSIpICYmICJub25lIiA9PSBlKCIjc29jaWFsTG9naW5Db250YWluZXIiKS5jc3MoImRpc3BsYXkiKSkgJiYgZSgiI2luc3RydWN0aW9ucyIpLnNob3coKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGMoYSkgewogICAgICAgICAgICBpZiAoImNvbm5lY3RlZCIgPT0gYS5zdGF0dXMpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gYS5hdXRoUmVzcG9uc2UuYWNjZXNzVG9rZW47CiAgICAgICAgICAgICAgICBudWxsID09IGIgfHwgInVuZGVmaW5lZCIgPT0gYiB8fCAiIiA9PSBiID8gKDMgPiBpYyAmJiAoaWMrKywgYy5mYWNlYm9va1JlbG9naW4oKSksIGMubG9nb3V0KCkpIDogKGMuTUMuZG9Mb2dpbldpdGhGQihiKSwgbS5jYWNoZS5sb2dpbl9pbmZvID0gW2IsICJmYWNlYm9vayJdLCBjLkZCLmFwaSgiL21lL3BpY3R1cmU/d2lkdGg9MTgwJmhlaWdodD0xODAiLCBmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGIuZGF0YS51cmw7CiAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLXBpY3R1cmUiKS5hdHRyKCJzcmMiLCBiLmRhdGEudXJsKTsKICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnNvY2lhbElkID0gYS5hdXRoUmVzcG9uc2UudXNlcklEOwogICAgICAgICAgICAgICAgICAgIFlhKCkKICAgICAgICAgICAgICAgIH0pLCBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWxvZ2dlZC1pbiIsICIxIiksIGguY29udGV4dCA9ICJmYWNlYm9vayIsIGgubG9naW5JbnRlbnQgPSAiMSIsIGMudXBkYXRlU3RvcmFnZSgpKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBqYyhhKSB7CiAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI0Iik7CiAgICAgICAgICAgIGEgPSBkZWNvZGVVUklDb21wb25lbnQoYSkucmVwbGFjZSgvLiojL2dpbSwgIiIpOwogICAgICAgICAgICBEYigiIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7CiAgICAgICAgICAgIGUuYWpheChDYSArICJnZXRUb2tlbiIsIHsKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI2IikKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgIGIgPSBiLnNwbGl0KCJcbiIpOwogICAgICAgICAgICAgICAgICAgIGUoIi5wYXJ0eVRva2VuIikudmFsKCJhZ2FyLmlvLyMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOwogICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiNSIpOwogICAgICAgICAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgICAgICAgICBsYigid3M6Ly8iICsgYlswXSwgYSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBkYXRhVHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBjYWNoZTogITEsCiAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogITAsCiAgICAgICAgICAgICAgICBkYXRhOiBhCiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBEYihhKSB7CiAgICAgICAgICAgIGMuaGlzdG9yeSAmJiBjLmhpc3RvcnkucmVwbGFjZVN0YXRlICYmIGMuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIGMuZG9jdW1lbnQudGl0bGUsIGEpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBKYSgpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KFViKTsKICAgICAgICAgICAgbnVsbCA9PSBjLnN0b3JhZ2VJbmZvICYmIGMuY3JlYXRlRGVmYXVsdFN0b3JhZ2UoKTsKICAgICAgICAgICAgRWIgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAwID49IFJhICYmIChSYSA9IEViKTsKICAgICAgICAgICAgRWEgPSAhMTsKICAgICAgICAgICAgUWMoKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gR2MoYSwgYikgewogICAgICAgICAgICB2YXIgZCA9IC0xICE9IEUuaW5kZXhPZihhLmlkKSwKICAgICAgICAgICAgICAgIGMgPSAtMSAhPSBFLmluZGV4T2YoYi5pZCksCiAgICAgICAgICAgICAgICBlID0gMzAgPiBiLnNpemU7CiAgICAgICAgICAgIGQgJiYgZSAmJiArK3ViOwogICAgICAgICAgICBlIHx8ICFkIHx8IGMgfHwgYi5lYSAmIDMyIHx8ICsrd2IKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGtjKGEpIHsKICAgICAgICAgICAgYSA9IH5+YTsKICAgICAgICAgICAgdmFyIGIgPSAoYSAlIDYwKS50b1N0cmluZygpOwogICAgICAgICAgICBhID0gKH5+KGEgLyA2MCkpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIDIgPiBiLmxlbmd0aCAmJiAoYiA9ICIwIiArIGIpOwogICAgICAgICAgICByZXR1cm4gYSArICI6IiArIGIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFJjKCkgewogICAgICAgICAgICBpZiAobnVsbCA9PSBDKSByZXR1cm4gMDsKICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBDLmxlbmd0aDsgKythKQogICAgICAgICAgICAgICAgaWYgKC0xICE9IEUuaW5kZXhPZihDW2FdLmlkKSkgcmV0dXJuIGEgKyAxOwogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gU2MoKSB7CiAgICAgICAgICAgIGUoIi5zdGF0cy1mb29kLWVhdGVuIikudGV4dCh1Yik7CiAgICAgICAgICAgIGUoIi5zdGF0cy10aW1lLWFsaXZlIikudGV4dChrYygoRWIgLSBSYSkgLyAxRTMpKTsKICAgICAgICAgICAgZSgiLnN0YXRzLWxlYWRlcmJvYXJkLXRpbWUiKS50ZXh0KGtjKHhiKSk7CiAgICAgICAgICAgIGUoIi5zdGF0cy1oaWdoZXN0LW1hc3MiKS50ZXh0KH5+KFQgLyAxMDApKTsKICAgICAgICAgICAgZSgiLnN0YXRzLWNlbGxzLWVhdGVuIikudGV4dCh3Yik7CiAgICAgICAgICAgIGUoIi5zdGF0cy10b3AtcG9zaXRpb24iKS50ZXh0KDAgPT0gVyA/ICI6KCIgOgogICAgICAgICAgICAgICAgVyk7CiAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXRzR3JhcGgiKTsKICAgICAgICAgICAgaWYgKGEpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gYS5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgIGQgPSBhLndpZHRoLAogICAgICAgICAgICAgICAgICAgIGEgPSBhLmhlaWdodDsKICAgICAgICAgICAgICAgIGIuY2xlYXJSZWN0KDAsIDAsIGQsIGEpOwogICAgICAgICAgICAgICAgaWYgKDIgPCBGLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAyMDAsIGcgPSAwOyBnIDwgRi5sZW5ndGg7IGcrKykgYyA9IE1hdGgubWF4KEZbZ10sIGMpOwogICAgICAgICAgICAgICAgICAgIGIubGluZVdpZHRoID0gMzsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVDYXAgPSAicm91bmQiOwogICAgICAgICAgICAgICAgICAgIGIubGluZUpvaW4gPSAicm91bmQiOwogICAgICAgICAgICAgICAgICAgIGIuc3Ryb2tlU3R5bGUgPSB2YjsKICAgICAgICAgICAgICAgICAgICBiLmZpbGxTdHlsZSA9IHZiOwogICAgICAgICAgICAgICAgICAgIGIuYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgYi5tb3ZlVG8oMCwgYSAtIEZbMF0gLyBjICogKGEgLSAxMCkgKyAxMCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChnID0gMTsgZyA8IEYubGVuZ3RoOyBnICs9IE1hdGgubWF4KH5+KEYubGVuZ3RoIC8gZCksIDEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHAgPSBnIC8gKEYubGVuZ3RoIC0gMSkgKiBkLCBmID0gW10sIGsgPSAtMjA7IDIwID49IGs7ICsraykgMCA+IGcgKyBrIHx8IGcgKyBrID49IEYubGVuZ3RoIHx8IGYucHVzaChGW2cgKyBrXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBmLnJlZHVjZShmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiCiAgICAgICAgICAgICAgICAgICAgICAgIH0pIC8gZi5sZW5ndGggLyBjOwogICAgICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbyhwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSAtIGYgKiAoYSAtIDEwKSArIDEwKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIGIuZ2xvYmFsQWxwaGEgPSAuNTsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbyhkLCBhKTsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbygwLCBhKTsKICAgICAgICAgICAgICAgICAgICBiLmZpbGwoKTsKICAgICAgICAgICAgICAgICAgICBiLmdsb2JhbEFscGhhID0gMQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBRYygpIHsKICAgICAgICAgICAgamEgfHwgYWEgfHwgKFphID8gKGMucmVmcmVzaEFkKGMuYWRTbG90cy5hYiksIFNjKCksIGFhID0gITAsIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgZSgiI292ZXJsYXlzIikuZmFkZUluKDUwMCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGdhKCkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZSgiI3N0YXRzIikuc2hvdygpOwogICAgICAgICAgICAgICAgdmFyIGEgPSBsYygiZ19wbHVzX3NoYXJlX3N0YXRzIik7CiAgICAgICAgICAgICAgICBjLmZpbGxTb2NpYWxWYWx1ZXMoYSwgImdQbHVzU2hhcmUiKQogICAgICAgICAgICB9LCAxNTAwKSkgOiB5YSg1MDApKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbGMoYSkgewogICAgICAgICAgICB2YXIgYiA9IGUoIi5zdGF0cy10aW1lLWFsaXZlIikudGV4dCgpOwogICAgICAgICAgICByZXR1cm4gYy5wYXJzZVN0cmluZyhhLCAiJUAiLCBbYi5zcGxpdCgiOiIpWzBdLCBiLnNwbGl0KCI6IilbMV0sIGUoIi5zdGF0cy1oaWdoZXN0LW1hc3MiKS50ZXh0KCldKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gVGMoKSB7CiAgICAgICAgICAgIGMub3BlbigiaHR0cHM6Ly9wbHVzLmdvb2dsZS5jb20vc2hhcmU/dXJsPXd3dy5hZ2FyLmlvJmhsPWVuLVVTIiwgIkFnYXIuaW8iLCAid2lkdGg9NDg0LGhlaWdodD01ODAsbWVudWJhcj1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT15ZXMsc2Nyb2xsYmFycz1ubyxsZWZ0PSIgKyAoYy5zY3JlZW5YICsgYy5pbm5lcldpZHRoIC8gMiAtIDI0MikgKyAiLHRvcD0iICsgKGMuaW5uZXJIZWlnaHQgLSA1ODApIC8gMikKICAgICAgICB9CiAgICAgICAgdmFyIG1jID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgaWYgKCJ1bmRlZmluZWQiID09IHR5cGVvZiBjb25zb2xlIHx8ICJ1bmRlZmluZWQiID09IHR5cGVvZiBEYXRhVmlldyB8fCAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2ViU29ja2V0IHx8IG51bGwgPT0gbWMgfHwgbnVsbCA9PSBtYy5nZXRDb250ZXh0IHx8IG51bGwgPT0gYy5sb2NhbFN0b3JhZ2UpIGFsZXJ0KCJZb3UgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgZ2FtZSwgd2UgcmVjb21tZW5kIHlvdSB0byB1c2UgRmlyZWZveCB0byBwbGF5IHRoaXMiKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdmFyIEQgPSB7fTsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gYy5sb2NhdGlvbi5zZWFyY2g7CiAgICAgICAgICAgICAgICAiPyIgPT0gYS5jaGFyQXQoMCkgJiYgKGEgPQogICAgICAgICAgICAgICAgICAgIGEuc2xpY2UoMSkpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IGEuc3BsaXQoIiYiKSwgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhW2JdLnNwbGl0KCI9Iik7CiAgICAgICAgICAgICAgICAgICAgRFtkWzBdXSA9IGRbMV0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgYy5xdWVyeVN0cmluZyA9IEQ7CiAgICAgICAgICAgIHZhciBuYyA9ICJmYiIgaW4gRCwKICAgICAgICAgICAgICAgIFVjID0gIm1pbmljbGlwIiBpbiBELAogICAgICAgICAgICAgICAgdiA9IHsKICAgICAgICAgICAgICAgICAgICBza2luc0VuYWJsZWQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICBuYW1lc0VuYWJsZWQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICBub0NvbG9yczogIjAiLAogICAgICAgICAgICAgICAgICAgIGJsYWNrVGhlbWU6ICIwIiwKICAgICAgICAgICAgICAgICAgICBzaG93TWFzczogIjAiLAogICAgICAgICAgICAgICAgICAgIHN0YXRzRW5hYmxlZDogIjAiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgVmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdWEoIiIsIC0xKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9jID0gImh0dHA6IiAhPSBjLmxvY2F0aW9uLnByb3RvY29sLAogICAgICAgICAgICAgICAgV2MgPSAiMSIgPT0gdGMoKSwKICAgICAgICAgICAgICAgIHBjID0gITE7CiAgICAgICAgICAgIG5jIHx8IFVjIHx8IChvYyAmJiAhV2MgPyAodWEoIjEiLCAxKSwgYy5sb2NhdGlvbi5ocmVmID0gImh0dHA6IiArIGMubG9jYXRpb24uaHJlZi5zdWJzdHJpbmcoYy5sb2NhdGlvbi5wcm90b2NvbC5sZW5ndGgpLCBwYyA9ICEwKSA6IHVhKCIiLCAtMSkpOwogICAgICAgICAgICBvYyB8fCB1YSgiIiwgLTEpOwogICAgICAgICAgICBwYyB8fCBzZXRUaW1lb3V0KFZjLCAzRTMpOwogICAgICAgICAgICBpZiAoIWMuYWdhcmlvTm9Jbml0KSB7CiAgICAgICAgICAgICAgICB2YXIgamIgPSBjLmxvY2F0aW9uLnByb3RvY29sLAogICAgICAgICAgICAgICAgICAgIG1iID0gImh0dHBzOiIgPT0gamI7CiAgICAgICAgICAgICAgICBELm1hc3RlciAmJiAoRW52Q29uZmlnLm1hc3Rlcl91cmwgPSBELm1hc3Rlcik7CiAgICAgICAgICAgICAgICB2YXIgQ2EgPSBqYiArICIvLyIgKyBFbnZDb25maWcubWFzdGVyX3VybCArICIvIiwKICAgICAgICAgICAgICAgICAgICAkYSA9IGMubmF2aWdhdG9yLnVzZXJBZ2VudDsKICAgICAgICAgICAgICAgIGlmICgtMSAhPSAkYS5pbmRleE9mKCJBbmRyb2lkIikpIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJNb2JpbGVSZWRpcmVjdCIsICJQbGF5U3RvcmUiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgYy5sb2NhdGlvbi5ocmVmID0gImh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1jb20ubWluaWNsaXAuYWdhci5pbyIKICAgICAgICAgICAgICAgIH0sIDFFMyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmICgtMSAhPSAkYS5pbmRleE9mKCJpUGhvbmUiKSB8fCAtMSAhPSAkYS5pbmRleE9mKCJpUGFkIikgfHwgLTEgIT0gJGEuaW5kZXhPZigiaVBvZCIpKSBjLmdhICYmIGMuZ2EoInNlbmQiLCAiZXZlbnQiLCAiTW9iaWxlUmVkaXJlY3QiLCAiQXBwU3RvcmUiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgYy5sb2NhdGlvbi5ocmVmID0gImh0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS9hcHAvYWdhci5pby9pZDk5NTk5OTcwMz9tdD04JmF0PTFsM3ZhanAiCiAgICAgICAgICAgICAgICB9LCAxRTMpOwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSB7fTsKICAgICAgICAgICAgICAgICAgICBjLmFnYXJBcHAgPSBtOwogICAgICAgICAgICAgICAgICAgIHZhciB5YiwgZiwgTywgciwgdCwgaWEgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB3ID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgeSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHogPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBFID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHEgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgSyA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBBID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIGJhID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIEMgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFogPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB6YSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICBBYSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICBKYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBiYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE4gPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBNYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE5hID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgT2EgPSAxRTQsCiAgICAgICAgICAgICAgICAgICAgICAgIFBhID0gMUU0LAogICAgICAgICAgICAgICAgICAgICAgICBsID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgRyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGFiID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHNiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIFQgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBlYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBiYiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBwYSA9IHkgPSB+figoTWEgKyBPYSkgLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgcWEgPSB6ID0gfn4oKE5hICsgUGEpIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgIHJhID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgbGEgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgSSA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGdiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHBiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIG5iID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgb2IgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBLYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIExhID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTWMgPSBbIiMzMzMzMzMiLCAiI0ZGMzMzMyIsICIjMzNGRjMzIiwgIiMzMzMzRkYiXSwKICAgICAgICAgICAgICAgICAgICAgICAgemIgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgbmEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgRmEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBQID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgQiA9IDEsCiAgICAgICAgICAgICAgICAgICAgICAgIGphID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGtiID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgY2MgPSAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgcmIgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBxYiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBKID0gbmV3IEltYWdlOwogICAgICAgICAgICAgICAgICAgIEouc3JjID0gIi9pbWcvYmFja2dyb3VuZC5wbmciOwogICAgICAgICAgICAgICAgICAgIHZhciBkYyA9ICJvbnRvdWNoc3RhcnQiIGluIGMgJiYgL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KGMubmF2aWdhdG9yLnVzZXJBZ2VudCksCiAgICAgICAgICAgICAgICAgICAgICAgIEFiID0gbmV3IEltYWdlOwogICAgICAgICAgICAgICAgICAgIEFiLnNyYyA9ICIvaW1nL3NwbGl0LnBuZyI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHhhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGNiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIEZiLCBHYjsKICAgICAgICAgICAgICAgICAgICAiZ2FtZXBhZCIgaW4gRCAmJiBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiICYmIChZID0gZGIuaGEoWSwgRmIpLCBaID0gZGIuaGEoWiwgR2IpKQogICAgICAgICAgICAgICAgICAgIH0sIDI1KTsKICAgICAgICAgICAgICAgICAgICBjLmdhbWVwYWRBeGlzVXBkYXRlID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAuMSA+IGIgKiBiOwogICAgICAgICAgICAgICAgICAgICAgICAwID09IGEgJiYgKGQgPyBGYiA9IHIgLyAyIDogKEZiID0gKGIgKyAxKSAvIDIgKiByLCBjYiA9ICEwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIDEgPT0gYSAmJiAoZCA/IEdiID0gdCAvIDIgOiAoR2IgPSAoYiArIDEpIC8gMiAqIHQsIGNiID0gITApKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5hZ2FyaW9Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBnYiA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICB4YygpOwogICAgICAgICAgICAgICAgICAgICAgICB3YygpOwogICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IGMubG9jYWxTdG9yYWdlLnNldHRpbmdzICYmICh2ID0gSlNPTi5wYXJzZShjLmxvY2FsU3RvcmFnZS5zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYiA9IHYuc2hvd01hc3MsIGVhID0gdi5ibGFja1RoZW1lLCBmYSA9IHYubmFtZXNFbmFibGVkLCB0YSA9IHYubm9Db2xvcnMsIFphID0gdi5zdGF0c0VuYWJsZWQsIGFiID0gdi5za2luc0VuYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc2hvd01hc3MiKS5wcm9wKCJjaGVja2VkIiwgdi5zaG93TWFzcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNub1NraW5zIikucHJvcCgiY2hlY2tlZCIsICF2LnNraW5zRW5hYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNza2lwU3RhdHMiKS5wcm9wKCJjaGVja2VkIiwgIXYuc3RhdHNFbmFibGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI25vQ29sb3JzIikucHJvcCgiY2hlY2tlZCIsIHYubm9Db2xvcnMpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjbm9OYW1lcyIpLnByb3AoImNoZWNrZWQiLCAhdi5uYW1lc0VuYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjZGFya1RoZW1lIikucHJvcCgiY2hlY2tlZCIsIHYuYmxhY2tUaGVtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIExiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKExiLCAxOEU0KTsKICAgICAgICAgICAgICAgICAgICAgICAgTyA9IHliID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IE8gJiYgKGYgPSBPLmdldENvbnRleHQoIjJkIiksIE8ub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLmNsaWVudFggLSAoNSArIHIgLyA1IC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBhLmNsaWVudFkgLSAoNSArIHIgLyA1IC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguc3FydChiICogYiArIGQgKiBkKSA8PSByIC8gNSAvIDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDEgKiBhLmNsaWVudFg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBaID0gMSAqIGEuY2xpZW50WTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTYSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIE8ub25tb3VzZW1vdmUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IgPSAhMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFkgPSAxICogYS5jbGllbnRYOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWiA9IDEgKiBhLmNsaWVudFk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYigpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIE8ub25tb3VzZXVwID0gZnVuY3Rpb24gKCkgeyB9LCAvZmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgPyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Nb3VzZVNjcm9sbCIsIEtiLCAhMSkgOiBkb2N1bWVudC5ib2R5Lm9ubW91c2V3aGVlbCA9IEtiLCBjLm9uYmx1ciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFgoMTkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGEgPSB3YSA9IHZhID0gITEKICAgICAgICAgICAgICAgICAgICAgICAgfSwgYy5vbnJlc2l6ZSA9IFhiLCBjLnJlcXVlc3RBbmltYXRpb25GcmFtZShxYyksIHNldEludGVydmFsKFNhLCA0MCksIEcgJiYgZSgiI3JlZ2lvbiIpLnZhbChHKSwgTmIoKSwgRGEoZSgiI3JlZ2lvbiIpLnZhbCgpKSwgMCA9PSBrYiAmJiBHICYmIFEoKSwgeWEoMCksIFhiKCksIGMubG9jYXRpb24uaGFzaCAmJiA2IDw9IGMubG9jYXRpb24uaGFzaC5sZW5ndGggJiYgamMoYy5sb2NhdGlvbi5oYXNoKSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBCYSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgYy5zZXROaWNrID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYy5nYSAmJiBjLmdhKCJzZW5kIiwgImV2ZW50IiwgIk5pY2siLCBhLnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBNYigpOwogICAgICAgICAgICAgICAgICAgICAgICBOID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgU2IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgVCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHYuc2tpbnNFbmFibGVkID0gYWI7CiAgICAgICAgICAgICAgICAgICAgICAgIHYubmFtZXNFbmFibGVkID0gZmE7CiAgICAgICAgICAgICAgICAgICAgICAgIHYubm9Db2xvcnMgPSB0YTsKICAgICAgICAgICAgICAgICAgICAgICAgdi5ibGFja1RoZW1lID0gZWE7CiAgICAgICAgICAgICAgICAgICAgICAgIHYuc2hvd01hc3MgPSBiYjsKICAgICAgICAgICAgICAgICAgICAgICAgdi5zdGF0c0VuYWJsZWQgPSBaYTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5sb2NhbFN0b3JhZ2Uuc2V0dGluZ3MgPSBKU09OLnN0cmluZ2lmeSh2KTsKICAgICAgICAgICAgICAgICAgICAgICAgSWIoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRTa2lucyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFiID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXROYW1lcyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXREYXJrVGhlbWUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBlYSA9IGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0Q29sb3JzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGEgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldFNob3dNYXNzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmIgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNwZWN0YXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBOID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgSWIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgWCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgTWIoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRSZWdpb24gPSBEYTsKICAgICAgICAgICAgICAgICAgICB2YXIgaGIgPSAhMDsKICAgICAgICAgICAgICAgICAgICBjLnNldEdhbWVNb2RlID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYSAhPSBsYSAmJiAoIjpwYXJ0eSIgPT0gbGEgJiYgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIwIiksIGthKGEpLCAiOnBhcnR5IiAhPSBhICYmIFEoKSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0QWNpZCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHpiID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIFhjID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcERyYXc6ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY3Rpb25Nb2RpZmllcjogMS4xCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmFjY291bnQuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5nb29nbGUudmEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uZmEuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGQgPSAiZGVidWciIGluIGMucXVlcnlTdHJpbmcpICYmIG0uZGVidWcuc2hvd0RlYnVnKCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5iaW5kID0gZnVuY3Rpb24gKGEsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoYikuYmluZChhLCBkKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnVuYmluZCA9IGZ1bmN0aW9uIChhLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKGIpLnVuYmluZChhLCBkKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnRyaWdnZXIgPSBmdW5jdGlvbiAoYSwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZShiKS50cmlnZ2VyKGEsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygiZGVidWciLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZVNldHRlcl9fKCJkZWJ1ZyIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZCA9IGEKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygicHJveHkiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5NQwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJjb25maWciLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KHt9KTsKICAgICAgICAgICAgICAgICAgICBtLmNvcmUgPSBYYzsKICAgICAgICAgICAgICAgICAgICBtLmNhY2hlID0ge307CiAgICAgICAgICAgICAgICAgICAgdmFyIFljID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYihhLCBiLCBkLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gYSArICJDYW52YXMiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBlKCI8Y2FudmFzPiIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogYQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmFwcGVuZChnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBuZXcgU21vb3RoaWVDaGFydChkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZyA9IDA7IGcgPCBiLmxlbmd0aDsgZysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHUgPSBiW2ddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gXy5leHRlbmQoaCwgY1tnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5hZGRUaW1lU2VyaWVzKHUsIGYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnN0cmVhbVRvKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtbYV0gPSBjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKGEsIFtrW2FdXSwgZCwgW3sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDAuMikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVTZXJpZXMoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEthOiAhMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCwgZiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDAuMikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zaG93RGVidWcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnIHx8IChwID0gZSgiI2RlYnVnLW92ZXJsYXkiKSwgZCgibmV0d29ya1VwZGF0ZSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAibmV0d29yayB1cGRhdGVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5WYWx1ZTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZTogMTIwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgZCgiZnBzIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJmcHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBrLnJ0dFNEZXYgPSBjKCksIGsucnR0TWVhbiA9IGMoKSwgYigicnR0TWVhbiIsIFtrLnJ0dFNEZXYsIGsucnR0TWVhbl0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAicnR0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5WYWx1ZTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZTogMTIwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBbewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiAicmdiYSgyNTUsIDAsIDAsIDEpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMC4yKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMSkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAwKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSksIGcgPSAhMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgPSAhMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuc2hvdygpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuaGlkZURlYnVnID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgPSAhMQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnVwZGF0ZUNoYXJ0ID0gZnVuY3Rpb24gKGEsIGIsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgJiYgYSBpbiBrICYmIGtbYV0uYXBwZW5kKGIsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygic2hvd1ByZWRpY3Rpb24iLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZVNldHRlcl9fKCJzaG93UHJlZGljdGlvbiIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZiA9IGEKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgbS5kZWJ1ZyA9IFljOwogICAgICAgICAgICAgICAgICAgIHZhciBtYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgQUY6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFYOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBEWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFTOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFJOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFHOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFSOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgQU06ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFXOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFVOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkg6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJEOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBCQjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCWTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlo6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQko6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCTTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCVDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQk86ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBCUTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJXOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlI6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBJTzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkc6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQk46ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkY6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtIOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENBOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENWOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgS1k6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0Y6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBURDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENMOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ046ICJDTi1DaGluYSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENYOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDQzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ086ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBLTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENEOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0c6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDSzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENSOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSFI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDVTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBDVzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBDWTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ1o6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBESzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIERKOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRE06ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRE86ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRUM6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBFRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNWOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdROiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRVI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBFRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRk86ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBGSzogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEZKOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgRkk6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBGUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdGOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEY6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBHQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0U6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIERFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0g6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdSOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0w6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0Q6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1A6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1U6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBHVDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBHRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdOOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1c6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHWTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEhUOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFZBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSE46ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgSEs6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEhVOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSVM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBJTjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSUQ6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIElSOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJUTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSUU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBJTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIElMOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpNOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpQOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBKRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpPOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgS0U6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBLSTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtQOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLUjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgS1c6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtHOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBMQTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFY6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMQjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExZOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTEk6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExVOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTU86ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1LOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1ZOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBNVjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1IOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVE6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFlUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVg6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRk06ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBNRDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1DOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTU46ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1FOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUE6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1NOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBOQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5SOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTlA6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5MOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkM6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBOWjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5JOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5FOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBOVTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5GOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVA6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBOTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE9NOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBQSzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgUFc6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBQUzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEE6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEc6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBQWTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBFOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEg6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBOOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBQVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBSOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFFBOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBSRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJPOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgUlU6ICJSVS1SdXNzaWEiLAogICAgICAgICAgICAgICAgICAgICAgICBSVzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJMOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNIOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgS046ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTEM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUY6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgUE06ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgV1M6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBTTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0E6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTTjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0M6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTTDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNHOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBTWDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBTSzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0I6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBTTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFpBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU1M6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBFUzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExLOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBTRDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNSOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0o6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0g6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTWTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRXOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBUSjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFo6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBUSDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEw6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEs6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBUTzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRUOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFROOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFI6ICJUSy1UdXJrZXkiLAogICAgICAgICAgICAgICAgICAgICAgICBUTTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFY6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBVRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHQjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVTOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVNOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkk6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVVk6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBVWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVlU6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBWRTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFZOOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBXRjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVIOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWUU6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFpNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWlc6ICJFVS1Mb25kb24iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgb2EgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBHYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFMgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBVYjsKICAgICAgICAgICAgICAgICAgICBjLmNvbm5lY3QgPSBsYjsKICAgICAgICAgICAgICAgICAgICB2YXIgSWEgPSA1MDAsCiAgICAgICAgICAgICAgICAgICAgICAgIENjID0gLjg3NSwKICAgICAgICAgICAgICAgICAgICAgICAgRWMgPSAuNzUsCiAgICAgICAgICAgICAgICAgICAgICAgIEZjID0gLjI1LAogICAgICAgICAgICAgICAgICAgICAgICBEYyA9IC4xMjUsCiAgICAgICAgICAgICAgICAgICAgICAgIFZiID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICAgIFdiID0gLTE7CiAgICAgICAgICAgICAgICAgICAgYy5zZW5kTWl0b3NpcyA9IGViOwogICAgICAgICAgICAgICAgICAgIGMuc2VuZEVqZWN0ID0gSmI7CiAgICAgICAgICAgICAgICAgICAgbS5uZXR3b3JraW5nID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5sb2dpblJlYWxtID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgR0c6ICJnb29nbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRkI6ICJmYWNlYm9vayIKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGEoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYS5ieXRlVmlldzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBVKDEgKyBhLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgMTAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBkLmxlbmd0aDsgKytjKSBhLnNldFVpbnQ4KDEgKyBjLCBkW2NdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFRva2VuKGQpOy8vQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWKGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0oe30pOwogICAgICAgICAgICAgICAgICAgIHZhciBIID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgTSA9IDEsCiAgICAgICAgICAgICAgICAgICAgICAgIFVhID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBxYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gMUUzIC8gNjA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHFjKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBkIC0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA+IGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGQgLSBlICUgYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZGEoKSB8fCAyNDAgPiBnIC0gRmEgfHwgIW0uY29yZS5jb25maWcuc2tpcERyYXcgPyBZYigpIDogY29uc29sZS53YXJuKCJTa2lwcGluZyBkcmF3Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjID0gMUUzIC8gZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5kZWJ1Zy51cGRhdGVDaGFydCgiZnBzIiwgZCwgcmMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KCksCiAgICAgICAgICAgICAgICAgICAgICAgIGhhID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgIE9iID0gInBvbGFuZDt1c2E7Y2hpbmE7cnVzc2lhO2NhbmFkYTthdXN0cmFsaWE7c3BhaW47YnJhemlsO2dlcm1hbnk7dWtyYWluZTtmcmFuY2U7c3dlZGVuO2NoYXBsaW47bm9ydGgga29yZWE7c291dGgga29yZWE7amFwYW47dW5pdGVkIGtpbmdkb207ZWFydGg7Z3JlZWNlO2xhdHZpYTtsaXRodWFuaWE7ZXN0b25pYTtmaW5sYW5kO25vcndheTtjaWE7bWFsZGl2YXM7YXVzdHJpYTtuaWdlcmlhO3JlZGRpdDt5YXJhbmFpa2E7Y29uZmVkZXJhdGU7OWdhZztpbmRpYW5hOzRjaGFuO2l0YWx5O2J1bGdhcmlhO3R1bWJscjsyY2guaGs7aG9uZyBrb25nO3BvcnR1Z2FsO2phbWFpY2E7Z2VybWFuIGVtcGlyZTttZXhpY287c2FuaWs7c3dpdHplcmxhbmQ7Y3JvYXRpYTtjaGlsZTtpbmRvbmVzaWE7YmFuZ2xhZGVzaDt0aGFpbGFuZDtpcmFuO2lyYXE7cGVydTttb29uO2JvdHN3YW5hO2Jvc25pYTtuZXRoZXJsYW5kcztldXJvcGVhbiB1bmlvbjt0YWl3YW47cGFraXN0YW47aHVuZ2FyeTtzYXRhbmlzdDtxaW5nIGR5bmFzdHk7bWF0cmlhcmNoeTtwYXRyaWFyY2h5O2ZlbWluaXNtO2lyZWxhbmQ7dGV4YXM7ZmFjZXB1bmNoO3Byb2RvdGE7Y2FtYm9kaWE7c3RlYW07cGljY29sbztlYTtpbmRpYTtrYztkZW5tYXJrO3F1ZWJlYztheXkgbG1hbztzZWFsYW5kO2JhaXQ7dHNhcmlzdCBydXNzaWE7b3JpZ2luO3ZpbmVzYXVjZTtzdGFsaW47YmVsZ2l1bTtsdXhlbWJvdXJnO3N0dXNzeTtwcnVzc2lhOzhjaDthcmdlbnRpbmE7c2NvdGxhbmQ7c2lyO3JvbWFuaWE7d29qYWs7ZG9nZTtuYXNhO2J5emFudGl1bTtpbXBlcmlhbCBqYXBhbjtmcmVuY2gga2luZ2RvbTtzb21hbGlhO3R1cmtleTttYXJzO3Bva2VyZmFjZTs4O2lycztyZWNlaXRhIGZlZGVyYWw7ZmFjZWJvb2s7cHV0aW47bWVya2VsO3RzaXByYXM7b2JhbWE7a2ltIGpvbmctdW47ZGlsbWE7aG9sbGFuZGU7YmVybHVzY29uaTtjYW1lcm9uO2NsaW50b247aGlsbGFyeTt2ZW5lenVlbGE7YmxhdHRlcjtjaGF2ZXo7Y3ViYTtmaWRlbDttZXJrZWw7cGFsaW47cXVlZW47Ym9yaXM7YnVzaDt0cnVtcCIuc3BsaXQoIjsiKSwKICAgICAgICAgICAgICAgICAgICAgICAgJGMgPSAiODtuYXNhO3B1dGluO21lcmtlbDt0c2lwcmFzO29iYW1hO2tpbSBqb25nLXVuO2RpbG1hO2hvbGxhbmRlO2Jlcmx1c2Nvbmk7Y2FtZXJvbjtjbGludG9uO2hpbGxhcnk7YmxhdHRlcjtjaGF2ZXo7ZmlkZWw7bWVya2VsO3BhbGluO3F1ZWVuO2JvcmlzO2J1c2g7dHJ1bXAiLnNwbGl0KCI7IiksCiAgICAgICAgICAgICAgICAgICAgICAgIHNhID0ge307CiAgICAgICAgICAgICAgICAgICAgQmIucHJvdG90eXBlID0gewogICAgICAgICAgICAgICAgICAgICAgICAkOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB4OiAwLAogICAgICAgICAgICAgICAgICAgICAgICB5OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBmOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBiOiAwCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgVGEgPSAtMSwKICAgICAgICAgICAgICAgICAgICAgICAgJGIgPSAhMTsKICAgICAgICAgICAgICAgICAgICBjYS5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBpOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBTOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB4OiAwLAogICAgICAgICAgICAgICAgICAgICAgICB5OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBzaXplOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBzOiAwLAogICAgICAgICAgICAgICAgICAgICAgICB1OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBvOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBqYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAga2E6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGc6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE06IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE46IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEo6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEs6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGVhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBVOiAwLAogICAgICAgICAgICAgICAgICAgICAgICByYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgRzogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGM6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBoOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgVjogITAsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBDOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBpYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgdWE6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBJOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgY2E6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhID0gMDsgYSA8IEEubGVuZ3RoOyBhKyspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFbYV0gPT0gdGhpcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBLnNwbGljZShhLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgS1t0aGlzLmlkXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBxLmluZGV4T2YodGhpcyk7IC0xICE9IGEgJiYgKHNiID0gITAsIHEuc3BsaWNlKGEsIDEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBFLmluZGV4T2YodGhpcy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FHQVJCT1RPVkgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgtMSAhPSBhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRS5zcGxpY2UoYSwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTXlCYWxsKHRoaXMuaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BR0FSQk9UT1ZICiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkcgPSAhMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgPCB0aGlzLmRhICYmIGJhLnB1c2godGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KH5+KC4zICogdGhpcy5zaXplKSwgMjQpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lID0gYSkgbnVsbCA9PSB0aGlzLmkgPyB0aGlzLmkgPSBuZXcgVmEodGhpcy5tKCksICIjRkZGRkZGIiwgITAsICIjMDAwMDAwIikgOiB0aGlzLmkuUCh0aGlzLm0oKSksIHRoaXMuaS5CKHRoaXMubmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgYmE6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSB0aGlzLkgoKSA7IHRoaXMuYS5sZW5ndGggPiBhOykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gfn4oTWF0aC5yYW5kb20oKSAqIHRoaXMuYS5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYS5zcGxpY2UoYiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoMCA9PSB0aGlzLmEubGVuZ3RoICYmIDAgPCBhICYmIHRoaXMuYS5wdXNoKG5ldyBCYih0aGlzLCB0aGlzLngsIHRoaXMueSwgdGhpcy5zaXplLCBNYXRoLnJhbmRvbSgpIC0gLjUpKSA7IHRoaXMuYS5sZW5ndGggPCBhOykgYiA9IH5+KE1hdGgucmFuZG9tKCkgKiB0aGlzLmEubGVuZ3RoKSwgYiA9IHRoaXMuYVtiXSwgdGhpcy5hLnB1c2gobmV3IEJiKHRoaXMsIGIueCwgYi55LCBiLmYsIGIuYikpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEg6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMCA+IHRoaXMuc2l6ZSAmJiAoYSA9IDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jICYmIChhID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNpemU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmMgfHwgKGIgKj0gbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICo9IE07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn5NYXRoLm1heChiLCBhKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBCYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iYSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMuYSwgYiA9IGEubGVuZ3RoLCBkID0gdGhpcywgYyA9IHRoaXMuYyA/IDAgOiAodGhpcy5pZCAvIDFFMyArIHggLyAxRTQpICUgKDIgKiBNYXRoLlBJKSwgZSA9IDAsIHAgPSAwOyBwIDwgYjsgKytwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBhWyhwIC0gMSArIGIpICUgYl0uYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IGFbKHAgKyAxKSAlIGJdLmIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBhW3BdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguYiArPSAoTWF0aC5yYW5kb20oKSAtIC41KSAqICh0aGlzLmggPyAzIDogMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5iICo9IC43OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwIDwgaC5iICYmIChoLmIgPSAxMCk7IC0xMCA+IGguYiAmJiAoaC5iID0gLTEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmIgPSAoZiArIGsgKyA4ICogaC5iKSAvIDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gaC5mLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gYVsocCAtIDEgKyBiKSAlIGJdLmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBhWyhwICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEpICUgYl0uZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMTUgPCB0aGlzLnNpemUgJiYgbnVsbCAhPSBpYSAmJiAyMCA8IHRoaXMuc2l6ZSAqIGwgJiYgMCA8IHRoaXMuaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIFFhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gaC54LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcSA9IGgueTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWEuRWEobSAtIDUsIHEgLSA1LCAxMCwgMTAsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLiQgIT0gZCAmJiAyNSA+IChtIC0gYS54KSAqIChtIC0gYS54KSArIChxIC0gYS55KSAqIChxIC0gYS55KSAmJiAoUWEgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFRYSAmJiAoaC54IDwgTWEgfHwgaC55IDwgTmEgfHwgaC54ID4gT2EgfHwgaC55ID4gUGEpICYmIChRYSA9ICEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUWEgJiYgKDAgPCBoLmIgJiYgKGguYiA9IDApLCAtLWguYikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiArPSBoLmI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA+IG4gJiYgKG4gPSAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gdGhpcy5oID8gKDE5ICogbiArIHRoaXMuc2l6ZSkgLyAyMCA6ICgxMiAqIG4gKyB0aGlzLnNpemUpIC8gMTM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5mID0gKGYgKyBrICsgOCAqIG4pIC8gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IDIgKiBNYXRoLlBJIC8gYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gaC5mOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYyAmJiAwID09IHAgJSAyICYmIChrICs9IDUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgueCA9IHRoaXMueCArIE1hdGguY29zKGYgKiBwICsgYykgKiBrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgueSA9IHRoaXMueSArIE1hdGguc2luKGYgKiBwICsgYykgKiBrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBNYXRoLm1heChlLCBrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pYSA9IGUKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbmE6IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLk0gPSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5OID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSiA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLksgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmphID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMua2EgPSBiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID49IHRoaXMuaWQpIHJldHVybiAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkYi5wYSgoeCAtIHRoaXMuVSkgLyAxMjAsIDAsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuRyAmJiAxIDw9IGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGJhLmluZGV4T2YodGhpcyk7IC0xICE9IGIgJiYgYmEuc3BsaWNlKGIsIDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnggPSBhICogKHRoaXMuamEgLSB0aGlzLnMpICsgdGhpcy5zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gYSAqICh0aGlzLmthIC0gdGhpcy51KSArIHRoaXMudTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2l6ZSA9IGEgKiAodGhpcy5nIC0gdGhpcy5vKSArIHRoaXMubzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4wMSA+IE1hdGguYWJzKHRoaXMuc2l6ZSAtIHRoaXMuZykgJiYgKHRoaXMuc2l6ZSA9IHRoaXMuZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBSOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCA+PSB0aGlzLmlkID8gITAgOiB0aGlzLnggKyB0aGlzLnNpemUgKyA0MCA8IHkgLSByIC8gMiAvIGwgfHwgdGhpcy55ICsgdGhpcy5zaXplICsgNDAgPCB6IC0gdCAvIDIgLyBsIHx8IHRoaXMueCAtIHRoaXMuc2l6ZSAtIDQwID4geSArIHIgLyAyIC8gbCB8fCB0aGlzLnkgLSB0aGlzLnNpemUgLSA0MCA+IHogKyB0IC8gMiAvIGwgPyAhMSA6ICEwCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHFhOiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubW92ZVRvKHRoaXMuYVswXS54LCB0aGlzLmFbMF0ueSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMTsgZCA8PSBiOyArK2QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGQgJSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGluZVRvKHRoaXMuYVtjXS54LCB0aGlzLmFbY10ueSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY2xvc2VQYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnN0cm9rZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHc6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5SKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK3RoaXMuZGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSAwIDwgdGhpcy5pZCAmJiAhdGhpcy5jICYmICF0aGlzLmggJiYgLjQgPiBsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDUgPiB0aGlzLkgoKSAmJiAwIDwgdGhpcy5pZCAmJiAoYiA9ICEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5WICYmICFiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IHRoaXMuYS5sZW5ndGg7IGQrKykgdGhpcy5hW2RdLmYgPSB0aGlzLnNpemU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5WID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJhID0geDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5UKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5HICYmIChhLmdsb2JhbEFscGhhICo9IDEgLSBkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxpbmVXaWR0aCA9IDEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGluZUNhcCA9ICJyb3VuZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lSm9pbiA9IHRoaXMuYyA/ICJtaXRlciIgOiAicm91bmQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcy5uYW1lLnRvTG93ZXJDYXNlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gdGhpcy5jb2xvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaCB8fCAhYWIgfHwgcWIgfHwgKC0xICE9IE9iLmluZGV4T2YoZSkgPyAoaGEuaGFzT3duUHJvcGVydHkoZSkgfHwgKGhhW2VdID0gbmV3IEltYWdlLCBoYVtlXS5zcmMgPSBjLkFTU0VUU19ST09UICsgInNraW5zLyIgKyBlICsgIi5wbmciKSwgZyA9IDAgIT0gaGFbZV0ud2lkdGggJiYgaGFbZV0uY29tcGxldGUgPyBoYVtlXSA6IG51bGwpIDogZyA9IG51bGwsIG51bGwgIT0gZyA/IC0xICE9ICRjLmluZGV4T2YoZSkgJiYgKGQgPSAhMCkgOiAodGhpcy5JICYmICIlc3RhcmJhbGwiID09IHRoaXMuQyAmJiAic2hlbnJvbiIgPT0gZSAmJiA3IDw9IHEubGVuZ3RoICYmICgkYiA9IGQgPSAhMCwgcCA9IGVjKCIlc3RhcmJhbGwxIikpLCBnID0gZWModGhpcy5DKSwgbnVsbCAhPSBnICYmIChoID0gITAsIGYgPSBOYyh0aGlzLkMpIHx8IGYpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jb3JlLmRlYnVnICYmIG0uZGVidWcuc2hvd1ByZWRpY3Rpb24gJiYgdGhpcy5JICYmIChhLnN0cm9rZVN0eWxlID0gIiMwMDAwRkYiLCBhLmJlZ2luUGF0aCgpLCBhLmFyYyh0aGlzLk0sIHRoaXMuTiwgdGhpcy5zaXplICsgNSwgMCwgMiAqIE1hdGguUEksICExKSwgYS5jbG9zZVBhdGgoKSwgYS5zdHJva2UoKSwgYS5zdHJva2VTdHlsZSA9ICIjMDBGRjAwIiwgYS5iZWdpblBhdGgoKSwgYS5hcmModGhpcy5KLCB0aGlzLkssIHRoaXMuc2l6ZSArIDUsIDAsIDIgKiBNYXRoLlBJLCAhMSksIGEuY2xvc2VQYXRoKCksIGEuc3Ryb2tlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhICYmICFxYiA/IChhLmZpbGxTdHlsZSA9ICIjRkZGRkZGIiwgYS5zdHJva2VTdHlsZSA9ICIjQUFBQUFBIikgOiAoYS5maWxsU3R5bGUgPSBmLCBhLnN0cm9rZVN0eWxlID0gZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA/IChhLmJlZ2luUGF0aCgpLCBhLmFyYyh0aGlzLngsIHRoaXMueSwgdGhpcy5zaXplICsgNSwgMCwgMiAqIE1hdGguUEksICExKSwgYS5jbG9zZVBhdGgoKSkgOiAodGhpcy5CYSgpLCB0aGlzLnFhKGEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoIHx8IGEuZmlsbCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gZyAmJiAodGhpcy5sYShhLCBnKSwgbnVsbCAhPSBwICYmIHRoaXMubGEoYSwgcCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTogTWF0aC5zaW4oLjAxNzQgKiBUYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRhIHx8IDE1IDwgdGhpcy5zaXplKSAmJiAhYiAmJiAoYS5zdHJva2VTdHlsZSA9ICIjMDAwMDAwIiwgYS5nbG9iYWxBbHBoYSAqPSAuMSwgYS5zdHJva2UoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IC0xICE9IHEuaW5kZXhPZih0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gfn50aGlzLnk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCAhPSB0aGlzLmlkICYmIChmYSB8fCBlKSAmJiB0aGlzLm5hbWUgJiYgdGhpcy5pICYmICFkICYmIChnID0gdGhpcy5pLCBnLkIodGhpcy5uYW1lKSwgZy5QKHRoaXMubSgpKSwgZCA9IDAgPj0gdGhpcy5pZCA/IDEgOiBNYXRoLmNlaWwoMTAgKiBsKSAvIDEwLCBnLm1hKGQpLCBnID0gZy5PKCksIHAgPSBNYXRoLmNlaWwoZy53aWR0aCAvIGQpLCBmID0gTWF0aC5jZWlsKGcuaGVpZ2h0IC8gZCksIGEuZHJhd0ltYWdlKGcsIH5+dGhpcy54IC0gfn4ocCAvIDIpLCBiIC0gfn4oZiAvIDIpLCBwLCBmKSwgYiArPSBnLmhlaWdodCAvIDIgLyBkICsgNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHRoaXMuaWQgJiYgYmIgJiYgKGUgfHwgMCA9PSBxLmxlbmd0aCAmJiAoIXRoaXMuYyB8fCB0aGlzLmgpICYmIDIwIDwgdGhpcy5zaXplKSAmJiAobnVsbCA9PSB0aGlzLlMgJiYgKHRoaXMuUyA9IG5ldyBWYSh0aGlzLm0oKSAvIDIsICIjRkZGRkZGIiwgITAsICIjMDAwMDAwIikpLCBlID0gdGhpcy5TLCBlLlAodGhpcy5tKCkgLyAyKSwgZS5CKH5+KHRoaXMuc2l6ZSAqIHRoaXMuc2l6ZSAvIDEwMCkpLCBkID0gTWF0aC5jZWlsKDEwICogbCkgLyAxMCwgZS5tYShkKSwgZyA9IGUuTygpLCBwID0gTWF0aC5jZWlsKGcud2lkdGggLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkKSwgZiA9IE1hdGguY2VpbChnLmhlaWdodCAvIGQpLCBhLmRyYXdJbWFnZShnLCB+fnRoaXMueCAtIH5+KHAgLyAyKSwgYiAtIH5+KGYgLyAyKSwgcCwgZikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVzdG9yZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGxhOiBmdW5jdGlvbiAoYSwgYiwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmNsaXAoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gTWF0aC5tYXgodGhpcy5zaXplLCB0aGlzLmlhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gZCAmJiBudWxsICE9IGQuYWxwaGEgJiYgKGEuZ2xvYmFsQWxwaGEgPSBkLmFscGhhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuZHJhd0ltYWdlKGIsIHRoaXMueCAtIGMgLSA1LCB0aGlzLnkgLSBjIC0gNSwgMiAqIGMgKyAxMCwgMiAqIGMgKyAxMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3RvcmUoKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgZGIgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKGEsIGIsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhIDwgYiA/IGIgOiBhID4gYyA/IGMgOiBhCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYS5oYSA9IGZ1bmN0aW9uIChhLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBiKC41LCAwLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhICsgZSAqIChjIC0gYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5wYSA9IGI7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuZml4ZWQgPSBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBNYXRoLnBvdygxMCwgYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oYSAqIGMpIC8gYwogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0oe30pOwogICAgICAgICAgICAgICAgICAgIGMuTWF0aHMgPSBkYjsKICAgICAgICAgICAgICAgICAgICB2YXIgSGEgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBhLkwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUsIGMgPSBbYS5nZXRNb250aCgpICsgMSwgYS5nZXREYXRlKCksIGEuZ2V0RnVsbFllYXIoKV0sIGEgPSBbYS5nZXRIb3VycygpLCBhLmdldE1pbnV0ZXMoKSwgYS5nZXRTZWNvbmRzKCldLCBlID0gMTsgMyA+IGU7IGUrKykgMTAgPiBhW2VdICYmIChhW2VdID0gIjAiICsgYVtlXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIlsiICsgYy5qb2luKCIvIikgKyAiICIgKyBhLmpvaW4oIjoiKSArICJdIgogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0oe30pOwogICAgICAgICAgICAgICAgICAgIGMuVXRpbHMgPSBIYTsKICAgICAgICAgICAgICAgICAgICBWYS5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEY6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICBXOiAiIzAwMDAwMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFk6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBaOiAiIzAwMDAwMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHY6IDE2LAogICAgICAgICAgICAgICAgICAgICAgICBqOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBYOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBsOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgRDogMSwKICAgICAgICAgICAgICAgICAgICAgICAgUDogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudiAhPSBhICYmICh0aGlzLnYgPSBhLCB0aGlzLmwgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbWE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkQgIT0gYSAmJiAodGhpcy5EID0gYSwgdGhpcy5sID0gITApCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEI6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhICE9IHRoaXMuRiAmJiAodGhpcy5GID0gYSwgdGhpcy5sID0gITApCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIE86IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT0gdGhpcy5qICYmICh0aGlzLmogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKSwgdGhpcy5YID0gdGhpcy5qLmdldENvbnRleHQoIjJkIikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubCA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcy5qLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5YLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5GLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5ELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gdGhpcy52LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gZyArICJweCBVYnVudHUiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZm9udCA9IGY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSB+figuMiAqIGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEud2lkdGggPSAoYi5tZWFzdXJlVGV4dChjKS53aWR0aCArIDYpICogZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmhlaWdodCA9IChnICsgaCkgKiBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZm9udCA9IGY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5zY2FsZShlLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmxpbmVXaWR0aCA9IDM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IHRoaXMuWjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGxTdHlsZSA9IHRoaXMuVzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlkgJiYgYi5zdHJva2VUZXh0KGMsIDMsIGcgLSBoIC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5maWxsVGV4dChjLCAzLCBnIC0gaCAvIDIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5qCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIERhdGUubm93IHx8IChEYXRlLm5vdyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSkuZ2V0VGltZSgpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IFsibXMiLCAibW96IiwgIndlYmtpdCIsICJvIl0sIGIgPSAwOyBiIDwgYS5sZW5ndGggJiYgIWMucmVxdWVzdEFuaW1hdGlvbkZyYW1lOyArK2IpIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gY1thW2JdICsgIlJlcXVlc3RBbmltYXRpb25GcmFtZSJdLCBjLmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gY1thW2JdICsgIkNhbmNlbEFuaW1hdGlvbkZyYW1lIl0gfHwgY1thW2JdICsgIkNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSJdOwogICAgICAgICAgICAgICAgICAgICAgICBjLnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCAoYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoYSwgMUUzIC8gNjApCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGMuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgdmMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhIDwgZSAmJiAoYSA9IGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPiBmICYmIChhID0gZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIH5+KChhIC0gZSkgLyAzMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhIDwgZyAmJiAoYSA9IGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPiBoICYmIChhID0gaCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIH5+KChhIC0gZykgLyAzMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gYS56YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gYS5BYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gYS54YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gYS55YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gfn4oKGYgLSBlKSAvIDMyKSArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbSA9IH5+KChoIC0gZykgLyAzMikgKyAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBBcnJheShrICogbSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhOiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKGEueCkgKyBjKGEueSkgKiBrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IG5bZV0gPyBuW2VdID0gYSA6IEFycmF5LmlzQXJyYXkobltlXSkgPyBuW2VdLnB1c2goYSkgOiBuW2VdID0gW25bZV0sIGFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFYTogZnVuY3Rpb24gKGEsIGUsIGcsIGYsIGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBiKGEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGMoZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBiKGEgKyBnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGMoZSArIGYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA+IHAgfHwgcCA+PSBrIHx8IDAgPiB1IHx8IHUgPj0gbSkgZGVidWdnZXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyB1IDw9IGU7ICsrdSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZiA9IHA7IGYgPD0gYTsgKytmKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnID0gbltmICsgdSAqIGtdLCBudWxsICE9IGcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGcpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBnLmxlbmd0aDsgbCsrKSBoKGdbbF0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGgoZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBUYiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IGNhKDAsIDAsIDAsIDMyLCAiI0VEMUMyNCIsICIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLndpZHRoID0gMzI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmhlaWdodCA9IDMyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgPCBxLmxlbmd0aCAmJiAoYS5jb2xvciA9IHFbMF0uY29sb3IsIGEuQShxWzBdLm5hbWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmNsZWFyUmVjdCgwLCAwLCAzMiwgMzIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMudHJhbnNsYXRlKDE2LCAxNik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5zY2FsZSguNCwgLjQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudyhjKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmYXZpY29uIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBlLmNsb25lTm9kZSghMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5zZXRBdHRyaWJ1dGUoImhyZWYiLCBiLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZywgZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSgpOwogICAgICAgICAgICAgICAgICAgIGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBUYigpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIFdhID0gewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0UHJvdmlkZXI6ICJmYWNlYm9vayIsCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2luSW50ZW50OiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJbmZvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NpYWxUb2tlbjogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuRXhwaXJlczogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cDogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cE5lZWRlZDogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpY3R1cmU6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VkSW46ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2lhbElkOiAiIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGMuZGVmYXVsdFN0ID0gV2E7CiAgICAgICAgICAgICAgICAgICAgYy5zdG9yYWdlSW5mbyA9IGg7CiAgICAgICAgICAgICAgICAgICAgYy5jcmVhdGVEZWZhdWx0U3RvcmFnZSA9IFBjOwogICAgICAgICAgICAgICAgICAgIGMudXBkYXRlU3RvcmFnZSA9IFhhOwogICAgICAgICAgICAgICAgICAgIGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyAmJiAoaCA9IEpTT04ucGFyc2UoYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICIxIiA9PSBoLmxvZ2luSW50ZW50ICYmIGZjKGguY29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICIiID09IGgudXNlckluZm8ubmFtZSAmJiAiIiA9PSBoLnVzZXJJbmZvLmRpc3BsYXlOYW1lIHx8IGdjKGgudXNlckluZm8pCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgYy5jaGVja0xvZ2luU3RhdHVzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAiMSIgPT0gaC5sb2dpbkludGVudCAmJiAoWWEoKSwgZmMoaC5jb250ZXh0KSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBZYSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYy5NQy5zZXRQcm9maWxlUGljdHVyZShoLnVzZXJJbmZvLnBpY3R1cmUpOwogICAgICAgICAgICAgICAgICAgICAgICBjLk1DLnNldFNvY2lhbElkKGgudXNlckluZm8uc29jaWFsSWQpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLmxvZ291dCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaCA9IFdhOwogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvOwogICAgICAgICAgICAgICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8gPSBKU09OLnN0cmluZ2lmeShXYSk7CiAgICAgICAgICAgICAgICAgICAgICAgIFhhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uY2FjaGUuc2VudEdhbWVTZXJ2ZXJMb2dpbiA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgbS5jYWNoZS5sb2dpbl9pbmZvOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWxvZ2dlZC1pbiIsICIwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIsICIwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIi50aW1lciIpLnRleHQoIiIpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjZ1BsdXNTaGFyZSIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2ZiU2hhcmUiKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiN1c2VyLWlkLXRhZyIpLnRleHQoIiIpOwogICAgICAgICAgICAgICAgICAgICAgICBRKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuTUMuZG9Mb2dvdXQoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy50b2dnbGVTb2NpYWxMb2dpbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NvY2lhbExvZ2luQ29udGFpbmVyIikudG9nZ2xlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzZXR0aW5ncyIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2luc3RydWN0aW9ucyIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgQ2IoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy50b2dnbGVTZXR0aW5ncyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NldHRpbmdzIikudG9nZ2xlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzb2NpYWxMb2dpbkNvbnRhaW5lciIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2luc3RydWN0aW9ucyIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgQ2IoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgbS5hY2NvdW50ID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYigpIHsgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhIYS5MKCkgKyAiIGdvdCB1c2VyIGxvZ2luIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBmIHx8IGYuaWQgIT0gYi5pZCkgZiA9IGIsIG51bGwgIT0gYy5zc2FfanNvbiAmJiAoYy5zc2FfanNvbi5hcHBsaWNhdGlvblVzZXJJZCA9ICIiICsgYi5pZCwgYy5zc2FfanNvbi5jdXN0b21fdXNlcl9pZCA9ICIiICsgYi5pZCksICJ1bmRlZmluZWQiICE9IHR5cGVvZiBTU0FfQ09SRSAmJiBTU0FfQ09SRS5zdGFydCgpLCBlKCIjb2ZmZXJ3YWxsSWZyYW1lIikuYXR0cigic3JjIiwgImh0dHA6Ly93d3cuc3VwZXJzb25pY2Fkcy5jb20vZGVsaXZlcnkvcGFuZWwucGhwP2FwcGxpY2F0aW9uS2V5PSIgKyBFbnZDb25maWcuc3VwZXJzb25pY19hcHBfa2V5ICsgIiZhcHBsaWNhdGlvblVzZXJJZD0iICsgYi5pZCArICImY3VzdG9tX3VzZXJfaWQ9IiArIGIuaWQgKyAiJmFwcGxpY2F0aW9uVXNlcklkU2lnbmF0dXJlPW9wdGlvbmFsIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuaW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5iaW5kKCJ1c2VyX2xvZ2luIiwgZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuYmluZCgidXNlcl9sb2dvdXQiLCBiKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnNldFVzZXJEYXRhID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdjKGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuc2V0QWNjb3VudERhdGEgPSBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWhhcy1hY2NvdW50LWRhdGEiLCAiMSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC51c2VySW5mby54cCA9IGEueHA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnhwTmVlZGVkID0gYS54cE5lZWRlZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ubGV2ZWwgPSBhLmxldmVsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWGEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgJiYgYiA/IGdhKGEpIDogKGUoIi5hZ2FyaW8tcHJvZmlsZS1wYW5lbCAucHJvZ3Jlc3MtYmFyLXN0YXIiKS50ZXh0KGEubGV2ZWwpLCBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikudGV4dChhLnhwICsgIi8iICsgYS54cE5lZWRlZCArICIgWFAiKSwgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXIiKS5jc3MoIndpZHRoIiwgKDg4ICogYS54cCAvIGEueHBOZWVkZWQpLnRvRml4ZWQoMikgKyAiJSIpKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLkdhID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhKGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGljID0gMDsKICAgICAgICAgICAgICAgICAgICBjLmZiQXN5bmNJbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCA9PSBjLkZCID8gYWxlcnQoIllvdSBzZWVtIHRvIGhhdmUgc29tZXRoaW5nIGJsb2NraW5nIEZhY2Vib29rIG9uIHlvdXIgYnJvd3NlciwgcGxlYXNlIGNoZWNrIGZvciBhbnkgZXh0ZW5zaW9ucyIpIDogKGgubG9naW5JbnRlbnQgPSAiMSIsIGMudXBkYXRlU3RvcmFnZSgpLCBjLkZCLmxvZ2luKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGMoYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZTogInB1YmxpY19wcm9maWxlLCBlbWFpbCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGMuRkIuaW5pdCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBJZDogRW52Q29uZmlnLmZiX2FwcF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZTogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZmJtbDogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogInYyLjIiCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAoIjEiID09IGMuc3RvcmFnZUluZm8ubG9naW5JbnRlbnQgJiYgImZhY2Vib29rIiA9PSBjLnN0b3JhZ2VJbmZvLmNvbnRleHQgfHwgbmMpICYmIGMuRkIuZ2V0TG9naW5TdGF0dXMoZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb25uZWN0ZWQiID09PSBiLnN0YXR1cyA/IGhjKGIpIDogIm5vdF9hdXRob3JpemVkIiA9PT0gYi5zdGF0dXMgPyAoYy5sb2dvdXQoKSwgYSgpKSA6IGMubG9nb3V0KCkKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuZmFjZWJvb2tSZWxvZ2luID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5mYWNlYm9va0xvZ2luID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIEhiID0gITE7CiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS50eXBlID0gInRleHQvamF2YXNjcmlwdCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmFzeW5jID0gITA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNyYyA9ICIvL2FwaXMuZ29vZ2xlLmNvbS9qcy9jbGllbnQ6cGxhdGZvcm0uanM/b25sb2FkPWdhcGlBc3luY0luaXQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgic2NyaXB0IilbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsIGIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9ICEwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSAhMTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5nYXBpQXN5bmNJbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZShkKS50cmlnZ2VyKCJpbml0aWFsaXplZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuZ29vZ2xlID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmE6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYTogZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmdhcGkuY2xpZW50LmxvYWQoInBsdXMiLCAidjEiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJmZXRjaGluZyBtZSBwcm9maWxlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhcGkuY2xpZW50LnBsdXMucGVvcGxlLmdldCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6ICJtZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuZXhlY3V0ZShmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYihhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuRGEgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiB8fCBiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW5kZWZpbmVkIiAhPT0gdHlwZW9mIGdhcGkgPyBhKCkgOiBlKGQpLmJpbmQoImluaXRpYWxpemVkIiwgYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KShtKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYWQgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuTUMuZG9Mb2dpbldpdGhHUGx1cyhhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY2FjaGUubG9naW5faW5mbyA9IFthLCAiZ29vZ2xlIl0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnBpY3R1cmUgPSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLXBpY3R1cmUiKS5hdHRyKCJzcmMiLCBhKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50X2lkOiBFbnZDb25maWcuZ3BsdXNfY2xpZW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZV9wb2xpY3k6ICJzaW5nbGVfaG9zdF9vcmlnaW4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAicHJvZmlsZSBlbWFpbCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuZmEgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGggJiYgIjEiID09IGgubG9naW5JbnRlbnQgJiYgImdvb2dsZSIgPT0gaC5jb250ZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uRGEoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmdhcGkueXRzdWJzY3JpYmUuZ28oImFnYXJZb3V0dWJlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS5sb2FkKCJhdXRoMiIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBjLmdhcGkuYXV0aDIuaW5pdChnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuYXR0YWNoQ2xpY2tIYW5kbGVyKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJncGx1c0xvZ2luIiksIHt9LCBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJnb29nbGVVc2VyIDogIiArIGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJmYWlsZWQgdG8gbG9naW4gaW4gZ29vZ2xlIHBsdXM6ICIsIEpTT04uc3RyaW5naWZ5KGEsIHZvaWQgMCwgMikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuY3VycmVudFVzZXIubGlzdGVuKF8uYmluZChhLkNhLCBhKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICYmIDEgPT0gZi5pc1NpZ25lZEluLmdldCgpICYmIGYuc2lnbkluKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhOiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmICYmIGEgJiYgZi5pc1NpZ25lZEluLmdldCgpICYmICFIYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIYiA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmxvZ2luSW50ZW50ID0gIjEiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGEuZ2V0QXV0aFJlc3BvbnNlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gZS5hY2Nlc3NfdG9rZW47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMub2EgPSBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygibG9nZ2VkSW4gd2l0aCBHKyEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBhLmdldEJhc2ljUHJvZmlsZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gbC5nZXRJbWFnZVVybCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIDAgPT0gYSA/IG0uZ29vZ2xlLnNhKGUsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3VsdC5pc1BsdXNVc2VyID8gKGEgJiYgZChhLmltYWdlLnVybCksIGIoZyksIGEgJiYgKGgudXNlckluZm8ucGljdHVyZSA9IGEuaW1hZ2UudXJsKSwgaC51c2VySW5mby5zb2NpYWxJZCA9IGwuZ2V0SWQoKSwgWWEoKSkgOiAoYWxlcnQoIlBsZWFzZSBhZGQgR29vZ2xlKyB0byB5b3VyIEdvb2dsZSBhY2NvdW50IGFuZCB0cnkgYWdhaW4uXG5PciB5b3UgY2FuIGxvZ2luIHdpdGggYW5vdGhlciBhY2NvdW50LiIpLCBjLmxvZ291dCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSA6IChkKGEpLCBoLnVzZXJJbmZvLnBpY3R1cmUgPSBhLCBoLnVzZXJJbmZvLnNvY2lhbElkID0gbC5nZXRJZCgpLCBZYSgpLCBiKGcpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5jb250ZXh0ID0gImdvb2dsZSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMudXBkYXRlU3RvcmFnZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiAmJiAoZi5zaWduT3V0KCksIEhiID0gITEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfShtKTsKICAgICAgICAgICAgICAgICAgICBjLmdwbHVzTW9kdWxlID0gYWQ7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBtLmZhLndhKCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMubG9nb3V0R29vZ2xlUGx1cyA9IHNjOwogICAgICAgICAgICAgICAgICAgIHZhciBaYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYShhLCBiLCBjLCBkLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGIuZ2V0Q29udGV4dCgiMmQiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gYi53aWR0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBiLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY29sb3IgPSBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5BKGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zaXplID0gZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi50cmFuc2xhdGUoZyAvIDIsIGIgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudyhmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYucmVzdG9yZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IG5ldyBjYSgtMSwgMCwgMCwgMzIsICIjNWJjMGRlIiwgIiIpLCBjID0gbmV3IGNhKC0xLCAwLCAwLCAzMiwgIiM1YmMwZGUiLCAiIiksIGYgPSAiIzA3OTFmZiAjNWEwN2ZmICNmZjA3ZmUgI2ZmYTUwNyAjZmYwNzc0ICMwNzdmZmYgIzNhZmYwNyAjZmYwN2VkICMwN2E4ZmYgI2ZmMDc2ZSAjM2ZmZjA3ICNmZjA3MzQgIzA3ZmYyMCAjZmYwN2EyICNmZjgyMDcgIzA3ZmYwZSIuc3BsaXQoIiAiKSwgZyA9IFtdLCBoID0gMDsgaCA8IGYubGVuZ3RoOyArK2gpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsID0gaCAvIGYubGVuZ3RoICogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IDMwICogTWF0aC5zcXJ0KGggLyBmLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnB1c2gobmV3IGNhKC0xLCBNYXRoLmNvcyhsKSAqIGssIE1hdGguc2luKGwpICogaywgMTAsIGZbaF0sICIiKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBPYyhnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgbS5nZXRDb250ZXh0KCIyZCIpOwogICAgICAgICAgICAgICAgICAgICAgICBtLndpZHRoID0gbS5oZWlnaHQgPSA3MDsKICAgICAgICAgICAgICAgICAgICAgICAgYShjLCBtLCAiIiwgMjYsICIjZWJjMGRlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuY2VsbC1zcGlubmVyIikuZmlsdGVyKCI6dmlzaWJsZSIpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gZSh0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0aGlzLndpZHRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gdGhpcy5oZWlnaHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSB0aGlzLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5jbGVhclJlY3QoMCwgMCwgZiwgZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC50cmFuc2xhdGUoZiAvIDIsIGcgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgMTAgPiBrOyArK2spIGguZHJhd0ltYWdlKG0sICguMSAqIGQgKyA4MCAqIGspICUgKGYgKyAxNDApIC0gZiAvIDIgLSA3MCAtIDM1LCBnIC8gMiAqIE1hdGguc2luKCguMDAxICogZCArIGspICUgTWF0aC5QSSAqIDIpIC0gMzUsIDcwLCA3MCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5yZXN0b3JlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMgPSBjLmF0dHIoImRhdGEtaXRyIikpICYmIChjID0gUihjKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYShiLCB0aGlzLCBjIHx8ICIiLCArZSh0aGlzKS5hdHRyKCJkYXRhLXNpemUiKSwgIiM1YmMwZGUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIjc3RhdHNQZWxsZXRzIikuZmlsdGVyKCI6dmlzaWJsZSIpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLndpZHRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5oZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDb250ZXh0KCIyZCIpLmNsZWFyUmVjdCgwLCAwLCBiLCBjKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZy5sZW5ndGg7IGIrKykgYShnW2JdLCB0aGlzLCAiIiwgZ1tiXS5zaXplLCBnW2JdLmNvbG9yKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0oKTsKICAgICAgICAgICAgICAgICAgICBjLmNyZWF0ZVBhcnR5ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBrYSgiOnBhcnR5Iik7CiAgICAgICAgICAgICAgICAgICAgICAgIFMgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgRGIoIi8jIiArIGMuZW5jb2RlVVJJQ29tcG9uZW50KGEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5wYXJ0eVRva2VuIikudmFsKCJhZ2FyLmlvLyMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIxIikKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgUSgpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLmpvaW5QYXJ0eSA9IGpjOwogICAgICAgICAgICAgICAgICAgIGMuY2FuY2VsUGFydHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIERiKCIvIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiMCIpOwogICAgICAgICAgICAgICAgICAgICAgICBrYSgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIFEoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIEYgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgdWIgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB2YiA9ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgYWEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgRWEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgUmEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBFYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHhiID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgd2IgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBXID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgWmEgPSAhMDsKICAgICAgICAgICAgICAgICAgICBjLm9uUGxheWVyRGVhdGggPSBKYTsKICAgICAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEVhICYmIEYucHVzaChhYygpIC8gMTAwKQogICAgICAgICAgICAgICAgICAgIH0sIDFFMyAvIDYwKTsKICAgICAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gUmMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgMCAhPSBhICYmICgrK3hiLCAwID09IFcgJiYgKFcgPSBhKSwgVyA9IE1hdGgubWluKFcsIGEpKQogICAgICAgICAgICAgICAgICAgIH0sIDFFMyk7CiAgICAgICAgICAgICAgICAgICAgYy5jbG9zZVN0YXRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBhYSA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc3RhdHMiKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuZGVzdHJveUFkKGMuYWRTbG90cy5hYik7CiAgICAgICAgICAgICAgICAgICAgICAgIHlhKDApCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldFNraXBTdGF0cyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFphID0gIWEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuZ2V0U3RhdHNTdHJpbmcgPSBsYzsKICAgICAgICAgICAgICAgICAgICBjLmdQbHVzU2hhcmUgPSBUYzsKICAgICAgICAgICAgICAgICAgICBjLnR3aXR0ZXJTaGFyZVN0YXRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGMuZ2V0U3RhdHNTdHJpbmcoInR0X3NoYXJlX3N0YXRzIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGMub3BlbigiaHR0cHM6Ly90d2l0dGVyLmNvbS9pbnRlbnQvdHdlZXQ/dGV4dD0iICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEsICJBZ2FyLmlvIiwgIndpZHRoPTY2MCxoZWlnaHQ9MzEwLG1lbnViYXI9bm8sdG9vbGJhcj1ubyxyZXNpemFibGU9eWVzLHNjcm9sbGJhcnM9bm8sbGVmdD0iICsgKGMuc2NyZWVuWCArIGMuaW5uZXJXaWR0aCAvIDIgLSAzMzApICsgIix0b3A9IiArIChjLmlubmVySGVpZ2h0IC0gMzEwKSAvIDIpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLmZiU2hhcmVTdGF0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBjLmdldFN0YXRzU3RyaW5nKCJmYl9tYXRjaHJlc3VsdHNfc3VidGl0bGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5GQi51aSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJmZWVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6ICJpZnJhbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogUigiZmJfbWF0Y2hyZXN1bHRzX3RpdGxlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uOiBSKCJmYl9tYXRjaHJlc3VsdHNfZGVzY3JpcHRpb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogImh0dHA6Ly9hZ2FyLmlvIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEphOiAiaHR0cDovL3N0YXRpYzIubWluaWNsaXBjZG4uY29tL21vYmlsZS9hZ2FyL0FnYXIuaW9fbWF0Y2hyZXN1bHRzX2ZiXzEyMDB4NjMwLnBuZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJwbGF5IG5vdyEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6ICJodHRwOi8vYWdhci5pbyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuZmlsbFNvY2lhbFZhbHVlcyA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDEgPT0gYy5pc0Nocm9tZSAmJiAiZ29vZ2xlIiA9PSBjLnN0b3JhZ2VJbmZvLmNvbnRleHQgJiYgYy5nYXBpLmludGVyYWN0aXZlcG9zdC5yZW5kZXIoYiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudHVybDogRW52Q29uZmlnLmdhbWVfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50aWQ6IEVudkNvbmZpZy5ncGx1c19jbGllbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWVwb2xpY3k6ICJodHRwOi8vYWdhci5pbyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmaWxsdGV4dDogYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGx0b2FjdGlvbmxhYmVsOiAiQkVBVCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsdG9hY3Rpb251cmw6IEVudkNvbmZpZy5nYW1lX3VybAogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJNQXN5bmNJbml0IiBpbiBjICYmIGMuTUFzeW5jSW5pdCgpCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gT1JJR0lOQUwgU0NSSVBUCiAgICAgICAgICAgIHZhciB3aW5kbyA9IGM7CiAgICAgICAgICAgIHZhciBzdG9wTW92ZSA9IGZhbHNlOwogICAgICAgICAgICB2YXIgYXV0b0ZlZWRJbnRlcnZhbCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIGF1dG9TcGxpdEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgc2VuZEJ1ZmZlciA9IFY7CiAgICAgICAgICAgIHZhciBzZW5kVmFsID0gWDsKICAgICAgICAgICAgLy9BR0FSQk9UT1ZIIG1vZGlmIEliIHBvdXIgbGEgbcOpdGhvZGUgcXVpIGZhaXQgbGVzIG9ua2V5dXAgb25rZXlkb3duCiAgICAgICAgICAgIEliID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgd2luZG8ub25rZXl1cCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgMzIgPT0gYS5rZXlDb2RlICYmICh2YSA9ICExKTsKICAgICAgICAgICAgICAgICAgICA4NyA9PSBhLmtleUNvZGUgJiYgKHhhID0gITEpOwogICAgICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiB3YSAmJiAoWCgxOSksIHdhID0gITEpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB3aW5kby5vbmtleWRvd24gPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdrZXlEb3duJywgYSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA2OSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZW1pdCBzcGxpdCAhJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdzcGxpdCcsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjbGllbnRfdXVpZCI6IDgKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChhLmtleUNvZGUgPT0gODIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgZmVlZCAhJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdmZWVkJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgMzIgIT0gYS5rZXlDb2RlIHx8IHZhIHx8ICgibmljayIgIT0gYS50YXJnZXQuaWQgJiYgYS5wcmV2ZW50RGVmYXVsdCgpLCBlYigpLCB2YSA9ICEwKTsKICAgICAgICAgICAgICAgICAgICA4MSA9PSBhLmtleUNvZGUgJiYgKFgoMTgpLCB3YSA9ICEwKTsKICAgICAgICAgICAgICAgICAgICA4NyAhPSBhLmtleUNvZGUgfHwgeGEgfHwgKEpiKCksIHhhID0gITApOwogICAgICAgICAgICAgICAgICAgIDI3ID09IGEua2V5Q29kZSAmJiAoYS5wcmV2ZW50RGVmYXVsdCgpLCB5YSgzMDApLCBlKCIjb2ZlcndhbGxDb250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiBjLmNsb3NlT2ZmZXJ3YWxsKCksIGUoIiN2aWRlb0NvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VWaWRlb0NvbnRhaW5lcigpKQogICAgICAgICAgICAgICAgICAgIGlmIChhLmtleUNvZGUgPT0gODgpIHsvLyB4CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd4JyxidCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhLnNoaWZ0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQgIT0gdW5kZWZpbmVkICYmIGJ0LnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IGFjdGlvbjogMTkgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0ICE9IHVuZGVmaW5lZCAmJiBidC5yZWFkeVN0YXRlID09IFdlYlNvY2tldC5PUEVOKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBhY3Rpb246IDE1IH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDY3KSB7Ly8gYwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnYycpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQgIT0gdW5kZWZpbmVkICYmIGJ0LnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgYWN0aW9uOiAxNiB9KSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gODYpIHsvLyB2CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdjJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChidCAhPSB1bmRlZmluZWQgJiYgYnQucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuT1BFTikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBhY3Rpb246IDE3IH0pKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSA2Nikgey8vIGIKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2MnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0ICE9IHVuZGVmaW5lZCAmJiBidC5yZWFkeVN0YXRlID09IFdlYlNvY2tldC5PUEVOKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IGFjdGlvbjogMTggfSkpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDgzICYmICJuaWNrIiAhPSBhLnRhcmdldC5pZCkgey8vIHMKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3MnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dG9GZWVkSW50ZXJ2YWwgPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0ZlZWRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kVmFsKDIxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvRmVlZEludGVydmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9GZWVkSW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaCgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDMyICYmIGEuc2hpZnRLZXkgJiYgIm5pY2siICE9IGEudGFyZ2V0LmlkKSB7Ly8gcwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc3BhY2UnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG51bWJlciA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRvU3BsaXRJbnRlcnZhbCA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU3BsaXRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kVmFsKDE3KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVtYmVyID09IDcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvU3BsaXRJbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TcGxpdEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvU3BsaXRJbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU3BsaXRJbnRlcnZhbCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gNjggJiYgIm5pY2siICE9IGEudGFyZ2V0LmlkKSB7Ly8gRAogICAgICAgICAgICAgICAgICAgICAgICBzdG9wTW92ZSA9ICFzdG9wTW92ZTsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnU1RPUE1PVkUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAgICAgICAgICogY29uc29sZS5sb2coJ0x0JyxMdCk7IGNvbnNvbGUubG9nKCdFdCcsRXQpOyBjb25zb2xlLmxvZygnVHQnLFR0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICogY29uc29sZS5sb2coJ3d0Jyx3dCk7IGNvbnNvbGUubG9nKCdQdCcsUHQpOyBjb25zb2xlLmxvZygnQ3QnLEN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSA2OSAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpIHsvLyBFCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4dCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gNzAgJiYgIm5pY2siICE9IGEudGFyZ2V0LmlkKSB7Ly8gRgogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhxKTsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciBidCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIGlwID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgcm9vbSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIHNvY2tldCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIG9wZW5Tb2NrZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBidCAmJiBidC5jbG9zZSgpOwogICAgICAgICAgICAgICAgLy9idCA9IG5ldyBXZWJTb2NrZXQoIndzOi8vbG9jYWxob3N0OjE4NDEiKTsKICAgICAgICAgICAgICAgIC8vYnQgPSBuZXcgV2ViU29ja2V0KCJ3czovL3NlcnZlci5hZ2FyYm90Lm92aDo5MCIpOwogICAgICAgICAgICAgICAgYnQgPSBuZXcgV2ViU29ja2V0KCJ3czovLzE3OC4yNTQuMjIuNzI6ODA4MSIpOwogICAgICAgICAgICAgICAgc29ja2V0ID0gaW8uY29ubmVjdCgnd3M6Ly8xNzguMjU0LjIyLjcyOjgwODEnKTsKICAgICAgICAgICAgICAgIHNvY2tldC5vbigndGVzdCcsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25pY2UsIHdvcmtpbmcnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBidC5iaW5hcnlUeXBlID0gImFycmF5YnVmZmVyIjsKICAgICAgICAgICAgICAgIGJ0Lm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB4dCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgY2hhbmdlR2FtZU1vZGUoKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBidC5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdELUJvdHMuY29tIDogVEhFIFNFTlRFTkNFIEJFRk9SRSBJUyBUSEUgUkVBU09OIFdIWSBZT1UgSEFWRSBUUk9VQkxFUyBDT05ORUNUSU5HJywgZSwgJ2Nvbm5lY3Rpb24gZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcygnRC1Cb3RzLmNvbSA6IENvbm5leGlvbiBlcnJvciwgY2hlY2sgRjEyID4gY29uc29sZSB0byBoYXZlIG1vcmUgaW5mb3MnKTsKICAgICAgICAgICAgICAgICAgICBzZXRUeHQoZ2V0SW5mb3MoKSk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgYnQub25tZXNzYWdlID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodC5kYXRhLnN0YXJ0c1dpdGgoJ3BpbmcnKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHQuZGF0YS5zcGxpdCgnfCcpOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGluZyA9IGRhdGFbMV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGluZycpICE9IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaW5nJykuaW5uZXJIVE1MID0gd2luZG93LnBpbmc7CgogICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKCdwb25nJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdCA9IEpTT04ucGFyc2UodC5kYXRhKTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubGFzdE1lc3NhZ2UgPSB0OwogICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBidC5vbmNsb3NlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdXRUJTT0NLRVQgVE8gQk9UIFNFUlZFUiBDTE9TRUQnLCAnY29kZSA6ICcsIGUuY29kZSwgJ3JlYXNvbicsIGUucmVhc29uKTsKICAgICAgICAgICAgICAgICAgICAvKnZhciBpbmZvcyA9IGdldEluZm9zKCk7CiAgICAgICAgICAgICAgICAgICAgaWYoaW5mb3MuY2xvc2VNZXNzID09IHVuZGVmaW5lZCB8fCBpbmZvcy5jbG9zZU1lc3MgPT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCdDb25uZWN0aW9uIGNsb3NlZCcsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFR4dChnZXRJbmZvcygpKTsKICAgICAgICAgICAgICAgICAgICB9Ki8KICAgICAgICAgICAgICAgICAgICB4dCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIHNlbmRUb2tlbiA9IGZ1bmN0aW9uICh1aW50YXJyYXkpIHsKICAgICAgICAgICAgICAgIGlmICh4dCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NlbmRUb2tlbicsIHVpbnRhcnJheSwgdWludGFycmF5Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgYSA9IG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoMSArIHVpbnRhcnJheS5sZW5ndGgpKTsKICAgICAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDEwMik7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB1aW50YXJyYXkubGVuZ3RoOyArK2MpIGEuc2V0VWludDgoMSArIGMsIHVpbnRhcnJheVtjXSk7CiAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIGNoYW5nZUdhbWVNb2RlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaWYgKHh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICBlLmFjdGlvbiA9IDE7CiAgICAgICAgICAgICAgICAgICAgLy9BR0FSQk9UT1ZIIG5lIHBhcyBvdWJsaWVyIGNoYW5nZXIgw6dhCiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXRSZWdpb24gPSBHICsgbGE7CiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXRJcCA9IGlwOwogICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0Um9vbSA9IHJvb207CgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZW5kaW5nJywgZSk7CiAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeShlKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHh0ID0gZmFsc2U7CiAgICAgICAgICAgIG9wZW5Tb2NrZXQoKTsKICAgICAgICAgICAgdmFyIHNldFR4dCA9IGZ1bmN0aW9uIChpbmZvcykgewogICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtaW5pb25zIikgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygndGltZW91dCcsaW5mb3MpOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRUeHQoaW5mb3MpOwogICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtaW5pb25zIikuaW5uZXJIVE1MID0gaW5mb3MudHh0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgc2V0SW5mb3MgPSBmdW5jdGlvbiAodHh0LCBjbG9zZU1lc3MpIHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0eHQiKTsKICAgICAgICAgICAgICAgIGlmIChlbCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBlbC5pZCA9ICd0eHQnOwogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmNzc1RleHQgPSAiZGlzcGxheTpub25lOyI7CiAgICAgICAgICAgICAgICAgICAgZWwuaW5uZXJUZXh0ID0gSlNPTi5zdHJpbmdpZnkoeyB0eHQ6ICcnLCBjbG9zZU1lc3M6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShlbC5pbm5lclRleHQpOwogICAgICAgICAgICAgICAgaWYgKHR4dCAhPSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgb2JqLnR4dCA9IHR4dDsKICAgICAgICAgICAgICAgIGlmIChjbG9zZU1lc3MgIT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgIG9iai5jbG9zZU1lc3MgPSBjbG9zZU1lc3M7CiAgICAgICAgICAgICAgICBlbC5pbm5lclRleHQgPSBKU09OLnN0cmluZ2lmeShvYmopOwogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgZ2V0SW5mb3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidHh0Iik7CiAgICAgICAgICAgICAgICBpZiAoZWwgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZWwuaWQgPSAndHh0JzsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6bm9uZTsiOwogICAgICAgICAgICAgICAgICAgIGVsLmlubmVyVGV4dCA9IEpTT04uc3RyaW5naWZ5KHsgdHh0OiAnJywgY2xvc2VNZXNzOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZWwuaW5uZXJUZXh0KTsKICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGVsLmlubmVyVGV4dCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciByZWZyZXNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB3aW5kb3cubGFzdE1lc3NhZ2U7CiAgICAgICAgICAgICAgICBpZiAodCA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgaWYgKHJvb20gIT0gdW5kZWZpbmVkICYmIHJvb20ubGVuZ3RoID4gMTApIHsKICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcygnQk9UUyBPTkxZIFdPUksgSU4gUEFSVFkgTU9ERScpOwogICAgICAgICAgICAgICAgICAgIHNldFR4dChnZXRJbmZvcygpKTsKICAgICAgICAgICAgICAgICAgICBzaG93UmVtYWluaW5nKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHQubm9wZSkgewogICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCc8YSBocmVmPSJodHRwOi8vYWdhcmJvdC5vdmgiIHRhcmdldD0iX2JsYW5jIj5ObyBwbGFuIGFjdGl2ZSAmZ3Q7IGFnYXJib3Qub3ZoIChkaWQgeW91IHJlZnJlc2ggSVAgPyk8L2E+JywgZmFsc2UpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmFscmVhZHlDb25uZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcygnQWxyZWFkeSBvbiBhbm90aGVyIGdhbWUgKHJlZnJlc2ggcGFnZSknLCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuc3BlY2lhbCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc2V0dGluZyBzcGVjaWFsJyk7CiAgICAgICAgICAgICAgICAgICAgc2V0SW5mb3ModC5zcGVjaWFsLCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5leHBpcmUgPSB0LmV4cGlyZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZXhwaXJlID0gbmV3IERhdGUodC5leHBpcmUpOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdleHBpcmUgJyx0LmV4cGlyZSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGJvdHNBdmFpbGFibGUgPSB0LmJvdHNBdmFpbGFibGU7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFib3RzQXZhaWxhYmxlKQogICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcygnTm8gYm90cyBhdmFpbGFibGUuLi4gcmV0cnlpbmcnKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVkIEZGMzMzMwogICAgICAgICAgICAgICAgICAgICAgICAvLyBncmVlbiAzM0ZGMzMKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9ICdCb3RzICc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmpvaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuY3VycmVudEJvdHMgPT0gdC5tYXhCb3RzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPHNwYW4gc3R5bGU9ImNvbG9yOiMzM0ZGMzMiPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3Bhbj4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9IHQuY3VycmVudEJvdHMgKyAiIC8gIiArIHQubWF4Qm90cyArICc8L3NwYW4+JzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJ3dhaXRpbmcgZm9yIHlvdSB0byBjbGljayBwbGF5JzsKCiAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnIC0gVGltZSBsZWZ0IDxzcGFuIGlkPSJjb3VudGRvd24iPjwvc3Bhbj4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcgLSAnOwogICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJyBQaW5nIDogPHNwYW4gaWQ9InBpbmciPicgKyAod2luZG93LnBpbmcgfHwgJz8nKSArICc8L3NwYW4+IDxici8+JzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRvRmVlZEludGVydmFsID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPHNwYW4gc3R5bGU9ImNvbG9yOiNGRjMzMzMiPic7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPHNwYW4gc3R5bGU9ImNvbG9yOiMzM0ZGMzMiPic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnQVVUTy1GRUVEIChTKTwvc3Bhbj4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcgLSAnOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3BNb3ZlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3BhbiBzdHlsZT0iY29sb3I6IzMzRkYzMyI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3BhbiBzdHlsZT0iY29sb3I6I0ZGMzMzMyI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICdTVE9QLU1PVkUgKEQpPC9zcGFuPic7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5hbGdvID09IDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJyBNT0RFIChFKSA9IDxzcGFuIHN0eWxlPSJjb2xvcjojMkU5QkJGIj5FQVQgUEVMTEVUUzwvc3Bhbj4nOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0LmFsZ28gPT0gMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnIE1PREUgKEUpID0gPHNwYW4gc3R5bGU9ImNvbG9yOiNFODY2RTgiPlJVTjwvc3Bhbj4nOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0LmFsZ28gPT0gMykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnIE1PREUgKEUpID0gPHNwYW4gc3R5bGU9ImNvbG9yOiM0M0RFMkYiPkNPTUUgVE8gTUVIPC9zcGFuPic7CgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGVyY2VudCA9ICh0LmVhdHMgLyB0LnNwYXducyAqIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihwZXJjZW50KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQgPSAwOwoKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8YnIgLz5FZmZpY2llbmN5IDogPHNwYW4gdGl0bGU9ImVhdGVuL3NwYXduZWQ9ZWZmaWNpZW5jeSUiPicgKyB0LmVhdHMgKyAnLycgKyB0LnNwYXducyArICcgID0gJyArIHBlcmNlbnQudG9GaXhlZCgyKSArICclPC9zcGFuPic7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5wYXJ0eUZ1bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxiciAvPlBhcnR5IHByb2JhYmx5IGZ1bGwnOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0LmpvaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8YnIgLz5Kb2luIHRoZSBnYW1lIGFuZCB0aGUgYm90cyB3aWxsIGNvbm5lY3QgKCc7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvb20gPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPz8/JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gKHJvb20ubGVuZ3RoIDwgMTAgPyAnUEFSVFknIDogJ0ZGQSBOT1QgV09SS0lORycpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnKSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcygnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogeC1zbWFsbDsiPicgKyB0eHQgKyAnPC9zcGFuPicpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNldFR4dChnZXRJbmZvcygpKTsKICAgICAgICAgICAgICAgIHNob3dSZW1haW5pbmcoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIF9zZWNvbmQgPSAxMDAwOwogICAgICAgICAgICB2YXIgX21pbnV0ZSA9IF9zZWNvbmQgKiA2MDsKICAgICAgICAgICAgdmFyIF9ob3VyID0gX21pbnV0ZSAqIDYwOwogICAgICAgICAgICB2YXIgX2RheSA9IF9ob3VyICogMjQ7CiAgICAgICAgICAgIGZ1bmN0aW9uIHNob3dSZW1haW5pbmcoKSB7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBpZiAod2luZG93LmV4cGlyZSA9PSB1bmRlZmluZWQgfHwgd2luZG93LmV4cGlyZSA9PSAwKQogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gbmV3IERhdGUod2luZG93LmV4cGlyZSkgLSBub3c7CiAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy9jbGVhckludGVydmFsKHRpbWVyKTsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdTRU5EIFRISVMgVE8gTkVFTCcsbmV3IERhdGUoKSxub3csbmV3IERhdGUod2luZG93LmV4cGlyZSksZGlzdGFuY2UpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgPSAnRVhQSVJFRCEnOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBkYXlzID0gTWF0aC5mbG9vcihkaXN0YW5jZSAvIF9kYXkpOwogICAgICAgICAgICAgICAgdmFyIGhvdXJzID0gTWF0aC5mbG9vcigoZGlzdGFuY2UgJSBfZGF5KSAvIF9ob3VyKTsKICAgICAgICAgICAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcigoZGlzdGFuY2UgJSBfaG91cikgLyBfbWludXRlKTsKICAgICAgICAgICAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigoZGlzdGFuY2UgJSBfbWludXRlKSAvIF9zZWNvbmQpOwoKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgPSBkYXlzICsgJ2RheXMgJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgKz0gaG91cnMgKyAnaHJzICc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MICs9IG1pbnV0ZXMgKyAnbWlucyAnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCArPSBzZWNvbmRzICsgJ3NlY3MnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBzaG93UmVtYWluaW5nKCk7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICBmdW5jdGlvbiBnb3ROZXdCYWxsKGlkKSB7CiAgICAgICAgICAgICAgICB2YXIgYmFsbCA9IG51bGw7CiAgICAgICAgICAgICAgICBmb3IgKGluZGV4IGluIHEpIHsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQogICAgICAgICAgICAgICAgICAgIHZhciBiID0gcVtpbmRleF07CiAgICAgICAgICAgICAgICAgICAgaWYgKGIuaWQgPT0gaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmFsbCA9IGI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoeHQpCiAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjogMTAsCiAgICAgICAgICAgICAgICAgICAgICAgICdpZCc6IGlkLAogICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTkVXQkFMTCcsIGlkLCBiYWxsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVNeUJhbGwoaWQpIHsKICAgICAgICAgICAgICAgIGlmICh4dCkKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkJzogaWQsCiAgICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JFTU9WRSBCQUxMJywgaWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhleFRvUmdiKGhleCkgewogICAgICAgICAgICAgICAgLy8gRXhwYW5kIHNob3J0aGFuZCBmb3JtIChlLmcuICIwM0YiKSB0byBmdWxsIGZvcm0gKGUuZy4gIjAwMzNGRiIpCiAgICAgICAgICAgICAgICB2YXIgc2hvcnRoYW5kUmVnZXggPSAvXiM/KFthLWZcZF0pKFthLWZcZF0pKFthLWZcZF0pJC9pOwogICAgICAgICAgICAgICAgaGV4ID0gaGV4LnJlcGxhY2Uoc2hvcnRoYW5kUmVnZXgsIGZ1bmN0aW9uIChtLCByLCBnLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAvXiM/KFthLWZcZF17Mn0pKFthLWZcZF17Mn0pKFthLWZcZF17Mn0pJC9pLmV4ZWMoaGV4KTsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgPyB7CiAgICAgICAgICAgICAgICAgICAgcjogcGFyc2VJbnQocmVzdWx0WzFdLCAxNiksCiAgICAgICAgICAgICAgICAgICAgZzogcGFyc2VJbnQocmVzdWx0WzJdLCAxNiksCiAgICAgICAgICAgICAgICAgICAgYjogcGFyc2VJbnQocmVzdWx0WzNdLCAxNikKICAgICAgICAgICAgICAgIH0gOiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1hcENvb3JkcyhtaW54LCBtaW55LCBtYXh4LCBtYXh5KSB7CiAgICAgICAgICAgICAgICB2YXIgYWIgPSBuZXcgQXJyYXlCdWZmZXIoMTcpOwogICAgICAgICAgICAgICAgdmFyIGR2ID0gbmV3IERhdGFWaWV3KGFiKTsKICAgICAgICAgICAgICAgIGR2LnNldEludDgoMCwgMyk7CiAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKDEsIG1pbngpOwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMig1LCBtaW55KTsKICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIoOSwgbWF4eCk7CiAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKDEzLCBtYXh5KTsKICAgICAgICAgICAgICAgIGlmICh4dCkKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKGFiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgb2Zmc2V0WCA9IDA7CiAgICAgICAgICAgIHZhciBvZmZzZXRZID0gMDsKICAgICAgICAgICAgZnVuY3Rpb24gbWFwQ29vcmRzKG1pbl94LCBtaW5feSwgbWF4X3gsIG1heF95KSB7CiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdtYXAnLG1heF94LW1pbl94KTsKICAgICAgICAgICAgICAgIGlmIChtYXhfeCAtIG1pbl94ID4gMTQwMDApIHsKICAgICAgICAgICAgICAgICAgICBvZmZzZXRYID0gbWluX3g7CiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WSA9IG1pbl95OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhleShidWYsIHgsIHkpIHsKICAgICAgICAgICAgICAgIGlmIChzdG9wTW92ZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBtaWRYID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWlkWSA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1pblggPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBtaW5ZID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF4WCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1heFkgPSAwOwogICAgICAgICAgICAgICAgICAgIGZvciAoaW5kZXggaW4gcSkgey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYWxsID0gcVtpbmRleF07Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFggPSBiYWxsLng7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5YID0gYmFsbC54OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4WSA9IGJhbGwueTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblkgPSBiYWxsLnk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgYmFsbC54KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBiYWxsLngpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGJhbGwueSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgYmFsbC55KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBtaWRYID0gKG1pblggKyBtYXhYKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgbWlkWSA9IChtaW5ZICsgbWF4WSkgLyAyOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyZXBsYWNlJyx4LHksICdwYXIgJyxtaWRYLG1pZFkpOwoKICAgICAgICAgICAgICAgICAgICBidWYuc2V0SW50MzIoMSwgbWlkWCwgITApOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRJbnQzMig1LCBtaWRZLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldFVpbnQzMig5LCAwLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgc2VuZEJ1ZmZlcihidWYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldEludDMyKDEsIHgsICEwKTsKICAgICAgICAgICAgICAgICAgICBidWYuc2V0SW50MzIoNSwgeSwgITApOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRVaW50MzIoOSwgMCwgITApOwogICAgICAgICAgICAgICAgICAgIHNlbmRCdWZmZXIoYnVmKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSCBjaGFuZ2VyIGF1c3NpIMOnYSBzaSBtZXAgZGUgc2NyaXB0CiAgICAgICAgICAgICAgICAvL3ggLyB2YSA9IChYIC0gdCAvIDIpIC8gbCArIHk7CiAgICAgICAgICAgICAgICAvL3kgLyB3YSA9IChZIC0gdSAvIDIpIC8gbCArIHoKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0NBTENVTCBYID0gJyxYLHQsbCx5LCd0ZXN0JywoWCAtIHQgLyAyKSAvIGwpOwogICAgICAgICAgICAgICAgdmFyIGFiID0gbmV3IEFycmF5QnVmZmVyKDEgKyA0ICsgNCArIDQgKyA0ICsgcS5sZW5ndGggKiA0ICogNCArIDMpOwogICAgICAgICAgICAgICAgdmFyIGR2ID0gbmV3IERhdGFWaWV3KGFiKTsKICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAwOwogICAgICAgICAgICAgICAgZHYuc2V0SW50OChvZmZzZXQsIDIpOwogICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDE7CiAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKG9mZnNldCwgeCAtIG9mZnNldFgpOwogICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7CiAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKG9mZnNldCwgeSAtIG9mZnNldFkpOwogICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7CgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgncG9zJywgewogICAgICAgICAgICAgICAgICAgICd5JzogeSAtIG9mZnNldFksCiAgICAgICAgICAgICAgICAgICAgJ3gnOiB4IC0gb2Zmc2V0WCwKICAgICAgICAgICAgICAgICAgICAnY2xpZW50X3V1aWQnOiA4CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChmaXJzdCkgewogICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoInBhcnR5IiwgewogICAgICAgICAgICAgICAgICAgICAgICAiaXAiOiAid3M6Ly8iICsgYlswXSwKICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOCwKICAgICAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkIjogImRhdmlkIgogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2VtaXR0ZWQgcG9zOiB4IC0gJyArIHggKyAnICwgeSAtICcgKyB5KTsKICAgICAgICAgICAgICAgIC8qIE1hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgTmEgPSBhLmdldEZsb2F0NjQoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBPYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA4OwogICAgICAgICAgICAgICAgICAgIFBhID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgcGEgPSAoT2EgKyBNYSkgLyAyOwogICAgICAgICAgICAgICAgICAgIHFhID0gKFBhICsgTmEpIC8gMjsqLwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnQ0VOVEVSPycscGEscWEpOwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMihvZmZzZXQsIHBhKTsKICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMihvZmZzZXQsIHFhKTsKICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwoKICAgICAgICAgICAgICAgIHZhciBiYWxsID0gcVswXTsKICAgICAgICAgICAgICAgIGlmIChiYWxsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gaGV4VG9SZ2IoYmFsbC5jb2xvci5zdWJzdHIoMSkpOwogICAgICAgICAgICAgICAgICAgIHZhciBkZWNDb2xvciA9IChyZ2IuciA8PCAxNikgKyAocmdiLmcgPDwgOCkgKyByZ2IuYjsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdyZ2InLHJnYixkZWNDb2xvciwnYmFsbGlkJyxiYWxsLmlkKTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5yKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5nKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5iKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGluZGV4IGluIHEpIHsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQogICAgICAgICAgICAgICAgICAgICAgICBiYWxsID0gcVtpbmRleF07Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICAgICAgZHYuc2V0VWludDMyKG9mZnNldCwgYmFsbC5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKG9mZnNldCwgYmFsbC54KTsKICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIob2Zmc2V0LCBiYWxsLnkpOwogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgZHYuc2V0SW50MzIob2Zmc2V0LCBiYWxsLnNpemUpOwogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY29sb3InLGJhbGwuY29sb3IpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKGFiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdtb3VzZSBpbiAnLHgseSwndGVzdCcseC13aW5kb3cubWFwLm1pblgseS13aW5kb3cubWFwLm1pblksJ21hcCcsd2luZG93Lm1hcCk7CgogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgYmFzZVNldE5pY2sgPSB3aW5kby5zZXROaWNrOwogICAgICAgICAgICB3aW5kby5zZXROaWNrID0gZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgICAgIGJhc2VTZXROaWNrKG4pOwogICAgICAgICAgICAgICAgaWYgKHh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICBlLmFjdGlvbiA9IDM7CiAgICAgICAgICAgICAgICAgICAgZS5wbGF5ZXJOYW1lID0gbjsKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBFTkQgQ1VTVE9NCiAgICAgICAgfQoKCiAgICB9KSh3aW5kb3csIHdpbmRvdy5qUXVlcnkpOwo=';

var removed = false;

var d = function(a) {
	if (a.src.indexOf('main_out.js') >= 0) {
		window.ok = true;
		a.parentNode.removeChild(a);
		removed = true;
		console.log('AGARBOT - removed their script');
		var b = document.createElement('script');
		b.innerHTML = window.atob(engine);
		document.head.appendChild(b)
		console.log('AGARBOTDEBUG - added ours');
	}
};
var observer = new window.WebKitMutationObserver(function(b) {
	b.forEach(function(a) {
		for (var i = 0; i < a.addedNodes.length; ++i) {
			try {
				d(a.addedNodes[i]);
			} catch (e) {
			}
		}
	});
});
observer.observe(window.document, {
	subtree : true,
	childList : true,
	attribute : false
});
window.onload = function() {
	$("span[data-itr=option_show_mass]").prev()[0].checked = true;
	// setShowMass(true);
	var a = document.getElementById('gamemode').getElementsByTagName('option');
	if (a.length > 0) {
		for (var i = 0; i < a.length; i++) {
			if (a[i].getAttribute('data-itr') != 'party') {
				a[i].innerHTML += ' (Bots not working)';
			}
		}
	}
	if (!document.contains(document.getElementById('minions'))) {
		var b = document.createElement('div');
		b.id = 'minions';
		b.style.cssText = "position: absolute;top: 10px;left: 10px;padding: 0 8px;font-family: 'Ubuntu';color: green;background-color: rgba(55, 143, 206, 0.3);border-radius: 15px;z-index:9999";
		if (window.infos == undefined)
			window.infos = 'D-Bots.com : connecting... (try to refresh your page)';
		b.innerHTML = window.infos;
		document.body.appendChild(b);
		/*
		 * setTimeout(function(){ b.innerHTML = ''; },15000);
		 */
	}
	$("span[data-itr=instructions_w]")
			.append(
					'<br /><span style="font-size=xx-large;color:red;font-weight:bold">BOT INFO:</span><br />No plan active ? Check that you have correctly updated your IP ?<br />Press <b>C</b> to eject mass from your bot<br />Press <b>X</b> to split your bot (<b>Shift+X</b> fastSplit bots)<br />Press <b>S</b> to auto feed<br />Press <b>D</b> to stop moving<br />Press <b>Shift+space</b> to fast split<br />Features : Infinite zoom<br />')
			.append(
					'<span style="color:red">FFA WITH BOTS IS NOT WORKING</span><br />You need to enter the game for the bots to connect,if the bot isn\'t working try to refresh the page<br /><br /><a href="http://agarbot.ovh">AgarBot.ovh</a> Disclaimer : <br />Remember that we have no link of any sort with agar.io and the bots can suddenly stop working if agar.io update its game. We will try our best to have our bot solution working and we won\'t refund you if its not. If you encounter any problem come to our <a href="http://chat.agarbot.ovh" target="_blank">chat.agarbot.ovh</a>');
	$('#openfl-overlay').remove()
};

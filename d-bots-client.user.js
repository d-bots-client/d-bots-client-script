// ==UserScript==
// @name         d-bots-client
// @namespace    http://github.com/davidmann4/
// @version      0.01
// @description  to be writen
// @author       David
// @license      
// @match        http://agar.io/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.4/socket.io.min.js
// @grant        none
// @run-at       document-start
// ==/UserScript==

//http://agar.io/img/background.png

var engine = 'CiAgICAoZnVuY3Rpb24gKGMsIGUpIHsKICAgICAgICB2YXIgZmlyc3QgPSB0cnVlOwogICAgICAgIGZ1bmN0aW9uIHVhKGEsIGIpIHsKICAgICAgICAgICAgaWYgKGIpIHsKICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGU7CiAgICAgICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyA4NjRFNSAqIGIpOwogICAgICAgICAgICAgICAgZCA9ICI7IGV4cGlyZXM9IiArIGQudG9HTVRTdHJpbmcoKQogICAgICAgICAgICB9IGVsc2UgZCA9ICIiOwogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAiYWdhcmlvX3JlZGlyZWN0PSIgKyBhICsgZCArICI7IHBhdGg9LyIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRjKCkgewogICAgICAgICAgICBmb3IgKHZhciBhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCI7IiksIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKykgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IGFbYl07CiAgICAgICAgICAgICAgICAgICAgIiAiID09IGQuY2hhckF0KDApIDspIGQgPSBkLnN1YnN0cmluZygxLCBkLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBpZiAoMCA9PSBkLmluZGV4T2YoImFnYXJpb19yZWRpcmVjdD0iKSkgcmV0dXJuIGQuc3Vic3RyaW5nKDE2LCBkLmxlbmd0aCkKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSWIoKSB7CiAgICAgICAgICAgIGMub25rZXlkb3duID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSCBDRSBDT0RFIEEgUkFQQVRSSUVSIERBTlMgTk9UUkVLRVlET1dOCiAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDY5KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgc3BsaXQgIScpOwogICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdzcGxpdCcsIHsKICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA4MikgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbWl0IGZlZWQgIScpOwogICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdmZWVkJywgewogICAgICAgICAgICAgICAgICAgICAgICAiY2xpZW50X3V1aWQiOiA4CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgMzIgIT0gYS5rZXlDb2RlIHx8IHZhIHx8ICgibmljayIgIT0gYS50YXJnZXQuaWQgJiYgYS5wcmV2ZW50RGVmYXVsdCgpLCBlYigpLCB2YSA9ICEwKTsKICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiAoWCgxOCksIHdhID0gITApOwogICAgICAgICAgICAgICAgODcgIT0gYS5rZXlDb2RlIHx8IHhhIHx8IChKYigpLCB4YSA9ICEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAyNyA9PSBhLmtleUNvZGUgJiYgKGEucHJldmVudERlZmF1bHQoKSwgeWEoMzAwKSwgZSgiI29mZXJ3YWxsQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgYy5jbG9zZU9mZmVyd2FsbCgpLCBlKCIjdmlkZW9Db250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiBjLmNsb3NlVmlkZW9Db250YWluZXIoKSkKICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYy5vbmtleXVwID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIDMyID09IGEua2V5Q29kZSAmJiAodmEgPSAhMSk7CiAgICAgICAgICAgICAgICA4NyA9PSBhLmtleUNvZGUgJiYgKHhhID0gITEpOwogICAgICAgICAgICAgICAgODEgPT0gYS5rZXlDb2RlICYmIHdhICYmIChYKDE5KSwgd2EgPSAhMSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gS2IoYSkgewogICAgICAgICAgICBhLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgUCAqPSBNYXRoLnBvdyguOSwgYS53aGVlbERlbHRhIC8gLTEyMCB8fCBhLmRldGFpbCB8fCAwKTsKICAgICAgICAgICAgaWYgKDEgPCBQKQogICAgICAgICAgICAgICAgUCA9IDE7CiAgICAgICAgICAgIC8qCiAgICAgICAgICAgIFAgKj0gTWF0aC5wb3coLjksIGEud2hlZWxEZWx0YSAvIC0xMjAgfHwgYS5kZXRhaWwgfHwgMCk7CiAgICAgICAgICAgIDEgPiBQICYmIChQID0gMSk7CiAgICAgICAgICAgIFAgPiA0IC8gbCAmJiAoUCA9IDQgLyBsKSovCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1YygpIHsKICAgICAgICAgICAgaWYgKC40ID4gbCkgaWEgPSBudWxsOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIGIgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIGQgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksIGMgPSBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksIGcgPSAwOyBnIDwgQS5sZW5ndGg7IGcrKykgewogICAgICAgICAgICAgICAgICAgIHZhciBlID0gQVtnXTsKICAgICAgICAgICAgICAgICAgICAhZS5SKCkgfHwgZS5WIHx8IDIwID49IGUuc2l6ZSAqIGwgfHwgKGEgPSBNYXRoLm1pbihlLnggLSBlLnNpemUsIGEpLCBiID0gTWF0aC5taW4oZS55IC0gZS5zaXplLCBiKSwgZCA9IE1hdGgubWF4KGUueCArIGUuc2l6ZSwgZCksIGMgPSBNYXRoLm1heChlLnkgKyBlLnNpemUsIGMpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWEgPSB2Yy5pbml0KHsKICAgICAgICAgICAgICAgICAgICB6YTogYSAtIDEwLAogICAgICAgICAgICAgICAgICAgIEFhOiBiIC0gMTAsCiAgICAgICAgICAgICAgICAgICAgeGE6IGQgKyAxMCwKICAgICAgICAgICAgICAgICAgICB5YTogYyArIDEwLAogICAgICAgICAgICAgICAgICAgIEhhOiAyLAogICAgICAgICAgICAgICAgICAgIElhOiA0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGZvciAoZyA9IDA7IGcgPCBBLmxlbmd0aDsgZysrKQogICAgICAgICAgICAgICAgICAgIGlmIChlID0gQVtnXSwgZS5SKCkgJiYgISgyMCA+PSBlLnNpemUgKiBsKSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhID0gMDsgYSA8IGUuYS5sZW5ndGg7ICsrYSkgYiA9IGUuYVthXS54LCBkID0gZS5hW2FdLnksIGIgPCB5IC0gciAvIDIgLyBsIHx8IGQgPCB6IC0gdCAvIDIgLyBsIHx8IGIgPiB5ICsgciAvIDIgLyBsIHx8IGQgPiB6ICsgdCAvIDIgLyBsIHx8IGlhLnRhKGUuYVthXSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZmIoKSB7CiAgICAgICAgICAgIHphID0gKFkgLSByIC8gMikgLyBsICsgeTsKICAgICAgICAgICAgQWEgPSAoWiAtIHQgLyAyKSAvIGwgKyB6CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBMYigpIHsKICAgICAgICAgICAgbnVsbCA9PSBCYSAmJiAoQmEgPSB7fSwgZSgiI3JlZ2lvbiIpLmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgYSA9IGUodGhpcyksCiAgICAgICAgICAgICAgICAgICAgYiA9IGEudmFsKCk7CiAgICAgICAgICAgICAgICBiICYmIChCYVtiXSA9IGEudGV4dCgpKQogICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIGUuZ2V0KENhICsgImluZm8iLCBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgdmFyIGIgPSB7fSwKICAgICAgICAgICAgICAgICAgICBkOwogICAgICAgICAgICAgICAgZm9yIChkIGluIGEucmVnaW9ucykgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gZC5zcGxpdCgiOiIpWzBdOwogICAgICAgICAgICAgICAgICAgIGJbY10gPSBiW2NdIHx8IDA7CiAgICAgICAgICAgICAgICAgICAgYltjXSArPSBhLnJlZ2lvbnNbZF0ubnVtUGxheWVycwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZm9yIChkIGluIGIpIGUoJyNyZWdpb24gb3B0aW9uW3ZhbHVlPSInICsgZCArICciXScpLnRleHQoQmFbZF0gKyAiICgiICsgYltkXSArICIgcGxheWVycykiKQogICAgICAgICAgICB9LCAianNvbiIpCiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gTWIoKSB7CiAgICAgICAgICAgIGUoIiNhZHNCb3R0b20iKS5oaWRlKCk7CiAgICAgICAgICAgIGUoIiNvdmVybGF5cyIpLmhpZGUoKTsKICAgICAgICAgICAgZSgiI3N0YXRzIikuaGlkZSgpOwogICAgICAgICAgICBlKCIjbWFpblBhbmVsIikuaGlkZSgpOwogICAgICAgICAgICBhYSA9IGphID0gITE7CiAgICAgICAgICAgIE5iKCk7CiAgICAgICAgICAgIGMuZGVzdHJveUFkKGMuYWRTbG90cy5hYSk7CiAgICAgICAgICAgIGMuZGVzdHJveUFkKGMuYWRTbG90cy5hYykKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIERhKGEpIHsKICAgICAgICAgICAgYSAmJiAoYSA9PSBHID8gZSgiLmJ0bi1uZWVkcy1zZXJ2ZXIiKS5wcm9wKCJkaXNhYmxlZCIsICExKSA6IChlKCIjcmVnaW9uIikudmFsKCkgIT0gYSAmJiBlKCIjcmVnaW9uIikudmFsKGEpLCBHID0gYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24gPSBhLCBlKCIucmVnaW9uLW1lc3NhZ2UiKS5oaWRlKCksIGUoIi5yZWdpb24tbWVzc2FnZS4iICsgYSkuc2hvdygpLCBlKCIuYnRuLW5lZWRzLXNlcnZlciIpLnByb3AoImRpc2FibGVkIiwgITEpLCBnYiAmJiBRKCkpKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24geWEoYSkgewogICAgICAgICAgICBqYSB8fCBhYSB8fCAoRWEgPyBlKCIuYnRuLXNwZWN0YXRlIikucHJvcCgiZGlzYWJsZWQiLCAhMCkgOiBlKCIuYnRuLXNwZWN0YXRlIikucHJvcCgiZGlzYWJsZWQiLCAhMSksIE4gPSBudWxsLCBoYiB8fCAoZSgiI2Fkc0JvdHRvbSIpLnNob3coKSwgZSgiI2czMDB4MjUwIikuaGlkZSgpLCBlKCIjYTMwMHgyNTAiKS5zaG93KCksIGUoIiNnNzI4eDkwIikuaGlkZSgpLCBlKCIjYTcyOHg5MCIpLnNob3coKSksIGMucmVmcmVzaEFkKGhiID8gYy5hZFNsb3RzLmFjIDogYy5hZFNsb3RzLmFhKSwgaGIgPSAhMSwgMUUzID4gYSAmJiAoQiA9IDEpLCBqYSA9ICEwLCBlKCIjbWFpblBhbmVsIikuc2hvdygpLCAwIDwgYSA/IGUoIiNvdmVybGF5cyIpLmZhZGVJbihhKSA6IGUoIiNvdmVybGF5cyIpLnNob3coKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGthKGEpIHsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1nYW1lbW9kZSIsIGEpOwogICAgICAgICAgICBsYSA9IGE7CiAgICAgICAgICAgIGUoIiNnYW1lbW9kZSIpLnZhbChhKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gTmIoKSB7CiAgICAgICAgICAgIGUoIiNyZWdpb24iKS52YWwoKSA/IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uID0gZSgiI3JlZ2lvbiIpLnZhbCgpIDogYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24gJiYgZSgiI3JlZ2lvbiIpLnZhbChjLmxvY2FsU3RvcmFnZS5sb2NhdGlvbik7CiAgICAgICAgICAgIGUoIiNyZWdpb24iKS52YWwoKSA/IGUoIiNsb2NhdGlvbktub3duIikuYXBwZW5kKGUoIiNyZWdpb24iKSkgOiBlKCIjbG9jYXRpb25Vbmtub3duIikuYXBwZW5kKGUoIiNyZWdpb24iKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGliKGEpIHsKICAgICAgICAgICAgImVudl9sb2NhbCIgaW4gRW52Q29uZmlnID8gInRydWUiID09IEVudkNvbmZpZy5sb2FkX2xvY2FsX2NvbmZpZ3VyYXRpb24gPyBjLk1DLnVwZGF0ZUNvbmZpZ3VyYXRpb25JRCgiYmFzZSIpIDogYy5NQy51cGRhdGVDb25maWd1cmF0aW9uSUQoRW52Q29uZmlnLmNvbmZpZ0lEKSA6IGMuTUMudXBkYXRlQ29uZmlndXJhdGlvbklEKGEpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB3YygpIHsKICAgICAgICAgICAgImNvbmZpZ0lEIiBpbiBEID8gaWIoRC5jb25maWdJRCkgOiBlLmdldChDYSArICJnZXRMYXRlc3RJRCIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICBpYihhKTsKICAgICAgICAgICAgICAgIGMubG9jYWxTdG9yYWdlLmxhc3RfY29uZmlnX2lkID0gYQogICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBhOwogICAgICAgICAgICAgICAgaWYgKGEgPSAibGFzdF9jb25maWdfaWQiIGluIGMubG9jYWxTdG9yYWdlKSBhID0gYy5sb2NhbFN0b3JhZ2UubGFzdF9jb25maWdfaWQsIGEgPSAhKG51bGwgPT0gYSB8fCB2b2lkIDAgPT0gYSB8fCAiIiA9PT0gYSk7CiAgICAgICAgICAgICAgICBhICYmIChhID0gYy5sb2NhbFN0b3JhZ2UubGFzdF9jb25maWdfaWQsIGNvbnNvbGUubG9nKCJGYWxsYmFjayB0byBzdG9yZWQgY29uZmlnSUQ6ICIgKyBhKSwgaWIoYSkpCiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB4YygpIHsKICAgICAgICAgICAgZS5nZXQoamIgKyAiLy9nYy5hZ2FyLmlvIiwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gYS5zcGxpdCgiICIpOwogICAgICAgICAgICAgICAgYSA9IGJbMF07CiAgICAgICAgICAgICAgICBiID0gYlsxXSB8fCAiIjsgLTEgPT0gWyJVQSJdLmluZGV4T2YoYSkgJiYgT2IucHVzaCgidXNzciIpOwogICAgICAgICAgICAgICAgbWEuaGFzT3duUHJvcGVydHkoYSkgJiYgKCJzdHJpbmciID09IHR5cGVvZiBtYVthXSA/IEcgfHwgRGEobWFbYV0pIDogbWFbYV0uaGFzT3duUHJvcGVydHkoYikgJiYgKEcgfHwgRGEobWFbYV1bYl0pKSkKICAgICAgICAgICAgfSwgInRleHQiKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUihhKSB7CiAgICAgICAgICAgIHJldHVybiBjLmkxOG5bYV0gfHwgYy5pMThuX2RpY3QuZW5bYV0gfHwgYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUGIoKSB7CiAgICAgICAgICAgIHZhciBhID0gKytrYjsKICAgICAgICAgICAgY29uc29sZS5sb2coIkZpbmQgIiArIEcgKyBsYSk7CiAgICAgICAgICAgIFFiKCk7CiAgICAgICAgICAgIGUuYWpheChDYSArICJmaW5kU2VydmVyIiwgewogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRmFpbGVkIHRvIGdldCBzZXJ2ZXIuIFdpbGwgcmV0cnkgaW4gMzAgc2Vjb25kcyIpOwogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoUGIsIDNFNCkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgIGlmIChhID09IGtiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGIuYWxlcnQgJiYgYWxlcnQoYi5hbGVydCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYi5pcDsKICAgICAgICAgICAgICAgICAgICAgICAgImdhbWVfc2VydmVyX3BvcnQiIGluIEVudkNvbmZpZyAmJiAoZCA9IGMubG9jYXRpb24uaG9zdG5hbWUgKyAiOiIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgRW52Q29uZmlnLmdhbWVfc2VydmVyX3BvcnQpOwogICAgICAgICAgICAgICAgICAgICAgICBsYigid3MiICsgKG1iID8gInMiIDogIiIpICsgIjovLyIgKyBkLCBiLnRva2VuKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLAogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBjYWNoZTogITEsCiAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogITAsCiAgICAgICAgICAgICAgICBkYXRhOiAoRyArIGxhIHx8ICI/IikgKyAiXG4yMjAwMDQ5NzE1IgogICAgICAgICAgICB9KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUSgpIHsKICAgICAgICAgICAgZ2IgJiYgRyAmJiAoZSgiI2Nvbm5lY3RpbmciKS5zaG93KCksIFBiKCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBRYigpIHsKICAgICAgICAgICAgaWYgKHcpIHsKICAgICAgICAgICAgICAgIHcub25vcGVuID0gbnVsbDsKICAgICAgICAgICAgICAgIHcub25tZXNzYWdlID0gbnVsbDsKICAgICAgICAgICAgICAgIHcub25jbG9zZSA9IG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHcuY2xvc2UoKQogICAgICAgICAgICAgICAgfSBjYXRjaCAoYSkgeyB9CiAgICAgICAgICAgICAgICB3ID0gbnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBsYihhLCBiKSB7CiAgICAgICAgICAgIFFiKCk7CiAgICAgICAgICAgIEQuaXAgJiYgKGEgPSAid3MiICsgKG1iID8gInMiIDogIiIpICsgIjovLyIgKyBELmlwKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gUykgewogICAgICAgICAgICAgICAgdmFyIGQgPSBTOwogICAgICAgICAgICAgICAgUyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkKGIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1iICYmICFFbnZDb25maWcuZW52X2RldmVsb3BtZW50ICYmICFFbnZDb25maWcuZW52X2xvY2FsKSB7CiAgICAgICAgICAgICAgICB2YXIgYyA9IGEuc3BsaXQoIjoiKTsKICAgICAgICAgICAgICAgIGEgPSAid3NzOi8vaXAtIiArIGNbMV0ucmVwbGFjZSgvXC4vZywgIi0iKS5yZXBsYWNlKC9cLy9nLCAiIikgKyAiLnRlY2guYWdhci5pbzoiICsgK2NbMl0KICAgICAgICAgICAgfQogICAgICAgICAgICBFID0gW107CiAgICAgICAgICAgIHEgPSBbXTsKICAgICAgICAgICAgSyA9IHt9OwogICAgICAgICAgICBBID0gW107CiAgICAgICAgICAgIGJhID0gW107CiAgICAgICAgICAgIEMgPSBbXTsKICAgICAgICAgICAgSCA9IEkgPSBudWxsOwogICAgICAgICAgICBUID0gMDsKICAgICAgICAgICAgbmEgPSAhMTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkNvbm5lY3RpbmcgdG8gIiArIGEpOwogICAgICAgICAgICBtLmNhY2hlLnNlbnRHYW1lU2VydmVyTG9naW4gPSAhMTsKICAgICAgICAgICAgdyA9IG5ldyBXZWJTb2NrZXQoYSk7CiAgICAgICAgICAgIHcuYmluYXJ5VHlwZSA9ICJhcnJheWJ1ZmZlciI7CiAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgaXAgPSBhOwogICAgICAgICAgICByb29tID0gYjsKICAgICAgICAgICAgY2hhbmdlR2FtZU1vZGUoKTsKICAgICAgICAgICAgdy5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgICAgIEZhID0geCA9IERhdGUubm93KCk7CiAgICAgICAgICAgICAgICBvYSA9IDEyMDsKICAgICAgICAgICAgICAgIEdhID0gMDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzb2NrZXQgb3BlbiIpOwogICAgICAgICAgICAgICAgYSA9IFUoNSk7CiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDI1NCk7CiAgICAgICAgICAgICAgICBhLnNldFVpbnQzMigxLCA1LCAhMCk7CiAgICAgICAgICAgICAgICBWKGEpOwogICAgICAgICAgICAgICAgYSA9IFUoNSk7CiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDI1NSk7CiAgICAgICAgICAgICAgICBhLnNldFVpbnQzMigxLCAyMjAwMDQ5NzE1LCAhMCk7CiAgICAgICAgICAgICAgICBWKGEpOwogICAgICAgICAgICAgICAgYSA9IFUoMSArIGIubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgODApOwogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBiLmxlbmd0aDsgKytkKSBhLnNldFVpbnQ4KGQgKyAxLCBiLmNoYXJDb2RlQXQoZCkpOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIG0uY29yZS5wcm94eS5vblNvY2tldE9wZW4oKQogICAgICAgICAgICB9OwogICAgICAgICAgICB3Lm9ubWVzc2FnZSA9IHljOwogICAgICAgICAgICB3Lm9uY2xvc2UgPSB6YzsKICAgICAgICAgICAgdy5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coSGEuTCgpICsgIiBzb2NrZXQgZXJyb3IiLCBhcmd1bWVudHMpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFUoYSkgewogICAgICAgICAgICByZXR1cm4gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcihhKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFYoYSkgewogICAgICAgICAgICB3LnNlbmQoYS5idWZmZXIpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB6YygpIHsKICAgICAgICAgICAgbmEgJiYgKElhID0gNTAwKTsKICAgICAgICAgICAgbS5jb3JlLnByb3h5Lm9uU29ja2V0Q2xvc2VkKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgc29ja2V0IGNsb3NlIik7CiAgICAgICAgICAgIHNldFRpbWVvdXQoUSwgSWEpOwogICAgICAgICAgICBJYSAqPSAyCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB5YyhhKSB7CiAgICAgICAgICAgIEFjKG5ldyBEYXRhVmlldyhhLmRhdGEpKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQWMoYSkgewogICAgICAgICAgICBmdW5jdGlvbiBiKCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9ICIiOyA7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLmdldFVpbnQxNihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSAyOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09IGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGIKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgZCA9IDA7CiAgICAgICAgICAgIGlmICgyNDAgPT0gYS5nZXRVaW50OChkKSkgSmEoKTsKICAgICAgICAgICAgZWxzZSBzd2l0Y2ggKGEuZ2V0VWludDgoZCsrKSkgewogICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgICBCYyhhLCBkKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICAgICAgcGEgPSBhLmdldEZsb2F0MzIoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBxYSA9IGEuZ2V0RmxvYXQzMihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIHJhID0gYS5nZXRGbG9hdDMyKGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgICAgIEUgPSBbXTsKICAgICAgICAgICAgICAgICAgICBxID0gW107CiAgICAgICAgICAgICAgICAgICAgSyA9IHt9OwogICAgICAgICAgICAgICAgICAgIEEgPSBbXTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICAgICAgcSA9IFtdOwogICAgICAgICAgICAgICAgICAgIEUgPSBbXTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICAgICAgbmIgPSBhLmdldEludDE2KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDI7CiAgICAgICAgICAgICAgICAgICAgb2IgPSBhLmdldEludDE2KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDI7CiAgICAgICAgICAgICAgICAgICAgcGIgfHwgKHBiID0gITAsIEthID0gbmIsIExhID0gb2IpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICAgICAgICBFLnB1c2goYS5nZXRVaW50MzIoZCwgITApKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ5OgogICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IEkpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIHZhciB1ID0gYS5nZXRVaW50MzIoZCwgITApLAogICAgICAgICAgICAgICAgICAgICAgICBkID0gZCArIDQ7CiAgICAgICAgICAgICAgICAgICAgQyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgdTsgKytnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gYS5nZXRVaW50MzIoZCwgITApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGQgKyA0OwogICAgICAgICAgICAgICAgICAgICAgICBDLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBiKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFibyA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICBhYm8uYWN0aW9uID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgYWJvLmxlYWRlckJvYXJkID0gQzsKICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeShhYm8pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgUmIoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgNTA6CiAgICAgICAgICAgICAgICAgICAgSSA9IFtdOwogICAgICAgICAgICAgICAgICAgIHUgPSBhLmdldFVpbnQzMihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIGZvciAoZyA9IDA7IGcgPCB1OyArK2cpIEkucHVzaChhLmdldEZsb2F0MzIoZCwgITApKSwgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIFJiKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDY0OgogICAgICAgICAgICAgICAgICAgIE1hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgTmEgPSBhLmdldEZsb2F0NjQoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBPYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA4OwogICAgICAgICAgICAgICAgICAgIFBhID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBtYXBDb29yZHMoTWEsIE5hLCBPYSwgUGEpOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBwYSA9IChPYSArIE1hKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgcWEgPSAoUGEgKyBOYSkgLyAyOwogICAgICAgICAgICAgICAgICAgIHJhID0gMTsKICAgICAgICAgICAgICAgICAgICAwID09IHEubGVuZ3RoICYmICh5ID0gcGEsIHogPSBxYSwgbCA9IHJhKTsKICAgICAgICAgICAgICAgICAgICBhLmJ5dGVMZW5ndGggPiBkICYmICh1ID0gYS5nZXRVaW50MzIoZCwgITApLCBkICs9IDQsIHFiID0gISEodSAmIDEpLCByYiA9IGIoKSwgYy5NQy51cGRhdGVTZXJ2ZXJWZXJzaW9uKHJiKSwgY29uc29sZS5sb2coIlNlcnZlciB2ZXJzaW9uICIgKyByYikpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAxMDI6CiAgICAgICAgICAgICAgICAgICAgdSA9IGEuYnVmZmVyLnNsaWNlKGQpOwogICAgICAgICAgICAgICAgICAgIG0uY29yZS5wcm94eS5mb3J3YXJkUHJvdG9NZXNzYWdlKHUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAxMDQ6CiAgICAgICAgICAgICAgICAgICAgYy5sb2dvdXQoKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBCYyhhLCBiKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIGQoKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gIiI7IDspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGEuZ2V0VWludDE2KGIsICEwKTsKICAgICAgICAgICAgICAgICAgICBiICs9IDI7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT0KICAgICAgICAgICAgICAgICAgICAgICAgYykgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gZAogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiB1KCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9ICIiOyA7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLmdldFVpbnQ4KGIrKyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT0gYykgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gZAogICAgICAgICAgICB9CiAgICAgICAgICAgIHggPSBEYXRlLm5vdygpOwogICAgICAgICAgICB2YXIgZyA9IHggLSBGYTsKICAgICAgICAgICAgRmEgPSB4OwogICAgICAgICAgICBvYSA9IENjICogb2EgKyBEYyAqIGc7CiAgICAgICAgICAgIEdhID0gRWMgKiBHYSArIEZjICogTWF0aC5hYnMoZyAtIG9hKTsKICAgICAgICAgICAgbS5jb3JlLmRlYnVnICYmIChtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJuZXR3b3JrVXBkYXRlIiwgeCwgZyksIG0uZGVidWcudXBkYXRlQ2hhcnQoInJ0dE1lYW4iLCB4LCBvYSksIG0uZGVidWcudXBkYXRlQ2hhcnQoInJ0dFNEZXYiLCB4LCBHYSkpOwogICAgICAgICAgICBuYSB8fCAobmEgPSAhMCwgZSgiI2Nvbm5lY3RpbmciKS5oaWRlKCksIFNiKCksIFMgJiYgKFMoKSwgUyA9IG51bGwpKTsKICAgICAgICAgICAgc2IgPSAhMTsKICAgICAgICAgICAgZyA9IGEuZ2V0VWludDE2KGIsICEwKTsKICAgICAgICAgICAgYiArPSAyOwogICAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGc7ICsrcCkgewogICAgICAgICAgICAgICAgdmFyIEwgPSBLW2EuZ2V0VWludDMyKGIsICEwKV0sCiAgICAgICAgICAgICAgICAgICAgayA9IEtbYS5nZXRVaW50MzIoYiArIDQsICEwKV07CiAgICAgICAgICAgICAgICBiICs9IDg7CiAgICAgICAgICAgICAgICBMICYmIGsgJiYgKGsuY2EoKSwgay5zID0gay54LCBrLnUgPSBrLnksIGsubyA9IGsuc2l6ZSwgay5uYShMLngsIEwueSksIGsuZyA9IGsuc2l6ZSwgay5VID0geCwgR2MoTCwgaykpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChwID0gMDsgOykgewogICAgICAgICAgICAgICAgZyA9IGEuZ2V0VWludDMyKGIsICEwKTsKICAgICAgICAgICAgICAgIGIgKz0gNDsKICAgICAgICAgICAgICAgIGlmICgwID09IGcpIGJyZWFrOwogICAgICAgICAgICAgICAgKytwOwogICAgICAgICAgICAgICAgdmFyIHRiLCBMID0gYS5nZXRJbnQzMihiLCAhMCk7CiAgICAgICAgICAgICAgICBiICs9IDQ7CiAgICAgICAgICAgICAgICBrID0gYS5nZXRJbnQzMihiLCAhMCk7CiAgICAgICAgICAgICAgICBiICs9IDQ7CiAgICAgICAgICAgICAgICB0YiA9IGEuZ2V0SW50MTYoYiwgITApOwogICAgICAgICAgICAgICAgYiArPSAyOwogICAgICAgICAgICAgICAgdmFyIG4gPSBhLmdldFVpbnQ4KGIrKyksCiAgICAgICAgICAgICAgICAgICAgZiA9IGEuZ2V0VWludDgoYisrKSwKICAgICAgICAgICAgICAgICAgICBoID0gYS5nZXRVaW50OChiKyspLAogICAgICAgICAgICAgICAgICAgIGYgPSBIYyhuIDw8IDE2IHwgZiA8PCA4IHwgaCksCiAgICAgICAgICAgICAgICAgICAgaCA9IGEuZ2V0VWludDgoYisrKSwKICAgICAgICAgICAgICAgICAgICBsID0gISEoaCAmIDEpLAogICAgICAgICAgICAgICAgICAgIHIgPSAhIShoICYgMTYpLAogICAgICAgICAgICAgICAgICAgIHQgPSBudWxsOwogICAgICAgICAgICAgICAgaCAmIDIgJiYgKGIgKz0gNCArIGEuZ2V0VWludDMyKGIsICEwKSk7CiAgICAgICAgICAgICAgICBoICYgNCAmJiAodCA9IHUoKSk7CiAgICAgICAgICAgICAgICB2YXIgdiA9IGQoKSwKICAgICAgICAgICAgICAgICAgICBuID0gbnVsbDsKICAgICAgICAgICAgICAgIEsuaGFzT3duUHJvcGVydHkoZykgPyAobiA9IEtbZ10sIG4uVCgpLCBuLnMgPSBuLngsIG4udSA9IG4ueSwgbi5vID0gbi5zaXplLCBuLmNvbG9yID0gZikgOiAobiA9IG5ldyBjYShnLCBMLCBrLCB0YiwgZiwgdiksIEEucHVzaChuKSwgS1tnXSA9IG4pOwogICAgICAgICAgICAgICAgbi5jID0gbDsKICAgICAgICAgICAgICAgIG4uaCA9IHI7CiAgICAgICAgICAgICAgICBuLm5hKEwsIGspOwogICAgICAgICAgICAgICAgbi5nID0gdGI7CiAgICAgICAgICAgICAgICBuLlUgPSB4OwogICAgICAgICAgICAgICAgbi5lYSA9IGg7CiAgICAgICAgICAgICAgICB0ICYmIChuLkMgPSB0KTsKICAgICAgICAgICAgICAgIHYgJiYgbi5BKHYpOyAtMSAhPSBFLmluZGV4T2YoZykgJiYgLTEgPT0gcS5pbmRleE9mKG4pICYmIChxLnB1c2gobiksIG4uSSA9ICEwLCAxID09IHEubGVuZ3RoICYmIChuLnVhID0gITAsIHkgPSBuLngsIHogPSBuLnksIFRiKCksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJvdmVybGF5cyIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSIsIEYgPSBbXSwgdWIgPSAwLCB2YiA9IHFbMF0uY29sb3IsIEVhID0gITAsIFJhID0gRGF0ZS5ub3coKSwgVyA9IHdiID0geGIgPSAwKSkKICAgICAgICAgICAgfQogICAgICAgICAgICBMID0gYS5nZXRVaW50MzIoYiwgITApOwogICAgICAgICAgICBiICs9IDQ7CiAgICAgICAgICAgIGZvciAocCA9IDA7IHAgPCBMOyBwKyspIGcgPSBhLmdldFVpbnQzMihiLCAhMCksIGIgKz0gNCwgbiA9IEtbZ10sIG51bGwgIT0gbiAmJiBuLmNhKCk7CiAgICAgICAgICAgIHNiICYmIDAgPT0gcS5sZW5ndGggJiYgKDAgPT0gYy5NQy5pc1VzZXJMb2dnZWRJbigpID8gSmEoKSA6IFViID0gc2V0VGltZW91dChKYSwgMkUzKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFNhKCkgewogICAgICAgICAgICBpZiAoZGEoKSkgewogICAgICAgICAgICAgICAgdmFyIGEgPSBZIC0gciAvIDIsCiAgICAgICAgICAgICAgICAgICAgYiA9IFogLSB0IC8gMjsKCiAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBpZiAoNjQgPiBhICogYSArIGIgKiBiIHx8IC4wMSA+IE1hdGguYWJzKFZiIC0gemEpICYmIC4wMSA+IE1hdGguYWJzKFdiIC0gQWEpIHx8IChWYiA9IHphLCBXYiA9IEFhLCBhID0gVSgxMyksIGEuc2V0VWludDgoMCwgMTYpLCBoZXkoYSwgemEsIEFhKSwgeHQpKSB7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gQUdBUkJPVE9WSAoKICAgICAgICAgICAgICAgIC8qIDY0ID4gYSAqIGEgKyBiICogYiB8fCAuMDEgPiBNYXRoLmFicyhWYiAtCiAgICAgICAgICAgICAgICAgICAgIHphKSAmJiAuMDEgPiBNYXRoLmFicyhXYiAtIEFhKSB8fCAoVmIgPSB6YSwgV2IgPSBBYSwgYSA9IFUoMTMpLCBhLnNldFVpbnQ4KDAsIDE2KSwgYS5zZXRJbnQzMigxLCB6YSwgITApLCBhLnNldEludDMyKDUsIEFhLCAhMCksIGEuc2V0VWludDMyKDksIDAsICEwKSwgVihhKSkKICAgICAgICAgICAgICovCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFNiKCkgewogICAgICAgICAgICBpZiAoZGEoKSAmJiBuYSAmJiBudWxsICE9IE4pIHsKICAgICAgICAgICAgICAgIHZhciBhID0gVSgxICsgMiAqIE4ubGVuZ3RoKTsKICAgICAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgICAgIHN0b3BNb3ZlID0gZmFsc2U7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9GZWVkSW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgYXV0b0ZlZWRJbnRlcnZhbCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgMCk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IE4ubGVuZ3RoOyArK2IpIGEuc2V0VWludDE2KDEgKyAyICogYiwgTi5jaGFyQ29kZUF0KGIpLCAhMCk7CiAgICAgICAgICAgICAgICBWKGEpOwogICAgICAgICAgICAgICAgTiA9IG51bGwKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZWIoKSB7CiAgICAgICAgICAgIFNhKCk7CiAgICAgICAgICAgIFgoMTcpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBKYigpIHsKICAgICAgICAgICAgU2EoKTsKICAgICAgICAgICAgWCgyMSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRhKCkgewogICAgICAgICAgICByZXR1cm4gbnVsbCAhPSB3ICYmIHcucmVhZHlTdGF0ZSA9PSB3Lk9QRU4KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFgoYSkgewogICAgICAgICAgICBpZiAoZGEoKSkgewogICAgICAgICAgICAgICAgdmFyIGIgPSBVKDEpOwogICAgICAgICAgICAgICAgYi5zZXRVaW50OCgwLCBhKTsKICAgICAgICAgICAgICAgIFYoYikKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gWGIoKSB7CiAgICAgICAgICAgIHIgPSAxICogYy5pbm5lcldpZHRoOwogICAgICAgICAgICB0ID0gMSAqIGMuaW5uZXJIZWlnaHQ7CiAgICAgICAgICAgIHliLndpZHRoID0gTy53aWR0aCA9IHI7CiAgICAgICAgICAgIHliLmhlaWdodCA9IE8uaGVpZ2h0ID0gdDsKICAgICAgICAgICAgdmFyIGEgPSBlKCIjaGVsbG9Db250YWluZXIiKTsKICAgICAgICAgICAgYS5jc3MoInRyYW5zZm9ybSIsICJub25lIik7CiAgICAgICAgICAgIHZhciBiID0gYS5oZWlnaHQoKSwKICAgICAgICAgICAgICAgIGQgPSBjLmlubmVySGVpZ2h0OwogICAgICAgICAgICAwICE9IGIgLyAyICUgMiAmJiAoYisrLCBhLmhlaWdodChiKSk7CiAgICAgICAgICAgIGIgPiBkIC8gMS4xID8gYS5jc3MoInRyYW5zZm9ybSIsICJ0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoIiArIGQgLyBiIC8gMS4xICsgIikiKSA6IGEuY3NzKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKC01MCUsIC01MCUpIik7CiAgICAgICAgICAgIFliKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFpiKCkgewogICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgYSA9IDEgKiBNYXRoLm1heCh0IC8gMTA4MCwgciAvIDE5MjApOwogICAgICAgICAgICByZXR1cm4gYSAqPSBQCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBJYygpIHsKICAgICAgICAgICAgaWYgKDAgIT0gcS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSAwLCBiID0gMDsgYiA8IHEubGVuZ3RoOyBiKyspIGEgKz0gcVtiXS5zaXplOwogICAgICAgICAgICAgICAgbCA9ICg5ICogbCArIE1hdGgucG93KE1hdGgubWluKDY0IC8gYSwgMSksIC40KSAqIFpiKCkpIC8gMTAKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gWWIoKSB7CiAgICAgICAgICAgIHZhciBhLCBiID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgKytKYzsKICAgICAgICAgICAgJGIgJiYgKCsrVGEsIDE4MCA8IFRhICYmIChUYSA9IDApKTsKICAgICAgICAgICAgeCA9CiAgICAgICAgICAgICAgICBiOwogICAgICAgICAgICBpZiAoMCA8IHEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBJYygpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IGEgPSAwLCBjID0gMDsgYyA8IHEubGVuZ3RoOyBjKyspIHFbY10uVCgpLCBhICs9IHFbY10ueCAvIHEubGVuZ3RoLCBkICs9IHFbY10ueSAvIHEubGVuZ3RoOwogICAgICAgICAgICAgICAgcGEgPSBhOwogICAgICAgICAgICAgICAgcWEgPSBkOwogICAgICAgICAgICAgICAgcmEgPSBsOwogICAgICAgICAgICAgICAgeSA9ICh5ICsgYSkgLyAyOwogICAgICAgICAgICAgICAgeiA9ICh6ICsgZCkgLyAyCiAgICAgICAgICAgIH0gZWxzZSB5ID0gKDI5ICogeSArIHBhKSAvIDMwLCB6ID0gKDI5ICogeiArIHFhKSAvIDMwLCBsID0gKDkgKiBsICsgcmEgKiBaYigpKSAvIDEwOwogICAgICAgICAgICB1YygpOwogICAgICAgICAgICBmYigpOwogICAgICAgICAgICB6YiB8fCBmLmNsZWFyUmVjdCgwLCAwLCByLCB0KTsKICAgICAgICAgICAgemIgPyAoZi5maWxsU3R5bGUgPSBlYSA/ICIjMTExMTExIiA6ICIjRjJGQkZGIiwgZi5nbG9iYWxBbHBoYSA9IC4wNSwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSwgZi5nbG9iYWxBbHBoYSA9IDEpIDogS2MoKTsKICAgICAgICAgICAgQS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYS5zaXplID09IGIuc2l6ZSA/IGEuaWQgLSBiLmlkIDogYS5zaXplIC0gYi5zaXplCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBmLnNhdmUoKTsKICAgICAgICAgICAgZi50cmFuc2xhdGUociAvIDIsIHQgLyAyKTsKICAgICAgICAgICAgZi5zY2FsZShsLCBsKTsKICAgICAgICAgICAgZi50cmFuc2xhdGUoLXksIC16KTsKICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8IGJhLmxlbmd0aDsgYysrKSBiYVtjXS53KGYpOwogICAgICAgICAgICBmb3IgKGMgPSAwOyBjIDwKICAgICAgICAgICAgICAgIEEubGVuZ3RoOyBjKyspIEFbY10udyhmKTsKICAgICAgICAgICAgaWYgKHBiKSB7CiAgICAgICAgICAgICAgICBLYSA9ICgzICogS2EgKyBuYikgLyA0OwogICAgICAgICAgICAgICAgTGEgPSAoMyAqIExhICsgb2IpIC8gNDsKICAgICAgICAgICAgICAgIGYuc2F2ZSgpOwogICAgICAgICAgICAgICAgZi5zdHJva2VTdHlsZSA9ICIjRkZBQUFBIjsKICAgICAgICAgICAgICAgIGYubGluZVdpZHRoID0gMTA7CiAgICAgICAgICAgICAgICBmLmxpbmVDYXAgPSAicm91bmQiOwogICAgICAgICAgICAgICAgZi5saW5lSm9pbiA9ICJyb3VuZCI7CiAgICAgICAgICAgICAgICBmLmdsb2JhbEFscGhhID0gLjU7CiAgICAgICAgICAgICAgICBmLmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8IHEubGVuZ3RoOyBjKyspIGYubW92ZVRvKHFbY10ueCwgcVtjXS55KSwgZi5saW5lVG8oS2EsIExhKTsKICAgICAgICAgICAgICAgIGYuc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICBmLnJlc3RvcmUoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGYucmVzdG9yZSgpOwogICAgICAgICAgICBIICYmIEgud2lkdGggJiYgZi5kcmF3SW1hZ2UoSCwgciAtIEgud2lkdGggLSAxMCwgMTApOwogICAgICAgICAgICBUID0gTWF0aC5tYXgoVCwgYWMoKSk7CiAgICAgICAgICAgIDAgIT0gVCAmJiAobnVsbCA9PSBVYSAmJiAoVWEgPSBuZXcgVmEoMjQsICIjRkZGRkZGIikpLCBVYS5CKFIoInNjb3JlIikgKyAiOiAiICsgfn4oVCAvIDEwMCkpLCBkID0gVWEuTygpLCBhID0gZC53aWR0aCwgZi5nbG9iYWxBbHBoYSA9IC4yLCBmLmZpbGxTdHlsZSA9ICIjMDAwMDAwIiwgZi5maWxsUmVjdCgxMCwgdCAtIDEwIC0gMjQgLSAxMCwgYSArIDEwLCAzNCksCiAgICAgICAgICAgICAgICBmLmdsb2JhbEFscGhhID0gMSwgZi5kcmF3SW1hZ2UoZCwgMTUsIHQgLSAxMCAtIDI0IC0gNSkpOwogICAgICAgICAgICBMYygpOwogICAgICAgICAgICBiID0gRGF0ZS5ub3coKSAtIGI7CiAgICAgICAgICAgIGIgPiAxRTMgLyA2MCA/IE0gLT0gLjAxIDogYiA8IDFFMyAvIDY1ICYmIChNICs9IC4wMSk7CiAgICAgICAgICAgIC40ID4gTSAmJiAoTSA9IC40KTsKICAgICAgICAgICAgMSA8IE0gJiYgKE0gPSAxKTsKICAgICAgICAgICAgYiA9IHggLSBiYzsKICAgICAgICAgICAgIWRhKCkgfHwgamEgfHwgYWEgPyAoQiArPSBiIC8gMkUzLCAxIDwgQiAmJiAoQiA9IDEpKSA6IChCIC09IGIgLyAzMDAsIDAgPiBCICYmIChCID0gMCkpOwogICAgICAgICAgICAwIDwgQiA/IChmLmZpbGxTdHlsZSA9ICIjMDAwMDAwIiwgY2MgPyAoZi5nbG9iYWxBbHBoYSA9IEIsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCksIEouY29tcGxldGUgJiYgSi53aWR0aCAmJiAoSi53aWR0aCAvIEouaGVpZ2h0IDwgciAvIHQgPyAoYiA9IHIsIGEgPSBKLmhlaWdodCAqIHIgLyBKLndpZHRoKSA6IChiID0gSi53aWR0aCAqIHQgLyBKLmhlaWdodCwgYSA9IHQpLCBmLmRyYXdJbWFnZShKLCAociAtIGIpIC8gMiwgKHQgLSBhKSAvIDIsIGIsIGEpLCBmLmdsb2JhbEFscGhhID0gLjUgKiBCLCBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpKSkgOiAoZi5nbG9iYWxBbHBoYSA9IC41ICogQiwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSksIGYuZ2xvYmFsQWxwaGEgPSAxKSA6IGNjID0gITE7CiAgICAgICAgICAgIGJjID0geAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gS2MoKSB7CiAgICAgICAgICAgIGYuZmlsbFN0eWxlID0KICAgICAgICAgICAgICAgIGVhID8gIiMxMTExMTEiIDogIiNGMkZCRkYiOwogICAgICAgICAgICBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpOwogICAgICAgICAgICBmLnNhdmUoKTsKICAgICAgICAgICAgZi5zdHJva2VTdHlsZSA9IGVhID8gIiNBQUFBQUEiIDogIiMwMDAwMDAiOwogICAgICAgICAgICBmLmdsb2JhbEFscGhhID0gLjIgKiBsOwogICAgICAgICAgICBmb3IgKHZhciBhID0gciAvIGwsIGIgPSB0IC8gbCwgZCA9ICgteSArIGEgLyAyKSAlIDUwOyBkIDwgYTsgZCArPSA1MCkgZi5iZWdpblBhdGgoKSwgZi5tb3ZlVG8oZCAqIGwgLSAuNSwgMCksIGYubGluZVRvKGQgKiBsIC0gLjUsIGIgKiBsKSwgZi5zdHJva2UoKTsKICAgICAgICAgICAgZm9yIChkID0gKC16ICsgYiAvIDIpICUgNTA7IGQgPCBiOyBkICs9IDUwKSBmLmJlZ2luUGF0aCgpLCBmLm1vdmVUbygwLCBkICogbCAtIC41KSwgZi5saW5lVG8oYSAqIGwsIGQgKiBsIC0gLjUpLCBmLnN0cm9rZSgpOwogICAgICAgICAgICBmLnJlc3RvcmUoKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gTGMoKSB7CiAgICAgICAgICAgIGlmIChkYyAmJiBBYi53aWR0aCkgewogICAgICAgICAgICAgICAgdmFyIGEgPSByIC8gNTsKICAgICAgICAgICAgICAgIGYuZHJhd0ltYWdlKEFiLCA1LCA1LCBhLCBhKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBhYygpIHsKICAgICAgICAgICAgZm9yICh2YXIgYSA9IDAsIGIgPSAwOyBiIDwgcS5sZW5ndGg7IGIrKykgYSArPSBxW2JdLmcgKiBxW2JdLmc7CiAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBSYigpIHsKICAgICAgICAgICAgSCA9IG51bGw7CiAgICAgICAgICAgIGlmIChudWxsICE9IEkgfHwgMCAhPSBDLmxlbmd0aCkKICAgICAgICAgICAgICAgIGlmIChudWxsICE9IEkgfHwgZmEpIHsKICAgICAgICAgICAgICAgICAgICBIID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBILmdldENvbnRleHQoIjJkIiksCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSA2MCwKICAgICAgICAgICAgICAgICAgICAgICAgYiA9IG51bGwgPT0gSSA/IGIgKyAyNCAqIEMubGVuZ3RoIDogYiArIDE4MCwKICAgICAgICAgICAgICAgICAgICAgICAgZCA9IE1hdGgubWluKDIwMCwgLjMgKiByKSAvIDIwMDsKICAgICAgICAgICAgICAgICAgICBILndpZHRoID0gMjAwICogZDsKICAgICAgICAgICAgICAgICAgICBILmhlaWdodCA9IGIgKiBkOwogICAgICAgICAgICAgICAgICAgIGEuc2NhbGUoZCwgZCk7CiAgICAgICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IC40OwogICAgICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gIiMwMDAwMDAiOwogICAgICAgICAgICAgICAgICAgIGEuZmlsbFJlY3QoMCwgMCwgMjAwLCBiKTsKICAgICAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9ICIjRkZGRkZGIjsKICAgICAgICAgICAgICAgICAgICBkID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBkID0gUigibGVhZGVyYm9hcmQiKTsKICAgICAgICAgICAgICAgICAgICBhLmZvbnQgPSAiMzBweCBVYnVudHUiOwogICAgICAgICAgICAgICAgICAgIGEuZmlsbFRleHQoZCwgMTAwIC0gYS5tZWFzdXJlVGV4dChkKS53aWR0aCAvIDIsIDQwKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYywgZTsKICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBJKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEuZm9udCA9ICIyMHB4IFVidW50dSIsIGIgPSAwOyBiIDwgQy5sZW5ndGg7ICsrYikgZCA9IENbYl0ubmFtZSB8fCBSKCJ1bm5hbWVkX2NlbGwiKSwgZmEgfHwgKGQgPSBSKCJ1bm5hbWVkX2NlbGwiKSksIDEgPT0gQ1tiXS5pZCB8fCAtMSAhPSBFLmluZGV4T2YoQ1tiXS5pZCkgPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHFbMF0ubmFtZSAmJiAoZCA9IHFbMF0ubmFtZSksIGEuZmlsbFN0eWxlID0gIiNGRkFBQUEiKSA6IGEuZmlsbFN0eWxlID0gIiNGRkZGRkYiLCBkID0gYiArIDEgKyAiLiAiICsgZCwgZSA9IGEubWVhc3VyZVRleHQoZCkud2lkdGgsIGMgPSA3MCArIDI0ICogYiwgMjAwIDwgZSA/IGEuZmlsbFRleHQoZCwgMTAsIGMpIDogYS5maWxsVGV4dChkLCAoMjAwIC0gZSkgLyAyLCBjKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiA9IGQgPSAwOyBiIDwgSS5sZW5ndGg7ICsrYikgYyA9IGQgKyBJW2JdICogTWF0aC5QSSAqIDIsIGEuZmlsbFN0eWxlID0gTWNbYiArIDFdLCBhLmJlZ2luUGF0aCgpLCBhLm1vdmVUbygxMDAsIDE0MCksIGEuYXJjKDEwMCwgMTQwLCA4MCwgZCwgYywgITEpLCBhLmZpbGwoKSwgZCA9IGMKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE5jKGEpIHsKICAgICAgICAgICAgaWYgKG51bGwgPT0gYSB8fCAwID09IGEubGVuZ3RoKSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgaWYgKCIlIiA9PSBhWzBdKSB7CiAgICAgICAgICAgICAgICBpZiAoIWMuTUMgfHwgIWMuTUMuZ2V0U2tpbkluZm8pIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgYSA9IGMuTUMuZ2V0U2tpbkluZm8oInNraW5fIiArIGEuc2xpY2UoMSkpOwogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gYSkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICBmb3IgKGEgPSAoK2EuY29sb3IpLnRvU3RyaW5nKDE2KSA7IDYgPgogICAgICAgICAgICAgICAgICAgIGEubGVuZ3RoOykgYSA9ICIwIiArIGE7CiAgICAgICAgICAgICAgICByZXR1cm4gIiMiICsgYQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBlYyhhKSB7CiAgICAgICAgICAgIGlmIChudWxsID09IGEgfHwgMCA9PSBhLmxlbmd0aCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIGlmICghc2EuaGFzT3duUHJvcGVydHkoYSkpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gbmV3IEltYWdlOwogICAgICAgICAgICAgICAgaWYgKCI6IiA9PSBhWzBdKSBiLnNyYyA9IGEuc2xpY2UoMSk7CiAgICAgICAgICAgICAgICBlbHNlIGlmICgiJSIgPT0gYVswXSkgewogICAgICAgICAgICAgICAgICAgIGlmICghYy5NQyB8fCAhYy5NQy5nZXRTa2luSW5mbykgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBjLk1DLmdldFNraW5JbmZvKCJza2luXyIgKyBhLnNsaWNlKDEpKTsKICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBkKSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICBiLnNyYyA9IGMuQVNTRVRTX1JPT1QgKyBkLnVybAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2FbYV0gPSBiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIDAgIT0gc2FbYV0ud2lkdGggJiYgc2FbYV0uY29tcGxldGUgPyBzYVthXSA6IG51bGwKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEJiKGEsIGIsIGQsIGMsIGUpIHsKICAgICAgICAgICAgdGhpcy4kID0gYTsKICAgICAgICAgICAgdGhpcy54ID0gYjsKICAgICAgICAgICAgdGhpcy55ID0gZDsKICAgICAgICAgICAgdGhpcy5mID0gYzsKICAgICAgICAgICAgdGhpcy5iID0gZQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY2EoYSwgYiwgZCwgYywgZSwgcCkgewogICAgICAgICAgICB0aGlzLmlkID0gYTsKICAgICAgICAgICAgdGhpcy5zID0gdGhpcy54ID0gdGhpcy5NID0gdGhpcy5KID0gYjsKICAgICAgICAgICAgdGhpcy51ID0gdGhpcy55ID0gdGhpcy5OID0gdGhpcy5LID0gZDsKICAgICAgICAgICAgdGhpcy5vID0gdGhpcy5zaXplID0gYzsKICAgICAgICAgICAgdGhpcy5jb2xvciA9IGU7CiAgICAgICAgICAgIHRoaXMuYSA9IFtdOwogICAgICAgICAgICB0aGlzLmJhKCk7CiAgICAgICAgICAgIHRoaXMuQShwKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSGMoYSkgewogICAgICAgICAgICBmb3IgKGEgPSBhLnRvU3RyaW5nKDE2KSA7IDYgPiBhLmxlbmd0aDspIGEgPSAiMCIgKyBhOwogICAgICAgICAgICByZXR1cm4gIiMiICsgYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gVmEoYSwgYiwgZCwgYykgewogICAgICAgICAgICBhICYmICh0aGlzLnYgPSBhKTsKICAgICAgICAgICAgYiAmJiAodGhpcy5XID0gYik7CiAgICAgICAgICAgIHRoaXMuWSA9ICEhZDsKICAgICAgICAgICAgYyAmJiAodGhpcy5aID0gYykKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE9jKGEpIHsKICAgICAgICAgICAgZm9yICh2YXIgYiA9IGEubGVuZ3RoLCBkLCBjOyAwIDwgYjspIGMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBiKSwgYi0tLCBkID0gYVtiXSwgYVtiXSA9IGFbY10sIGFbY10gPSBkCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBQYygpIHsKICAgICAgICAgICAgaCA9IFdhCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBmYyhhKSB7CiAgICAgICAgICAgIGguY29udGV4dCA9ICJnb29nbGUiID09IGEgPyAiZ29vZ2xlIiA6ICJmYWNlYm9vayI7CiAgICAgICAgICAgIFhhKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFhhKCkgewogICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8gPSBKU09OLnN0cmluZ2lmeShoKTsKICAgICAgICAgICAgaCA9IEpTT04ucGFyc2UoYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvKTsKICAgICAgICAgICAgYy5zdG9yYWdlSW5mbyA9IGg7CiAgICAgICAgICAgICJnb29nbGUiID09IGguY29udGV4dCA/IChlKCIjZ1BsdXNTaGFyZSIpLnNob3coKSwgZSgiI2ZiU2hhcmUiKS5oaWRlKCkpIDogKGUoIiNnUGx1c1NoYXJlIikuaGlkZSgpLCBlKCIjZmJTaGFyZSIpLnNob3coKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdjKGEpIHsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIik7CiAgICAgICAgICAgICIiICE9IGEuZGlzcGxheU5hbWUgJiYgKGEubmFtZSA9IGEuZGlzcGxheU5hbWUpOwogICAgICAgICAgICBpZiAobnVsbCA9PSBhLm5hbWUgfHwgdm9pZCAwID09IGEubmFtZSkgYS5uYW1lID0gIiI7CiAgICAgICAgICAgIHZhciBiID0gYS5uYW1lLmxhc3RJbmRleE9mKCJfIik7IC0xICE9IGIgJiYgKGEubmFtZSA9IGEubmFtZS5zdWJzdHJpbmcoMCwgYikpOwogICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWhhcy1hY2NvdW50LWRhdGEiLCAiMSIpOwogICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWxvZ2dlZC1pbiIsICIxIik7CiAgICAgICAgICAgIGUoIi5hZ2FyaW8tcHJvZmlsZS1wYW5lbCAucHJvZ3Jlc3MtYmFyLXN0YXIiKS50ZXh0KGEubGV2ZWwpOwogICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikudGV4dChhLnhwICsgIi8iICsgYS54cE5lZWRlZCArICIgWFAiKTsKICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXIiKS5jc3MoIndpZHRoIiwgKDg4ICogYS54cCAvIGEueHBOZWVkZWQpLnRvRml4ZWQoMikgKyAiJSIpOwogICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtbmFtZSIpLnRleHQoYS5uYW1lKTsKICAgICAgICAgICAgIiIgIT0gYS5waWN0dXJlICYmIGUoIi5hZ2FyaW8tcHJvZmlsZS1waWN0dXJlIikuYXR0cigic3JjIiwgYS5waWN0dXJlKTsKICAgICAgICAgICAgQ2IoKTsKICAgICAgICAgICAgaC51c2VySW5mby5sZXZlbCA9IGEubGV2ZWw7CiAgICAgICAgICAgIGgudXNlckluZm8ueHAgPSBhLnhwOwogICAgICAgICAgICBoLnVzZXJJbmZvLnhwTmVlZGVkID0gYS54cE5lZWRlZDsKICAgICAgICAgICAgaC51c2VySW5mby5kaXNwbGF5TmFtZSA9IGEubmFtZTsKICAgICAgICAgICAgaC51c2VySW5mby5sb2dnZWRJbiA9ICIxIjsKICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdhKGEsIGIpIHsKICAgICAgICAgICAgdmFyIGQgPSBhOwogICAgICAgICAgICBpZiAoaC51c2VySW5mby5sb2dnZWRJbikgewogICAgICAgICAgICAgICAgdmFyIHUgPSBlKCIjaGVsbG9Db250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiAiMSIgPT0gZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIik7CiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBkIHx8IHZvaWQgMCA9PSBkKSBkID0gaC51c2VySW5mbzsKICAgICAgICAgICAgICAgIGlmICh1KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSArZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLmZpcnN0KCkudGV4dCgpLnNwbGl0KCIvIilbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIHUgPSArZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLmZpcnN0KCkudGV4dCgpLnNwbGl0KCIvIilbMV0uc3BsaXQoIiAiKVswXSwKICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGUoIi5hZ2FyaW8tcHJvZmlsZS1wYW5lbCAucHJvZ3Jlc3MtYmFyLXN0YXIiKS5maXJzdCgpLnRleHQoKTsKICAgICAgICAgICAgICAgICAgICBpZiAocCAhPSBkLmxldmVsKSBnYSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHhwOiB1LAogICAgICAgICAgICAgICAgICAgICAgICB4cE5lZWRlZDogdSwKICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IHAKICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tcHJvZmlsZS1wYW5lbCAucHJvZ3Jlc3MtYmFyLXN0YXIiKS50ZXh0KGQubGV2ZWwpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhciIpLmNzcygid2lkdGgiLCAiMTAwJSIpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIucHJvZ3Jlc3MtYmFyLXN0YXIiKS5hZGRDbGFzcygiYW5pbWF0ZWQgdGFkYSIpLm9uZSgid2Via2l0QW5pbWF0aW9uRW5kIG1vekFuaW1hdGlvbkVuZCBNU0FuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIGFuaW1hdGlvbmVuZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5wcm9ncmVzcy1iYXItc3RhciIpLnJlbW92ZUNsYXNzKCJhbmltYXRlZCB0YWRhIikKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLnRleHQoZC54cE5lZWRlZCArICIvIiArIGQueHBOZWVkZWQgKyAiIFhQIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeHA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeHBOZWVkZWQ6IGQueHBOZWVkZWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGQubGV2ZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYShkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMUUzKQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAoRGF0ZS5ub3coKSAtIGYpIC8gMUUzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAwID4gYSA/IDAgOiAxIDwgYSA/IDEgOiBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBhICogYSAqICgzIC0gMiAqIGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KH5+KGcgKyAoZC54cCAtIGcpICogYSkgKyAiLyIgKyBkLnhwTmVlZGVkICsgIiBYUCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIChnICsgKGQueHAgLSBnKSAqIGEpIC8gZC54cE5lZWRlZCkudG9GaXhlZCgyKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiAmJiBiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSA+IGEgJiYgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGspCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBDYigpIHsKICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICgidW5kZWZpbmVkIiAhPT0gdHlwZW9mIGEgJiYgYSB8fCAibm9uZSIgPT0gZSgiI3NldHRpbmdzIikuY3NzKCJkaXNwbGF5IikgJiYgIm5vbmUiID09IGUoIiNzb2NpYWxMb2dpbkNvbnRhaW5lciIpLmNzcygiZGlzcGxheSIpKSAmJiBlKCIjaW5zdHJ1Y3Rpb25zIikuc2hvdygpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBoYyhhKSB7CiAgICAgICAgICAgIGlmICgiY29ubmVjdGVkIiA9PSBhLnN0YXR1cykgewogICAgICAgICAgICAgICAgdmFyIGIgPSBhLmF1dGhSZXNwb25zZS5hY2Nlc3NUb2tlbjsKICAgICAgICAgICAgICAgIG51bGwgPT0gYiB8fCAidW5kZWZpbmVkIiA9PSBiIHx8ICIiID09IGIgPyAoMyA+IGljICYmIChpYysrLCBjLmZhY2Vib29rUmVsb2dpbigpKSwgYy5sb2dvdXQoKSkgOiAoYy5NQy5kb0xvZ2luV2l0aEZCKGIpLCBtLmNhY2hlLmxvZ2luX2luZm8gPSBbYiwgImZhY2Vib29rIl0sIGMuRkIuYXBpKCIvbWUvcGljdHVyZT93aWR0aD0xODAmaGVpZ2h0PTE4MCIsIGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICAgICAgICAgICAgaC51c2VySW5mby5waWN0dXJlID0gYi5kYXRhLnVybDsKICAgICAgICAgICAgICAgICAgICBjLnVwZGF0ZVN0b3JhZ2UoKTsKICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGIuZGF0YS51cmwpOwogICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8uc29jaWFsSWQgPSBhLmF1dGhSZXNwb25zZS51c2VySUQ7CiAgICAgICAgICAgICAgICAgICAgWWEoKQogICAgICAgICAgICAgICAgfSksIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtbG9nZ2VkLWluIiwgIjEiKSwgaC5jb250ZXh0ID0gImZhY2Vib29rIiwgaC5sb2dpbkludGVudCA9ICIxIiwgYy51cGRhdGVTdG9yYWdlKCkpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGpjKGEpIHsKICAgICAgICAgICAga2EoIjpwYXJ0eSIpOwogICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLXBhcnR5LXN0YXRlIiwgIjQiKTsKICAgICAgICAgICAgYSA9IGRlY29kZVVSSUNvbXBvbmVudChhKS5yZXBsYWNlKC8uKiMvZ2ltLCAiIik7CiAgICAgICAgICAgIERiKCIjIiArIGMuZW5jb2RlVVJJQ29tcG9uZW50KGEpKTsKICAgICAgICAgICAgZS5hamF4KENhICsgImdldFRva2VuIiwgewogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLXBhcnR5LXN0YXRlIiwgIjYiKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICAgICAgICAgICAgYiA9IGIuc3BsaXQoIlxuIik7CiAgICAgICAgICAgICAgICAgICAgZSgiLnBhcnR5VG9rZW4iKS52YWwoImFnYXIuaW8vIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7CiAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI1Iik7CiAgICAgICAgICAgICAgICAgICAga2EoIjpwYXJ0eSIpOwogICAgICAgICAgICAgICAgICAgIGxiKCJ3czovLyIgKyBiWzBdLCBhKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAidGV4dCIsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGNhY2hlOiAhMSwKICAgICAgICAgICAgICAgIGNyb3NzRG9tYWluOiAhMCwKICAgICAgICAgICAgICAgIGRhdGE6IGEKICAgICAgICAgICAgfSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIERiKGEpIHsKICAgICAgICAgICAgYy5oaXN0b3J5ICYmIGMuaGlzdG9yeS5yZXBsYWNlU3RhdGUgJiYgYy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwgYy5kb2N1bWVudC50aXRsZSwgYSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEphKCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoVWIpOwogICAgICAgICAgICBudWxsID09IGMuc3RvcmFnZUluZm8gJiYgYy5jcmVhdGVEZWZhdWx0U3RvcmFnZSgpOwogICAgICAgICAgICBFYiA9IERhdGUubm93KCk7CiAgICAgICAgICAgIDAgPj0gUmEgJiYgKFJhID0gRWIpOwogICAgICAgICAgICBFYSA9ICExOwogICAgICAgICAgICBRYygpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBHYyhhLCBiKSB7CiAgICAgICAgICAgIHZhciBkID0gLTEgIT0gRS5pbmRleE9mKGEuaWQpLAogICAgICAgICAgICAgICAgYyA9IC0xICE9IEUuaW5kZXhPZihiLmlkKSwKICAgICAgICAgICAgICAgIGUgPSAzMCA+IGIuc2l6ZTsKICAgICAgICAgICAgZCAmJiBlICYmICsrdWI7CiAgICAgICAgICAgIGUgfHwgIWQgfHwgYyB8fCBiLmVhICYgMzIgfHwgKyt3YgogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24ga2MoYSkgewogICAgICAgICAgICBhID0gfn5hOwogICAgICAgICAgICB2YXIgYiA9IChhICUgNjApLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIGEgPSAofn4oYSAvIDYwKSkudG9TdHJpbmcoKTsKICAgICAgICAgICAgMiA+IGIubGVuZ3RoICYmIChiID0gIjAiICsgYik7CiAgICAgICAgICAgIHJldHVybiBhICsgIjoiICsgYgogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUmMoKSB7CiAgICAgICAgICAgIGlmIChudWxsID09IEMpIHJldHVybiAwOwogICAgICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IEMubGVuZ3RoOyArK2EpCiAgICAgICAgICAgICAgICBpZiAoLTEgIT0gRS5pbmRleE9mKENbYV0uaWQpKSByZXR1cm4gYSArIDE7CiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBTYygpIHsKICAgICAgICAgICAgZSgiLnN0YXRzLWZvb2QtZWF0ZW4iKS50ZXh0KHViKTsKICAgICAgICAgICAgZSgiLnN0YXRzLXRpbWUtYWxpdmUiKS50ZXh0KGtjKChFYiAtIFJhKSAvIDFFMykpOwogICAgICAgICAgICBlKCIuc3RhdHMtbGVhZGVyYm9hcmQtdGltZSIpLnRleHQoa2MoeGIpKTsKICAgICAgICAgICAgZSgiLnN0YXRzLWhpZ2hlc3QtbWFzcyIpLnRleHQofn4oVCAvIDEwMCkpOwogICAgICAgICAgICBlKCIuc3RhdHMtY2VsbHMtZWF0ZW4iKS50ZXh0KHdiKTsKICAgICAgICAgICAgZSgiLnN0YXRzLXRvcC1wb3NpdGlvbiIpLnRleHQoMCA9PSBXID8gIjooIiA6CiAgICAgICAgICAgICAgICBXKTsKICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHNHcmFwaCIpOwogICAgICAgICAgICBpZiAoYSkgewogICAgICAgICAgICAgICAgdmFyIGIgPSBhLmdldENvbnRleHQoIjJkIiksCiAgICAgICAgICAgICAgICAgICAgZCA9IGEud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgYSA9IGEuaGVpZ2h0OwogICAgICAgICAgICAgICAgYi5jbGVhclJlY3QoMCwgMCwgZCwgYSk7CiAgICAgICAgICAgICAgICBpZiAoMiA8IEYubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDIwMCwgZyA9IDA7IGcgPCBGLmxlbmd0aDsgZysrKSBjID0gTWF0aC5tYXgoRltnXSwgYyk7CiAgICAgICAgICAgICAgICAgICAgYi5saW5lV2lkdGggPSAzOwogICAgICAgICAgICAgICAgICAgIGIubGluZUNhcCA9ICJyb3VuZCI7CiAgICAgICAgICAgICAgICAgICAgYi5saW5lSm9pbiA9ICJyb3VuZCI7CiAgICAgICAgICAgICAgICAgICAgYi5zdHJva2VTdHlsZSA9IHZiOwogICAgICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gdmI7CiAgICAgICAgICAgICAgICAgICAgYi5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICBiLm1vdmVUbygwLCBhIC0gRlswXSAvIGMgKiAoYSAtIDEwKSArIDEwKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGcgPSAxOyBnIDwgRi5sZW5ndGg7IGcgKz0gTWF0aC5tYXgofn4oRi5sZW5ndGggLyBkKSwgMSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcCA9IGcgLyAoRi5sZW5ndGggLSAxKSAqIGQsIGYgPSBbXSwgayA9IC0yMDsgMjAgPj0gazsgKytrKSAwID4gZyArIGsgfHwgZyArIGsgPj0gRi5sZW5ndGggfHwgZi5wdXNoKEZbZyArIGtdKTsKICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGYucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIGIKICAgICAgICAgICAgICAgICAgICAgICAgfSkgLyBmLmxlbmd0aCAvIGM7CiAgICAgICAgICAgICAgICAgICAgICAgIGIubGluZVRvKHAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhIC0gZiAqIChhIC0gMTApICsgMTApCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGIuc3Ryb2tlKCk7CiAgICAgICAgICAgICAgICAgICAgYi5nbG9iYWxBbHBoYSA9IC41OwogICAgICAgICAgICAgICAgICAgIGIubGluZVRvKGQsIGEpOwogICAgICAgICAgICAgICAgICAgIGIubGluZVRvKDAsIGEpOwogICAgICAgICAgICAgICAgICAgIGIuZmlsbCgpOwogICAgICAgICAgICAgICAgICAgIGIuZ2xvYmFsQWxwaGEgPSAxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFFjKCkgewogICAgICAgICAgICBqYSB8fCBhYSB8fCAoWmEgPyAoYy5yZWZyZXNoQWQoYy5hZFNsb3RzLmFiKSwgU2MoKSwgYWEgPSAhMCwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBlKCIjb3ZlcmxheXMiKS5mYWRlSW4oNTAwLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZ2EoKQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlKCIjc3RhdHMiKS5zaG93KCk7CiAgICAgICAgICAgICAgICB2YXIgYSA9IGxjKCJnX3BsdXNfc2hhcmVfc3RhdHMiKTsKICAgICAgICAgICAgICAgIGMuZmlsbFNvY2lhbFZhbHVlcyhhLCAiZ1BsdXNTaGFyZSIpCiAgICAgICAgICAgIH0sIDE1MDApKSA6IHlhKDUwMCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBsYyhhKSB7CiAgICAgICAgICAgIHZhciBiID0gZSgiLnN0YXRzLXRpbWUtYWxpdmUiKS50ZXh0KCk7CiAgICAgICAgICAgIHJldHVybiBjLnBhcnNlU3RyaW5nKGEsICIlQCIsIFtiLnNwbGl0KCI6IilbMF0sIGIuc3BsaXQoIjoiKVsxXSwgZSgiLnN0YXRzLWhpZ2hlc3QtbWFzcyIpLnRleHQoKV0pCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBUYygpIHsKICAgICAgICAgICAgYy5vcGVuKCJodHRwczovL3BsdXMuZ29vZ2xlLmNvbS9zaGFyZT91cmw9d3d3LmFnYXIuaW8maGw9ZW4tVVMiLCAiQWdhci5pbyIsICJ3aWR0aD00ODQsaGVpZ2h0PTU4MCxtZW51YmFyPW5vLHRvb2xiYXI9bm8scmVzaXphYmxlPXllcyxzY3JvbGxiYXJzPW5vLGxlZnQ9IiArIChjLnNjcmVlblggKyBjLmlubmVyV2lkdGggLyAyIC0gMjQyKSArICIsdG9wPSIgKyAoYy5pbm5lckhlaWdodCAtIDU4MCkgLyAyKQogICAgICAgIH0KICAgICAgICB2YXIgbWMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICBpZiAoInVuZGVmaW5lZCIgPT0gdHlwZW9mIGNvbnNvbGUgfHwgInVuZGVmaW5lZCIgPT0gdHlwZW9mIERhdGFWaWV3IHx8ICJ1bmRlZmluZWQiID09IHR5cGVvZiBXZWJTb2NrZXQgfHwgbnVsbCA9PSBtYyB8fCBudWxsID09IG1jLmdldENvbnRleHQgfHwgbnVsbCA9PSBjLmxvY2FsU3RvcmFnZSkgYWxlcnQoIllvdSBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgdGhpcyBnYW1lLCB3ZSByZWNvbW1lbmQgeW91IHRvIHVzZSBGaXJlZm94IHRvIHBsYXkgdGhpcyIpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICB2YXIgRCA9IHt9OwogICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGEgPSBjLmxvY2F0aW9uLnNlYXJjaDsKICAgICAgICAgICAgICAgICI/IiA9PSBhLmNoYXJBdCgwKSAmJiAoYSA9CiAgICAgICAgICAgICAgICAgICAgYS5zbGljZSgxKSk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gYS5zcGxpdCgiJiIpLCBiID0gMDsgYiA8IGEubGVuZ3RoOyBiKyspIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGFbYl0uc3BsaXQoIj0iKTsKICAgICAgICAgICAgICAgICAgICBEW2RbMF1dID0gZFsxXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSgpOwogICAgICAgICAgICBjLnF1ZXJ5U3RyaW5nID0gRDsKICAgICAgICAgICAgdmFyIG5jID0gImZiIiBpbiBELAogICAgICAgICAgICAgICAgVWMgPSAibWluaWNsaXAiIGluIEQsCiAgICAgICAgICAgICAgICB2ID0gewogICAgICAgICAgICAgICAgICAgIHNraW5zRW5hYmxlZDogIjAiLAogICAgICAgICAgICAgICAgICAgIG5hbWVzRW5hYmxlZDogIjAiLAogICAgICAgICAgICAgICAgICAgIG5vQ29sb3JzOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgYmxhY2tUaGVtZTogIjAiLAogICAgICAgICAgICAgICAgICAgIHNob3dNYXNzOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgc3RhdHNFbmFibGVkOiAiMCIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBWYyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB1YSgiIiwgLTEpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb2MgPSAiaHR0cDoiICE9IGMubG9jYXRpb24ucHJvdG9jb2wsCiAgICAgICAgICAgICAgICBXYyA9ICIxIiA9PSB0YygpLAogICAgICAgICAgICAgICAgcGMgPSAhMTsKICAgICAgICAgICAgbmMgfHwgVWMgfHwgKG9jICYmICFXYyA/ICh1YSgiMSIsIDEpLCBjLmxvY2F0aW9uLmhyZWYgPSAiaHR0cDoiICsgYy5sb2NhdGlvbi5ocmVmLnN1YnN0cmluZyhjLmxvY2F0aW9uLnByb3RvY29sLmxlbmd0aCksIHBjID0gITApIDogdWEoIiIsIC0xKSk7CiAgICAgICAgICAgIG9jIHx8IHVhKCIiLCAtMSk7CiAgICAgICAgICAgIHBjIHx8IHNldFRpbWVvdXQoVmMsIDNFMyk7CiAgICAgICAgICAgIGlmICghYy5hZ2FyaW9Ob0luaXQpIHsKICAgICAgICAgICAgICAgIHZhciBqYiA9IGMubG9jYXRpb24ucHJvdG9jb2wsCiAgICAgICAgICAgICAgICAgICAgbWIgPSAiaHR0cHM6IiA9PSBqYjsKICAgICAgICAgICAgICAgIEQubWFzdGVyICYmIChFbnZDb25maWcubWFzdGVyX3VybCA9IEQubWFzdGVyKTsKICAgICAgICAgICAgICAgIHZhciBDYSA9IGpiICsgIi8vIiArIEVudkNvbmZpZy5tYXN0ZXJfdXJsICsgIi8iLAogICAgICAgICAgICAgICAgICAgICRhID0gYy5uYXZpZ2F0b3IudXNlckFnZW50OwogICAgICAgICAgICAgICAgaWYgKC0xICE9ICRhLmluZGV4T2YoIkFuZHJvaWQiKSkgYy5nYSAmJiBjLmdhKCJzZW5kIiwgImV2ZW50IiwgIk1vYmlsZVJlZGlyZWN0IiwgIlBsYXlTdG9yZSIpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjLmxvY2F0aW9uLmhyZWYgPSAiaHR0cHM6Ly9wbGF5Lmdvb2dsZS5jb20vc3RvcmUvYXBwcy9kZXRhaWxzP2lkPWNvbS5taW5pY2xpcC5hZ2FyLmlvIgogICAgICAgICAgICAgICAgfSwgMUUzKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKC0xICE9ICRhLmluZGV4T2YoImlQaG9uZSIpIHx8IC0xICE9ICRhLmluZGV4T2YoImlQYWQiKSB8fCAtMSAhPSAkYS5pbmRleE9mKCJpUG9kIikpIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJNb2JpbGVSZWRpcmVjdCIsICJBcHBTdG9yZSIpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjLmxvY2F0aW9uLmhyZWYgPSAiaHR0cHM6Ly9pdHVuZXMuYXBwbGUuY29tL2FwcC9hZ2FyLmlvL2lkOTk1OTk5NzAzP210PTgmYXQ9MWwzdmFqcCIKICAgICAgICAgICAgICAgIH0sIDFFMyk7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbSA9IHt9OwogICAgICAgICAgICAgICAgICAgIGMuYWdhckFwcCA9IG07CiAgICAgICAgICAgICAgICAgICAgdmFyIHliLCBmLCBPLCByLCB0LCBpYSA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHcgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB5ID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgeiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEUgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgcSA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICBLID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgIEEgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgYmEgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgQyA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICBZID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgWiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHphID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICAgIEFhID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICAgIEpjID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgeCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGJjID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTiA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIE1hID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTmEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBPYSA9IDFFNCwKICAgICAgICAgICAgICAgICAgICAgICAgUGEgPSAxRTQsCiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAxLAogICAgICAgICAgICAgICAgICAgICAgICBHID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgYWIgPSAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgZmEgPSAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgdGEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgc2IgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgVCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGVhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGJiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHBhID0geSA9IH5+KChNYSArIE9hKSAvIDIpLAogICAgICAgICAgICAgICAgICAgICAgICBxYSA9IHogPSB+figoTmEgKyBQYSkgLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgcmEgPSAxLAogICAgICAgICAgICAgICAgICAgICAgICBsYSA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgICBJID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgZ2IgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgcGIgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgbmIgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBvYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEthID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTGEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBNYyA9IFsiIzMzMzMzMyIsICIjRkYzMzMzIiwgIiMzM0ZGMzMiLCAiIzMzMzNGRiJdLAogICAgICAgICAgICAgICAgICAgICAgICB6YiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBuYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBGYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFAgPSAxLAogICAgICAgICAgICAgICAgICAgICAgICBCID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgamEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAga2IgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBjYyA9ICEwLAogICAgICAgICAgICAgICAgICAgICAgICByYiA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHFiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIEogPSBuZXcgSW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgSi5zcmMgPSAiL2ltZy9iYWNrZ3JvdW5kLnBuZyI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRjID0gIm9udG91Y2hzdGFydCIgaW4gYyAmJiAvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QoYy5uYXZpZ2F0b3IudXNlckFnZW50KSwKICAgICAgICAgICAgICAgICAgICAgICAgQWIgPSBuZXcgSW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgQWIuc3JjID0gIi9pbWcvc3BsaXQucG5nIjsKICAgICAgICAgICAgICAgICAgICB2YXIgdmEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgd2EgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgeGEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgY2IgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgRmIsIEdiOwogICAgICAgICAgICAgICAgICAgICJnYW1lcGFkIiBpbiBEICYmIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2IgJiYgKFkgPSBkYi5oYShZLCBGYiksIFogPSBkYi5oYShaLCBHYikpCiAgICAgICAgICAgICAgICAgICAgfSwgMjUpOwogICAgICAgICAgICAgICAgICAgIGMuZ2FtZXBhZEF4aXNVcGRhdGUgPSBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IC4xID4gYiAqIGI7CiAgICAgICAgICAgICAgICAgICAgICAgIDAgPT0gYSAmJiAoZCA/IEZiID0gciAvIDIgOiAoRmIgPSAoYiArIDEpIC8gMiAqIHIsIGNiID0gITApKTsKICAgICAgICAgICAgICAgICAgICAgICAgMSA9PSBhICYmIChkID8gR2IgPSB0IC8gMiA6IChHYiA9IChiICsgMSkgLyAyICogdCwgY2IgPSAhMCkpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLmFnYXJpb0luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdiID0gITA7CiAgICAgICAgICAgICAgICAgICAgICAgIHhjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5pbml0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gYy5sb2NhbFN0b3JhZ2Uuc2V0dGluZ3MgJiYgKHYgPSBKU09OLnBhcnNlKGMubG9jYWxTdG9yYWdlLnNldHRpbmdzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJiID0gdi5zaG93TWFzcywgZWEgPSB2LmJsYWNrVGhlbWUsIGZhID0gdi5uYW1lc0VuYWJsZWQsIHRhID0gdi5ub0NvbG9ycywgWmEgPSB2LnN0YXRzRW5hYmxlZCwgYWIgPSB2LnNraW5zRW5hYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzaG93TWFzcyIpLnByb3AoImNoZWNrZWQiLCB2LnNob3dNYXNzKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI25vU2tpbnMiKS5wcm9wKCJjaGVja2VkIiwgIXYuc2tpbnNFbmFibGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NraXBTdGF0cyIpLnByb3AoImNoZWNrZWQiLCAhdi5zdGF0c0VuYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjbm9Db2xvcnMiKS5wcm9wKCJjaGVja2VkIiwgdi5ub0NvbG9ycyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNub05hbWVzIikucHJvcCgiY2hlY2tlZCIsICF2Lm5hbWVzRW5hYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNkYXJrVGhlbWUiKS5wcm9wKCJjaGVja2VkIiwgdi5ibGFja1RoZW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgTGIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW50ZXJ2YWwoTGIsIDE4RTQpOwogICAgICAgICAgICAgICAgICAgICAgICBPID0geWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gTyAmJiAoZiA9IE8uZ2V0Q29udGV4dCgiMmQiKSwgTy5vbm1vdXNlZG93biA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGEuY2xpZW50WCAtICg1ICsgciAvIDUgLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGEuY2xpZW50WSAtICg1ICsgciAvIDUgLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5zcXJ0KGIgKiBiICsgZCAqIGQpIDw9IHIgLyA1IC8gMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlYigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBZID0gMSAqIGEuY2xpZW50WDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFogPSAxICogYS5jbGllbnRZOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNhKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwgTy5vbm1vdXNlbW92ZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYiA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDEgKiBhLmNsaWVudFg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBaID0gMSAqIGEuY2xpZW50WTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwgTy5vbm1vdXNldXAgPSBmdW5jdGlvbiAoKSB7IH0sIC9maXJlZm94L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSA/IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTU1vdXNlU2Nyb2xsIiwgS2IsICExKSA6IGRvY3VtZW50LmJvZHkub25tb3VzZXdoZWVsID0gS2IsIGMub25ibHVyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgWCgxOSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4YSA9IHdhID0gdmEgPSAhMQogICAgICAgICAgICAgICAgICAgICAgICB9LCBjLm9ucmVzaXplID0gWGIsIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHFjKSwgc2V0SW50ZXJ2YWwoU2EsIDQwKSwgRyAmJiBlKCIjcmVnaW9uIikudmFsKEcpLCBOYigpLCBEYShlKCIjcmVnaW9uIikudmFsKCkpLCAwID09IGtiICYmIEcgJiYgUSgpLCB5YSgwKSwgWGIoKSwgYy5sb2NhdGlvbi5oYXNoICYmIDYgPD0gYy5sb2NhdGlvbi5oYXNoLmxlbmd0aCAmJiBqYyhjLmxvY2F0aW9uLmhhc2gpKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIEJhID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBjLnNldE5pY2sgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBjLmdhICYmIGMuZ2EoInNlbmQiLCAiZXZlbnQiLCAiTmljayIsIGEudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIE1iKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIE4gPSBhOwogICAgICAgICAgICAgICAgICAgICAgICBTYigpOwogICAgICAgICAgICAgICAgICAgICAgICBUID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgdi5za2luc0VuYWJsZWQgPSBhYjsKICAgICAgICAgICAgICAgICAgICAgICAgdi5uYW1lc0VuYWJsZWQgPSBmYTsKICAgICAgICAgICAgICAgICAgICAgICAgdi5ub0NvbG9ycyA9IHRhOwogICAgICAgICAgICAgICAgICAgICAgICB2LmJsYWNrVGhlbWUgPSBlYTsKICAgICAgICAgICAgICAgICAgICAgICAgdi5zaG93TWFzcyA9IGJiOwogICAgICAgICAgICAgICAgICAgICAgICB2LnN0YXRzRW5hYmxlZCA9IFphOwogICAgICAgICAgICAgICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5zZXR0aW5ncyA9IEpTT04uc3RyaW5naWZ5KHYpOwogICAgICAgICAgICAgICAgICAgICAgICBJYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldFNraW5zID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWIgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldE5hbWVzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmEgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldERhcmtUaGVtZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVhID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRDb2xvcnMgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICB0YSA9IGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0U2hvd01hc3MgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBiYiA9IGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc3BlY3RhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE4gPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBJYigpOwogICAgICAgICAgICAgICAgICAgICAgICBYKDEpOwogICAgICAgICAgICAgICAgICAgICAgICBNYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldFJlZ2lvbiA9IERhOwogICAgICAgICAgICAgICAgICAgIHZhciBoYiA9ICEwOwogICAgICAgICAgICAgICAgICAgIGMuc2V0R2FtZU1vZGUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBhICE9IGxhICYmICgiOnBhcnR5IiA9PSBsYSAmJiBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLXBhcnR5LXN0YXRlIiwgIjAiKSwga2EoYSksICI6cGFydHkiICE9IGEgJiYgUSgpKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRBY2lkID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgemIgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgWGMgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwRHJhdzogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZGljdGlvbk1vZGlmaWVyOiAxLjEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuaW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uYWNjb3VudC5pbml0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmdvb2dsZS52YSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5mYS5pbml0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZCA9ICJkZWJ1ZyIgaW4gYy5xdWVyeVN0cmluZykgJiYgbS5kZWJ1Zy5zaG93RGVidWcoKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLmJpbmQgPSBmdW5jdGlvbiAoYSwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZShiKS5iaW5kKGEsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEudW5iaW5kID0gZnVuY3Rpb24gKGEsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoYikudW5iaW5kKGEsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEudHJpZ2dlciA9IGZ1bmN0aW9uIChhLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKGIpLnRyaWdnZXIoYSwgZCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJkZWJ1ZyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lU2V0dGVyX18oImRlYnVnIiwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkID0gYQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJwcm94eSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjLk1DCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lR2V0dGVyX18oImNvbmZpZyIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0oe30pOwogICAgICAgICAgICAgICAgICAgIG0uY29yZSA9IFhjOwogICAgICAgICAgICAgICAgICAgIG0uY2FjaGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICB2YXIgWWMgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKGEsIGIsIGQsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBhICsgIkNhbnZhcyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IGUoIjxjYW52YXM+IiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXBwZW5kKGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IG5ldyBTbW9vdGhpZUNoYXJ0KGQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IGIubGVuZ3RoOyBnKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdSA9IGJbZ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBfLmV4dGVuZChoLCBjW2ddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmFkZFRpbWVTZXJpZXModSwgZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuc3RyZWFtVG8oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSksIDApCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQoYSwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAga1thXSA9IGMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoYSwgW2tbYV1dLCBkLCBbewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDEpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMC4yKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSkKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYygpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGltZVNlcmllcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgS2E6ICExCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLCBmID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDEpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMC4yKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnNob3dEZWJ1ZyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgfHwgKHAgPSBlKCIjZGVidWctb3ZlcmxheSIpLCBkKCJuZXR3b3JrVXBkYXRlIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJuZXR3b3JrIHVwZGF0ZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBkKCJmcHMiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogImZwcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluVmFsdWU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4VmFsdWU6IDEyMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIGsucnR0U0RldiA9IGMoKSwgay5ydHRNZWFuID0gYygpLCBiKCJydHRNZWFuIiwgW2sucnR0U0Rldiwgay5ydHRNZWFuXSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJydHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIFt7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlU3R5bGU6ICJyZ2JhKDI1NSwgMCwgMCwgMSkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAwLjIpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDApIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lV2lkdGg6IDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dKSwgZyA9ICEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5zaG93KCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5oaWRlRGVidWcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyA9ICExCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEudXBkYXRlQ2hhcnQgPSBmdW5jdGlvbiAoYSwgYiwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZyAmJiBhIGluIGsgJiYga1thXS5hcHBlbmQoYiwgZCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJzaG93UHJlZGljdGlvbiIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBhLl9fZGVmaW5lU2V0dGVyX18oInNob3dQcmVkaWN0aW9uIiwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmID0gYQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KHt9KTsKICAgICAgICAgICAgICAgICAgICBtLmRlYnVnID0gWWM7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hID0gewogICAgICAgICAgICAgICAgICAgICAgICBBRjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVg6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBTDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIERaOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVM6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBBRDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFPOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUk6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUc6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVI6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBBTTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVc6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVU6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBBVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFaOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBCUzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCSDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkQ6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJCOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJZOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCWjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCSjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJNOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJUOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBCTzogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJROiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCUjogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIElPOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBWRzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCTjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCRjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgS0g6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIENNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0E6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ1Y6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBLWTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBDRjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFREOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0w6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBDTjogIkNOLUNoaW5hIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ1g6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIENDOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDTzogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0Q6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENLOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ1I6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0k6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBIUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENVOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENXOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENZOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIERLOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgREo6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBETTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBETzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBFQzogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU1Y6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1E6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBFUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRVQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBGTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEZLOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgRko6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBGSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEZSOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0Y6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBQRjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR006ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHRTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgREU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHSDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1I6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHTDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBHRDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBHUDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBHVTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdUOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR046ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHVzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdZOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgSFQ6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkE6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBITjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBISzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSFU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBJUzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIElOOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJRDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSVI6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIElROiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIElNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSUw6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIElUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSk06ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgSlA6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSk86ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtaOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtJOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgS1A6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtSOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLVzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgS0c6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIExBOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBMVjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExCOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBMUzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExSOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFk6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNTzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUs6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1XOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVk6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1WOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBNTDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1UOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUg6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBNUTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBNUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1VOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWVQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNWDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBGTTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1EOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNTjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNUzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBNQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1aOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTU06ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5BOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTlI6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBOUDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBOQzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5aOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkk6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBORzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5VOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkY6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBNUDogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5POiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgT006ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBLOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBQVzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBTOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBQQTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBQRzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBZOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEU6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBQSDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgUE46ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBQTDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgUFI6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgUUE6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgUk86ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBSVTogIlJVLVJ1c3NpYSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJXOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkw6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0g6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBLTjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBMQzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBNRjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBQTTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBWQzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBXUzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU1Q6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNOOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgUlM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTQzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNMOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0c6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNYOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNLOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0k6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTQjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNPOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWkE6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTUzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVTOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTEs6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNEOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU1I6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBTSjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNaOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0U6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDSDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNZOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFc6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRKOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBUWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRIOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBUTDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBUSzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRPOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFQ6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVE46ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBUUjogIlRLLVR1cmtleSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRNOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBUQzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBUVjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVUE6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdCOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVVM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVU06ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBWSTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBVWTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVaOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBWVTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFZFOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgVk46ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFdGOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgRUg6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBZRTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgWk06ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBaVzogIkVVLUxvbmRvbiIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBvYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEdhID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgUyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIFViOwogICAgICAgICAgICAgICAgICAgIGMuY29ubmVjdCA9IGxiOwogICAgICAgICAgICAgICAgICAgIHZhciBJYSA9IDUwMCwKICAgICAgICAgICAgICAgICAgICAgICAgQ2MgPSAuODc1LAogICAgICAgICAgICAgICAgICAgICAgICBFYyA9IC43NSwKICAgICAgICAgICAgICAgICAgICAgICAgRmMgPSAuMjUsCiAgICAgICAgICAgICAgICAgICAgICAgIERjID0gLjEyNSwKICAgICAgICAgICAgICAgICAgICAgICAgVmIgPSAtMSwKICAgICAgICAgICAgICAgICAgICAgICAgV2IgPSAtMTsKICAgICAgICAgICAgICAgICAgICBjLnNlbmRNaXRvc2lzID0gZWI7CiAgICAgICAgICAgICAgICAgICAgYy5zZW5kRWplY3QgPSBKYjsKICAgICAgICAgICAgICAgICAgICBtLm5ldHdvcmtpbmcgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBhLmxvZ2luUmVhbG0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHRzogImdvb2dsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBGQjogImZhY2Vib29rIgogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnNlbmRNZXNzYWdlID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhLmJ5dGVWaWV3OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IFUoMSArIGEubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zZXRVaW50OCgwLCAxMDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGQubGVuZ3RoOyArK2MpIGEuc2V0VWludDgoMSArIGMsIGRbY10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kVG9rZW4oZCk7Ly9BR0FSQk9UT1ZICiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFYoYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIEggPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBNID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgVWEgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICByYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHFjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSAxRTMgLyA2MDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocWMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGQgLSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID4gYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gZCAtIGUgJSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IERhdGUubm93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFkYSgpIHx8IDI0MCA+IGcgLSBGYSB8fCAhbS5jb3JlLmNvbmZpZy5za2lwRHJhdyA/IFliKCkgOiBjb25zb2xlLndhcm4oIlNraXBwaW5nIGRyYXciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWmMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSAxRTMgLyBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJmcHMiLCBkLCByYykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgaGEgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgT2IgPSAicG9sYW5kO3VzYTtjaGluYTtydXNzaWE7Y2FuYWRhO2F1c3RyYWxpYTtzcGFpbjticmF6aWw7Z2VybWFueTt1a3JhaW5lO2ZyYW5jZTtzd2VkZW47Y2hhcGxpbjtub3J0aCBrb3JlYTtzb3V0aCBrb3JlYTtqYXBhbjt1bml0ZWQga2luZ2RvbTtlYXJ0aDtncmVlY2U7bGF0dmlhO2xpdGh1YW5pYTtlc3RvbmlhO2ZpbmxhbmQ7bm9yd2F5O2NpYTttYWxkaXZhczthdXN0cmlhO25pZ2VyaWE7cmVkZGl0O3lhcmFuYWlrYTtjb25mZWRlcmF0ZTs5Z2FnO2luZGlhbmE7NGNoYW47aXRhbHk7YnVsZ2FyaWE7dHVtYmxyOzJjaC5oaztob25nIGtvbmc7cG9ydHVnYWw7amFtYWljYTtnZXJtYW4gZW1waXJlO21leGljbztzYW5paztzd2l0emVybGFuZDtjcm9hdGlhO2NoaWxlO2luZG9uZXNpYTtiYW5nbGFkZXNoO3RoYWlsYW5kO2lyYW47aXJhcTtwZXJ1O21vb247Ym90c3dhbmE7Ym9zbmlhO25ldGhlcmxhbmRzO2V1cm9wZWFuIHVuaW9uO3RhaXdhbjtwYWtpc3RhbjtodW5nYXJ5O3NhdGFuaXN0O3FpbmcgZHluYXN0eTttYXRyaWFyY2h5O3BhdHJpYXJjaHk7ZmVtaW5pc207aXJlbGFuZDt0ZXhhcztmYWNlcHVuY2g7cHJvZG90YTtjYW1ib2RpYTtzdGVhbTtwaWNjb2xvO2VhO2luZGlhO2tjO2Rlbm1hcms7cXVlYmVjO2F5eSBsbWFvO3NlYWxhbmQ7YmFpdDt0c2FyaXN0IHJ1c3NpYTtvcmlnaW47dmluZXNhdWNlO3N0YWxpbjtiZWxnaXVtO2x1eGVtYm91cmc7c3R1c3N5O3BydXNzaWE7OGNoO2FyZ2VudGluYTtzY290bGFuZDtzaXI7cm9tYW5pYTt3b2phaztkb2dlO25hc2E7Ynl6YW50aXVtO2ltcGVyaWFsIGphcGFuO2ZyZW5jaCBraW5nZG9tO3NvbWFsaWE7dHVya2V5O21hcnM7cG9rZXJmYWNlOzg7aXJzO3JlY2VpdGEgZmVkZXJhbDtmYWNlYm9vaztwdXRpbjttZXJrZWw7dHNpcHJhcztvYmFtYTtraW0gam9uZy11bjtkaWxtYTtob2xsYW5kZTtiZXJsdXNjb25pO2NhbWVyb247Y2xpbnRvbjtoaWxsYXJ5O3ZlbmV6dWVsYTtibGF0dGVyO2NoYXZlejtjdWJhO2ZpZGVsO21lcmtlbDtwYWxpbjtxdWVlbjtib3JpcztidXNoO3RydW1wIi5zcGxpdCgiOyIpLAogICAgICAgICAgICAgICAgICAgICAgICAkYyA9ICI4O25hc2E7cHV0aW47bWVya2VsO3RzaXByYXM7b2JhbWE7a2ltIGpvbmctdW47ZGlsbWE7aG9sbGFuZGU7YmVybHVzY29uaTtjYW1lcm9uO2NsaW50b247aGlsbGFyeTtibGF0dGVyO2NoYXZlejtmaWRlbDttZXJrZWw7cGFsaW47cXVlZW47Ym9yaXM7YnVzaDt0cnVtcCIuc3BsaXQoIjsiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc2EgPSB7fTsKICAgICAgICAgICAgICAgICAgICBCYi5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGY6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGI6IDAKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBUYSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICAkYiA9ICExOwogICAgICAgICAgICAgICAgICAgIGNhLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGE6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGk6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIFM6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHM6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIG86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGphOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBrYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgTTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgTjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgSjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgSzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgZWE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHJhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBHOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgYzogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGg6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBWOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgZGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEM6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGlhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICB1YTogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIEk6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBjYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgQS5sZW5ndGg7IGErKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQVthXSA9PSB0aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEEuc3BsaWNlKGEsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBLW3RoaXMuaWRdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHEuaW5kZXhPZih0aGlzKTsgLTEgIT0gYSAmJiAoc2IgPSAhMCwgcS5zcGxpY2UoYSwgMSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IEUuaW5kZXhPZih0aGlzLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC0xICE9IGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFLnNwbGljZShhLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVNeUJhbGwodGhpcy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FHQVJCT1RPVkgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRyA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHRoaXMuZGEgJiYgYmEucHVzaCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgofn4oLjMgKiB0aGlzLnNpemUpLCAyNCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgQTogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPSBhKSBudWxsID09IHRoaXMuaSA/IHRoaXMuaSA9IG5ldyBWYSh0aGlzLm0oKSwgIiNGRkZGRkYiLCAhMCwgIiMwMDAwMDAiKSA6IHRoaXMuaS5QKHRoaXMubSgpKSwgdGhpcy5pLkIodGhpcy5uYW1lKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBiYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMuSCgpIDsgdGhpcy5hLmxlbmd0aCA+IGE7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB+fihNYXRoLnJhbmRvbSgpICogdGhpcy5hLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hLnNwbGljZShiLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICgwID09IHRoaXMuYS5sZW5ndGggJiYgMCA8IGEgJiYgdGhpcy5hLnB1c2gobmV3IEJiKHRoaXMsIHRoaXMueCwgdGhpcy55LCB0aGlzLnNpemUsIE1hdGgucmFuZG9tKCkgLSAuNSkpIDsgdGhpcy5hLmxlbmd0aCA8IGE7KSBiID0gfn4oTWF0aC5yYW5kb20oKSAqIHRoaXMuYS5sZW5ndGgpLCBiID0gdGhpcy5hW2JdLCB0aGlzLmEucHVzaChuZXcgQmIodGhpcywgYi54LCBiLnksIGIuZiwgYi5iKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgSDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIwID4gdGhpcy5zaXplICYmIChhID0gMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmMgJiYgKGEgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2l6ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYyB8fCAoYiAqPSBsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgKj0gTTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB+fk1hdGgubWF4KGIsIGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEJhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gdGhpcy5hLCBiID0gYS5sZW5ndGgsIGQgPSB0aGlzLCBjID0gdGhpcy5jID8gMCA6ICh0aGlzLmlkIC8gMUUzICsgeCAvIDFFNCkgJSAoMiAqIE1hdGguUEkpLCBlID0gMCwgcCA9IDA7IHAgPCBiOyArK3ApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGFbKHAgLSAxICsgYikgJSBiXS5iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gYVsocCArIDEpICUgYl0uYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGFbcF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5iICs9IChNYXRoLnJhbmRvbSgpIC0gLjUpICogKHRoaXMuaCA/IDMgOiAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmIgKj0gLjc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAgPCBoLmIgJiYgKGguYiA9IDEwKTsgLTEwID4gaC5iICYmIChoLmIgPSAtMTApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguYiA9IChmICsgayArIDggKiBoLmIpIC8gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBoLmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhWyhwIC0gMSArIGIpICUgYl0uZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IGFbKHAgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSkgJSBiXS5mOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxNSA8IHRoaXMuc2l6ZSAmJiBudWxsICE9IGlhICYmIDIwIDwgdGhpcy5zaXplICogbCAmJiAwIDwgdGhpcy5pZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgUWEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gPSBoLngsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gaC55OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpYS5FYShtIC0gNSwgcSAtIDUsIDEwLCAxMCwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuJCAhPSBkICYmIDI1ID4gKG0gLSBhLngpICogKG0gLSBhLngpICsgKHEgLSBhLnkpICogKHEgLSBhLnkpICYmIChRYSA9ICEwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIVFhICYmIChoLnggPCBNYSB8fCBoLnkgPCBOYSB8fCBoLnggPiBPYSB8fCBoLnkgPiBQYSkgJiYgKFFhID0gITApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBRYSAmJiAoMCA8IGguYiAmJiAoaC5iID0gMCksIC0taC5iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuICs9IGguYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwID4gbiAmJiAobiA9IDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmggPyAoMTkgKiBuICsgdGhpcy5zaXplKSAvIDIwIDogKDEyICogbiArIHRoaXMuc2l6ZSkgLyAxMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmYgPSAoZiArIGsgKyA4ICogbikgLyAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gMiAqIE1hdGguUEkgLyBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBoLmY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jICYmIDAgPT0gcCAlIDIgJiYgKGsgKz0gNSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC54ID0gdGhpcy54ICsgTWF0aC5jb3MoZiAqIHAgKyBjKSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC55ID0gdGhpcy55ICsgTWF0aC5zaW4oZiAqIHAgKyBjKSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IE1hdGgubWF4KGUsIGspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlhID0gZQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBuYTogZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuTSA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLk4gPSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5KID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuamEgPSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rYSA9IGIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgVDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPj0gdGhpcy5pZCkgcmV0dXJuIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGRiLnBhKCh4IC0gdGhpcy5VKSAvIDEyMCwgMCwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5HICYmIDEgPD0gYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYmEuaW5kZXhPZih0aGlzKTsgLTEgIT0gYiAmJiBiYS5zcGxpY2UoYiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IGEgKiAodGhpcy5qYSAtIHRoaXMucykgKyB0aGlzLnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBhICogKHRoaXMua2EgLSB0aGlzLnUpICsgdGhpcy51OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaXplID0gYSAqICh0aGlzLmcgLSB0aGlzLm8pICsgdGhpcy5vOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLjAxID4gTWF0aC5hYnModGhpcy5zaXplIC0gdGhpcy5nKSAmJiAodGhpcy5zaXplID0gdGhpcy5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwID49IHRoaXMuaWQgPyAhMCA6IHRoaXMueCArIHRoaXMuc2l6ZSArIDQwIDwgeSAtIHIgLyAyIC8gbCB8fCB0aGlzLnkgKyB0aGlzLnNpemUgKyA0MCA8IHogLSB0IC8gMiAvIGwgfHwgdGhpcy54IC0gdGhpcy5zaXplIC0gNDAgPiB5ICsgciAvIDIgLyBsIHx8IHRoaXMueSAtIHRoaXMuc2l6ZSAtIDQwID4geiArIHQgLyAyIC8gbCA/ICExIDogITAKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgcWE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5tb3ZlVG8odGhpcy5hWzBdLngsIHRoaXMuYVswXS55KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAxOyBkIDw9IGI7ICsrZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gZCAlIGI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lVG8odGhpcy5hW2NdLngsIHRoaXMuYVtjXS55KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5jbG9zZVBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdzogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLlIoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsrdGhpcy5kYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IDAgPCB0aGlzLmlkICYmICF0aGlzLmMgJiYgIXRoaXMuaCAmJiAuNCA+IGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSA+IHRoaXMuSCgpICYmIDAgPCB0aGlzLmlkICYmIChiID0gITApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLlYgJiYgIWIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgdGhpcy5hLmxlbmd0aDsgZCsrKSB0aGlzLmFbZF0uZiA9IHRoaXMuc2l6ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlYgPSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmEgPSB4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLlQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkcgJiYgKGEuZ2xvYmFsQWxwaGEgKj0gMSAtIGQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGluZVdpZHRoID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lQ2FwID0gInJvdW5kIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxpbmVKb2luID0gdGhpcy5jID8gIm1pdGVyIiA6ICJyb3VuZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0aGlzLmNvbG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oIHx8ICFhYiB8fCBxYiB8fCAoLTEgIT0gT2IuaW5kZXhPZihlKSA/IChoYS5oYXNPd25Qcm9wZXJ0eShlKSB8fCAoaGFbZV0gPSBuZXcgSW1hZ2UsIGhhW2VdLnNyYyA9IGMuQVNTRVRTX1JPT1QgKyAic2tpbnMvIiArIGUgKyAiLnBuZyIpLCBnID0gMCAhPSBoYVtlXS53aWR0aCAmJiBoYVtlXS5jb21wbGV0ZSA/IGhhW2VdIDogbnVsbCkgOiBnID0gbnVsbCwgbnVsbCAhPSBnID8gLTEgIT0gJGMuaW5kZXhPZihlKSAmJiAoZCA9ICEwKSA6ICh0aGlzLkkgJiYgIiVzdGFyYmFsbCIgPT0gdGhpcy5DICYmICJzaGVucm9uIiA9PSBlICYmIDcgPD0gcS5sZW5ndGggJiYgKCRiID0gZCA9ICEwLCBwID0gZWMoIiVzdGFyYmFsbDEiKSksIGcgPSBlYyh0aGlzLkMpLCBudWxsICE9IGcgJiYgKGggPSAhMCwgZiA9IE5jKHRoaXMuQykgfHwgZikpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgJiYgbS5kZWJ1Zy5zaG93UHJlZGljdGlvbiAmJiB0aGlzLkkgJiYgKGEuc3Ryb2tlU3R5bGUgPSAiIzAwMDBGRiIsIGEuYmVnaW5QYXRoKCksIGEuYXJjKHRoaXMuTSwgdGhpcy5OLCB0aGlzLnNpemUgKyA1LCAwLCAyICogTWF0aC5QSSwgITEpLCBhLmNsb3NlUGF0aCgpLCBhLnN0cm9rZSgpLCBhLnN0cm9rZVN0eWxlID0gIiMwMEZGMDAiLCBhLmJlZ2luUGF0aCgpLCBhLmFyYyh0aGlzLkosIHRoaXMuSywgdGhpcy5zaXplICsgNSwgMCwgMiAqIE1hdGguUEksICExKSwgYS5jbG9zZVBhdGgoKSwgYS5zdHJva2UoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGEgJiYgIXFiID8gKGEuZmlsbFN0eWxlID0gIiNGRkZGRkYiLCBhLnN0cm9rZVN0eWxlID0gIiNBQUFBQUEiKSA6IChhLmZpbGxTdHlsZSA9IGYsIGEuc3Ryb2tlU3R5bGUgPSBmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID8gKGEuYmVnaW5QYXRoKCksIGEuYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLnNpemUgKyA1LCAwLCAyICogTWF0aC5QSSwgITEpLCBhLmNsb3NlUGF0aCgpKSA6ICh0aGlzLkJhKCksIHRoaXMucWEoYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggfHwgYS5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBnICYmICh0aGlzLmxhKGEsIGcpLCBudWxsICE9IHAgJiYgdGhpcy5sYShhLCBwLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBNYXRoLnNpbiguMDE3NCAqIFRhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGEgfHwgMTUgPCB0aGlzLnNpemUpICYmICFiICYmIChhLnN0cm9rZVN0eWxlID0gIiMwMDAwMDAiLCBhLmdsb2JhbEFscGhhICo9IC4xLCBhLnN0cm9rZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gLTEgIT0gcS5pbmRleE9mKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB+fnRoaXMueTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwICE9IHRoaXMuaWQgJiYgKGZhIHx8IGUpICYmIHRoaXMubmFtZSAmJiB0aGlzLmkgJiYgIWQgJiYgKGcgPSB0aGlzLmksIGcuQih0aGlzLm5hbWUpLCBnLlAodGhpcy5tKCkpLCBkID0gMCA+PSB0aGlzLmlkID8gMSA6IE1hdGguY2VpbCgxMCAqIGwpIC8gMTAsIGcubWEoZCksIGcgPSBnLk8oKSwgcCA9IE1hdGguY2VpbChnLndpZHRoIC8gZCksIGYgPSBNYXRoLmNlaWwoZy5oZWlnaHQgLyBkKSwgYS5kcmF3SW1hZ2UoZywgfn50aGlzLnggLSB+fihwIC8gMiksIGIgLSB+fihmIC8gMiksIHAsIGYpLCBiICs9IGcuaGVpZ2h0IC8gMiAvIGQgKyA0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDwgdGhpcy5pZCAmJiBiYiAmJiAoZSB8fCAwID09IHEubGVuZ3RoICYmICghdGhpcy5jIHx8IHRoaXMuaCkgJiYgMjAgPCB0aGlzLnNpemUpICYmIChudWxsID09IHRoaXMuUyAmJiAodGhpcy5TID0gbmV3IFZhKHRoaXMubSgpIC8gMiwgIiNGRkZGRkYiLCAhMCwgIiMwMDAwMDAiKSksIGUgPSB0aGlzLlMsIGUuUCh0aGlzLm0oKSAvIDIpLCBlLkIofn4odGhpcy5zaXplICogdGhpcy5zaXplIC8gMTAwKSksIGQgPSBNYXRoLmNlaWwoMTAgKiBsKSAvIDEwLCBlLm1hKGQpLCBnID0gZS5PKCksIHAgPSBNYXRoLmNlaWwoZy53aWR0aCAvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQpLCBmID0gTWF0aC5jZWlsKGcuaGVpZ2h0IC8gZCksIGEuZHJhd0ltYWdlKGcsIH5+dGhpcy54IC0gfn4ocCAvIDIpLCBiIC0gfn4oZiAvIDIpLCBwLCBmKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5yZXN0b3JlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbGE6IGZ1bmN0aW9uIChhLCBiLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY2xpcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBNYXRoLm1heCh0aGlzLnNpemUsIHRoaXMuaWEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBkICYmIG51bGwgIT0gZC5hbHBoYSAmJiAoYS5nbG9iYWxBbHBoYSA9IGQuYWxwaGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5kcmF3SW1hZ2UoYiwgdGhpcy54IC0gYyAtIDUsIHRoaXMueSAtIGMgLSA1LCAyICogYyArIDEwLCAyICogYyArIDEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVzdG9yZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBkYiA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPCBiID8gYiA6IGEgPiBjID8gYyA6IGEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBhLmhhID0gZnVuY3Rpb24gKGEsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGIoLjUsIDAsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBlICogKGMgLSBhKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnBhID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgYS5maXhlZCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IE1hdGgucG93KDEwLCBiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB+fihhICogYykgLyBjCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgYy5NYXRocyA9IGRiOwogICAgICAgICAgICAgICAgICAgIHZhciBIYSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuTCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSwgYyA9IFthLmdldE1vbnRoKCkgKyAxLCBhLmdldERhdGUoKSwgYS5nZXRGdWxsWWVhcigpXSwgYSA9IFthLmdldEhvdXJzKCksIGEuZ2V0TWludXRlcygpLCBhLmdldFNlY29uZHMoKV0sIGUgPSAxOyAzID4gZTsgZSsrKSAxMCA+IGFbZV0gJiYgKGFbZV0gPSAiMCIgKyBhW2VdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiWyIgKyBjLmpvaW4oIi8iKSArICIgIiArIGEuam9pbigiOiIpICsgIl0iCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgYy5VdGlscyA9IEhhOwogICAgICAgICAgICAgICAgICAgIFZhLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgRjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFc6ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgWTogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIFo6ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgdjogMTYsCiAgICAgICAgICAgICAgICAgICAgICAgIGo6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIFg6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGw6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBEOiAxLAogICAgICAgICAgICAgICAgICAgICAgICBQOiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ICE9IGEgJiYgKHRoaXMudiA9IGEsIHRoaXMubCA9ICEwKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBtYTogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRCAhPSBhICYmICh0aGlzLkQgPSBhLCB0aGlzLmwgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgQjogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgIT0gdGhpcy5GICYmICh0aGlzLkYgPSBhLCB0aGlzLmwgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgTzogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmogJiYgKHRoaXMuaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpLCB0aGlzLlggPSB0aGlzLmouZ2V0Q29udGV4dCgiMmQiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLmosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLlgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLkYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLkQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSB0aGlzLnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBnICsgInB4IFVidW50dSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5mb250ID0gZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IH5+KC4yICogZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53aWR0aCA9IChiLm1lYXN1cmVUZXh0KGMpLndpZHRoICsgNikgKiBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuaGVpZ2h0ID0gKGcgKyBoKSAqIGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5mb250ID0gZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnNjYWxlKGUsIGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIubGluZVdpZHRoID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZVN0eWxlID0gdGhpcy5aOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gdGhpcy5XOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuWSAmJiBiLnN0cm9rZVRleHQoYywgMywgZyAtIGggLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGxUZXh0KGMsIDMsIGcgLSBoIC8gMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmoKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgRGF0ZS5ub3cgfHwgKERhdGUubm93ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBEYXRlKS5nZXRUaW1lKCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gWyJtcyIsICJtb3oiLCAid2Via2l0IiwgIm8iXSwgYiA9IDA7IGIgPCBhLmxlbmd0aCAmJiAhYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7ICsrYikgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBjW2FbYl0gKyAiUmVxdWVzdEFuaW1hdGlvbkZyYW1lIl0sIGMuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBjW2FbYl0gKyAiQ2FuY2VsQW5pbWF0aW9uRnJhbWUiXSB8fCBjW2FbYl0gKyAiQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIl07CiAgICAgICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IChjLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChhLCAxRTMgLyA2MCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwgYy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KSgpOwogICAgICAgICAgICAgICAgICAgIHZhciB2YyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPCBlICYmIChhID0gZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGYgJiYgKGEgPSBmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oKGEgLSBlKSAvIDMyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPCBnICYmIChhID0gZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGggJiYgKGEgPSBoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oKGEgLSBnKSAvIDMyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLnphLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBhLkFhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhLnhhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBhLnlhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSB+figoZiAtIGUpIC8gMzIpICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gfn4oKGggLSBnKSAvIDMyKSArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IEFycmF5KGsgKiBtKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoYS54KSArIGMoYS55KSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT0gbltlXSA/IG5bZV0gPSBhIDogQXJyYXkuaXNBcnJheShuW2VdKSA/IG5bZV0ucHVzaChhKSA6IG5bZV0gPSBbbltlXSwgYV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhOiBmdW5jdGlvbiAoYSwgZSwgZywgZiwgaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IGIoYSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gYyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGIoYSArIGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gYyhlICsgZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID4gcCB8fCBwID49IGsgfHwgMCA+IHUgfHwgdSA+PSBtKSBkZWJ1Z2dlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7IHUgPD0gZTsgKyt1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmID0gcDsgZiA8PSBhOyArK2YpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGcgPSBuW2YgKyB1ICoga10sIG51bGwgIT0gZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGcubGVuZ3RoOyBsKyspIGgoZ1tsXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaChnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFRiID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgY2EoMCwgMCwgMCwgMzIsICIjRUQxQzI0IiwgIiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIud2lkdGggPSAzMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuaGVpZ2h0ID0gMzI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGIuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHEubGVuZ3RoICYmIChhLmNvbG9yID0gcVswXS5jb2xvciwgYS5BKHFbMF0ubmFtZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuY2xlYXJSZWN0KDAsIDAsIDMyLCAzMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy50cmFuc2xhdGUoMTYsIDE2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnNjYWxlKC40LCAuNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53KGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMucmVzdG9yZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZhdmljb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IGUuY2xvbmVOb2RlKCEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNldEF0dHJpYnV0ZSgiaHJlZiIsIGIudG9EYXRhVVJMKCJpbWFnZS9wbmciKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChnLCBlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KCk7CiAgICAgICAgICAgICAgICAgICAgZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRiKCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB2YXIgV2EgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRQcm92aWRlcjogImZhY2Vib29rIiwKICAgICAgICAgICAgICAgICAgICAgICAgbG9naW5JbnRlbnQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2lhbFRva2VuOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5FeHBpcmVzOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwTmVlZGVkOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGljdHVyZTogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZWRJbjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29jaWFsSWQ6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBoID0gYy5kZWZhdWx0U3QgPSBXYTsKICAgICAgICAgICAgICAgICAgICBjLnN0b3JhZ2VJbmZvID0gaDsKICAgICAgICAgICAgICAgICAgICBjLmNyZWF0ZURlZmF1bHRTdG9yYWdlID0gUGM7CiAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlID0gWGE7CiAgICAgICAgICAgICAgICAgICAgZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvICYmIChoID0gSlNPTi5wYXJzZShjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8pKTsKICAgICAgICAgICAgICAgICAgICAgICAgIjEiID09IGgubG9naW5JbnRlbnQgJiYgZmMoaC5jb250ZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgIiIgPT0gaC51c2VySW5mby5uYW1lICYmICIiID09IGgudXNlckluZm8uZGlzcGxheU5hbWUgfHwgZ2MoaC51c2VySW5mbykKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjLmNoZWNrTG9naW5TdGF0dXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICIxIiA9PSBoLmxvZ2luSW50ZW50ICYmIChZYSgpLCBmYyhoLmNvbnRleHQpKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIFlhID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBjLk1DLnNldFByb2ZpbGVQaWN0dXJlKGgudXNlckluZm8ucGljdHVyZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuTUMuc2V0U29jaWFsSWQoaC51c2VySW5mby5zb2NpYWxJZCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMubG9nb3V0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBoID0gV2E7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm87CiAgICAgICAgICAgICAgICAgICAgICAgIGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyA9IEpTT04uc3RyaW5naWZ5KFdhKTsKICAgICAgICAgICAgICAgICAgICAgICAgWGEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2MoKTsKICAgICAgICAgICAgICAgICAgICAgICAgbS5jYWNoZS5zZW50R2FtZVNlcnZlckxvZ2luID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtLmNhY2hlLmxvZ2luX2luZm87CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtbG9nZ2VkLWluIiwgIjAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnRpbWVyIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNnUGx1c1NoYXJlIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjZmJTaGFyZSIpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3VzZXItaWQtdGFnIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIFEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5NQy5kb0xvZ291dCgpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnRvZ2dsZVNvY2lhbExvZ2luID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc29jaWFsTG9naW5Db250YWluZXIiKS50b2dnbGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NldHRpbmdzIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjaW5zdHJ1Y3Rpb25zIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBDYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnRvZ2dsZVNldHRpbmdzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc2V0dGluZ3MiKS50b2dnbGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NvY2lhbExvZ2luQ29udGFpbmVyIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjaW5zdHJ1Y3Rpb25zIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBDYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBtLmFjY291bnQgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKCkgeyB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgZ290IHVzZXIgbG9naW4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGYgfHwgZi5pZCAhPSBiLmlkKSBmID0gYiwgbnVsbCAhPSBjLnNzYV9qc29uICYmIChjLnNzYV9qc29uLmFwcGxpY2F0aW9uVXNlcklkID0gIiIgKyBiLmlkLCBjLnNzYV9qc29uLmN1c3RvbV91c2VyX2lkID0gIiIgKyBiLmlkKSwgInVuZGVmaW5lZCIgIT0gdHlwZW9mIFNTQV9DT1JFICYmIFNTQV9DT1JFLnN0YXJ0KCksIGUoIiNvZmZlcndhbGxJZnJhbWUiKS5hdHRyKCJzcmMiLCAiaHR0cDovL3d3dy5zdXBlcnNvbmljYWRzLmNvbS9kZWxpdmVyeS9wYW5lbC5waHA/YXBwbGljYXRpb25LZXk9IiArIEVudkNvbmZpZy5zdXBlcnNvbmljX2FwcF9rZXkgKyAiJmFwcGxpY2F0aW9uVXNlcklkPSIgKyBiLmlkICsgIiZjdXN0b21fdXNlcl9pZD0iICsgYi5pZCArICImYXBwbGljYXRpb25Vc2VySWRTaWduYXR1cmU9b3B0aW9uYWwiKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgYS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jb3JlLmJpbmQoInVzZXJfbG9naW4iLCBkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5iaW5kKCJ1c2VyX2xvZ291dCIsIGIpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuc2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2MoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zZXRBY2NvdW50RGF0YSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIsICIxIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnhwID0gYS54cDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ueHBOZWVkZWQgPSBhLnhwTmVlZGVkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC51c2VySW5mby5sZXZlbCA9IGEubGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBYYSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyAmJiBiID8gZ2EoYSkgOiAoZSgiLmFnYXJpby1wcm9maWxlLXBhbmVsIC5wcm9ncmVzcy1iYXItc3RhciIpLnRleHQoYS5sZXZlbCksIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KGEueHAgKyAiLyIgKyBhLnhwTmVlZGVkICsgIiBYUCIpLCBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhciIpLmNzcygid2lkdGgiLCAoODggKiBhLnhwIC8gYS54cE5lZWRlZCkudG9GaXhlZCgyKSArICIlIikpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuR2EgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KHt9KTsKICAgICAgICAgICAgICAgICAgICB2YXIgaWMgPSAwOwogICAgICAgICAgICAgICAgICAgIGMuZmJBc3luY0luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IGMuRkIgPyBhbGVydCgiWW91IHNlZW0gdG8gaGF2ZSBzb21ldGhpbmcgYmxvY2tpbmcgRmFjZWJvb2sgb24geW91ciBicm93c2VyLCBwbGVhc2UgY2hlY2sgZm9yIGFueSBleHRlbnNpb25zIikgOiAoaC5sb2dpbkludGVudCA9ICIxIiwgYy51cGRhdGVTdG9yYWdlKCksIGMuRkIubG9naW4oZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYyhhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAicHVibGljX3Byb2ZpbGUsIGVtYWlsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYy5GQi5pbml0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcElkOiBFbnZDb25maWcuZmJfYXBwX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhmYm1sOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAidjIuMiIKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICgiMSIgPT0gYy5zdG9yYWdlSW5mby5sb2dpbkludGVudCAmJiAiZmFjZWJvb2siID09IGMuc3RvcmFnZUluZm8uY29udGV4dCB8fCBuYykgJiYgYy5GQi5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbm5lY3RlZCIgPT09IGIuc3RhdHVzID8gaGMoYikgOiAibm90X2F1dGhvcml6ZWQiID09PSBiLnN0YXR1cyA/IChjLmxvZ291dCgpLCBhKCkpIDogYy5sb2dvdXQoKQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5mYWNlYm9va1JlbG9naW4gPSBhOwogICAgICAgICAgICAgICAgICAgICAgICBjLmZhY2Vib29rTG9naW4gPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgSGIgPSAhMTsKICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuYXN5bmMgPSAhMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc3JjID0gIi8vYXBpcy5nb29nbGUuY29tL2pzL2NsaWVudDpwbGF0Zm9ybS5qcz9vbmxvYWQ9Z2FwaUFzeW5jSW5pdCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSwgYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gITAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICBjLmdhcGlBc3luY0luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKGQpLnRyaWdnZXIoImluaXRpYWxpemVkIikKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5nb29nbGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhOiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS5jbGllbnQubG9hZCgicGx1cyIsICJ2MSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImZldGNoaW5nIG1lIHByb2ZpbGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FwaS5jbGllbnQucGx1cy5wZW9wbGUuZ2V0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogIm1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5leGVjdXRlKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5EYSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIHx8IGIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9PSB0eXBlb2YgZ2FwaSA/IGEoKSA6IGUoZCkuYmluZCgiaW5pdGlhbGl6ZWQiLCBhKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0pKG0pOwogICAgICAgICAgICAgICAgICAgIHZhciBhZCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5NQy5kb0xvZ2luV2l0aEdQbHVzKGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jYWNoZS5sb2dpbl9pbmZvID0gW2EsICJnb29nbGUiXQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQ6IEVudkNvbmZpZy5ncGx1c19jbGllbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llX3BvbGljeTogInNpbmdsZV9ob3N0X29yaWdpbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICJwcm9maWxlIGVtYWlsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5mYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9hOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gaCAmJiAiMSIgPT0gaC5sb2dpbkludGVudCAmJiAiZ29vZ2xlIiA9PSBoLmNvbnRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5EYShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS55dHN1YnNjcmliZS5nbygiYWdhcllvdXR1YmUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5nYXBpLmxvYWQoImF1dGgyIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGMuZ2FwaS5hdXRoMi5pbml0KGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5hdHRhY2hDbGlja0hhbmRsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdwbHVzTG9naW4iKSwge30sIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImdvb2dsZVVzZXIgOiAiICsgYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBsb2dpbiBpbiBnb29nbGUgcGx1czogIiwgSlNPTi5zdHJpbmdpZnkoYSwgdm9pZCAwLCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5jdXJyZW50VXNlci5saXN0ZW4oXy5iaW5kKGEuQ2EsIGEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgMSA9PSBmLmlzU2lnbmVkSW4uZ2V0KCkgJiYgZi5zaWduSW4oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2E6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYgJiYgYSAmJiBmLmlzU2lnbmVkSW4uZ2V0KCkgJiYgIUhiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhiID0gITA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgubG9naW5JbnRlbnQgPSAiMSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gYS5nZXRBdXRoUmVzcG9uc2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBlLmFjY2Vzc190b2tlbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5vYSA9IGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2dnZWRJbiB3aXRoIEcrISIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IGEuZ2V0QmFzaWNQcm9maWxlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBsLmdldEltYWdlVXJsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PSBhID8gbS5nb29nbGUuc2EoZSwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVzdWx0LmlzUGx1c1VzZXIgPyAoYSAmJiBkKGEuaW1hZ2UudXJsKSwgYihnKSwgYSAmJiAoaC51c2VySW5mby5waWN0dXJlID0gYS5pbWFnZS51cmwpLCBoLnVzZXJJbmZvLnNvY2lhbElkID0gbC5nZXRJZCgpLCBZYSgpKSA6IChhbGVydCgiUGxlYXNlIGFkZCBHb29nbGUrIHRvIHlvdXIgR29vZ2xlIGFjY291bnQgYW5kIHRyeSBhZ2Fpbi5cbk9yIHlvdSBjYW4gbG9naW4gd2l0aCBhbm90aGVyIGFjY291bnQuIiksIGMubG9nb3V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogKGQoYSksIGgudXNlckluZm8ucGljdHVyZSA9IGEsIGgudXNlckluZm8uc29jaWFsSWQgPSBsLmdldElkKCksIFlhKCksIGIoZykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmNvbnRleHQgPSAiZ29vZ2xlIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2E6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICYmIChmLnNpZ25PdXQoKSwgSGIgPSAhMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KG0pOwogICAgICAgICAgICAgICAgICAgIGMuZ3BsdXNNb2R1bGUgPSBhZDsKICAgICAgICAgICAgICAgICAgICB2YXIgc2MgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uZmEud2EoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5sb2dvdXRHb29nbGVQbHVzID0gc2M7CiAgICAgICAgICAgICAgICAgICAgdmFyIFpjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKGEsIGIsIGMsIGQsIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gYi5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBiLndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGIuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5jb2xvciA9IGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLkEoYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNpemUgPSBkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnRyYW5zbGF0ZShnIC8gMiwgYiAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53KGYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gbmV3IGNhKC0xLCAwLCAwLCAzMiwgIiM1YmMwZGUiLCAiIiksIGMgPSBuZXcgY2EoLTEsIDAsIDAsIDMyLCAiIzViYzBkZSIsICIiKSwgZiA9ICIjMDc5MWZmICM1YTA3ZmYgI2ZmMDdmZSAjZmZhNTA3ICNmZjA3NzQgIzA3N2ZmZiAjM2FmZjA3ICNmZjA3ZWQgIzA3YThmZiAjZmYwNzZlICMzZmZmMDcgI2ZmMDczNCAjMDdmZjIwICNmZjA3YTIgI2ZmODIwNyAjMDdmZjBlIi5zcGxpdCgiICIpLCBnID0gW10sIGggPSAwOyBoIDwgZi5sZW5ndGg7ICsraCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBoIC8gZi5sZW5ndGggKiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gMzAgKiBNYXRoLnNxcnQoaCAvIGYubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChuZXcgY2EoLTEsIE1hdGguY29zKGwpICogaywgTWF0aC5zaW4obCkgKiBrLCAxMCwgZltoXSwgIiIpKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIE9jKGcpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgICAgICBtLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG0ud2lkdGggPSBtLmhlaWdodCA9IDcwOwogICAgICAgICAgICAgICAgICAgICAgICBhKGMsIG0sICIiLCAyNiwgIiNlYmMwZGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5jZWxsLXNwaW5uZXIiKS5maWx0ZXIoIjp2aXNpYmxlIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBlKHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSB0aGlzLmhlaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHRoaXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmNsZWFyUmVjdCgwLCAwLCBmLCBnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnRyYW5zbGF0ZShmIC8gMiwgZyAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyAxMCA+IGs7ICsraykgaC5kcmF3SW1hZ2UobSwgKC4xICogZCArIDgwICogaykgJSAoZiArIDE0MCkgLSBmIC8gMiAtIDcwIC0gMzUsIGcgLyAyICogTWF0aC5zaW4oKC4wMDEgKiBkICsgaykgJSBNYXRoLlBJICogMikgLSAzNSwgNzAsIDcwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYyA9IGMuYXR0cigiZGF0YS1pdHIiKSkgJiYgKGMgPSBSKGMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhKGIsIHRoaXMsIGMgfHwgIiIsICtlKHRoaXMpLmF0dHIoImRhdGEtc2l6ZSIpLCAiIzViYzBkZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzdGF0c1BlbGxldHMiKS5maWx0ZXIoIjp2aXNpYmxlIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSh0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENvbnRleHQoIjJkIikuY2xlYXJSZWN0KDAsIDAsIGIsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCBnLmxlbmd0aDsgYisrKSBhKGdbYl0sIHRoaXMsICIiLCBnW2JdLnNpemUsIGdbYl0uY29sb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSgpOwogICAgICAgICAgICAgICAgICAgIGMuY3JlYXRlUGFydHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgICAgICAgICAgICAgUyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYigiLyMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnBhcnR5VG9rZW4iKS52YWwoImFnYXIuaW8vIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLXBhcnR5LXN0YXRlIiwgIjEiKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBRKCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuam9pblBhcnR5ID0gamM7CiAgICAgICAgICAgICAgICAgICAgYy5jYW5jZWxQYXJ0eSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgRGIoIi8iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGthKCIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgUSgpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgRiA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICB1YiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHZiID0gIiMwMDAwMDAiLAogICAgICAgICAgICAgICAgICAgICAgICBhYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBFYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBSYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEViID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgeGIgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB3YiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFcgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBaYSA9ICEwOwogICAgICAgICAgICAgICAgICAgIGMub25QbGF5ZXJEZWF0aCA9IEphOwogICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgRWEgJiYgRi5wdXNoKGFjKCkgLyAxMDApCiAgICAgICAgICAgICAgICAgICAgfSwgMUUzIC8gNjApOwogICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBSYygpOwogICAgICAgICAgICAgICAgICAgICAgICAwICE9IGEgJiYgKCsreGIsIDAgPT0gVyAmJiAoVyA9IGEpLCBXID0gTWF0aC5taW4oVywgYSkpCiAgICAgICAgICAgICAgICAgICAgfSwgMUUzKTsKICAgICAgICAgICAgICAgICAgICBjLmNsb3NlU3RhdHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFhID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzdGF0cyIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5kZXN0cm95QWQoYy5hZFNsb3RzLmFiKTsKICAgICAgICAgICAgICAgICAgICAgICAgeWEoMCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0U2tpcFN0YXRzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgWmEgPSAhYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5nZXRTdGF0c1N0cmluZyA9IGxjOwogICAgICAgICAgICAgICAgICAgIGMuZ1BsdXNTaGFyZSA9IFRjOwogICAgICAgICAgICAgICAgICAgIGMudHdpdHRlclNoYXJlU3RhdHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gYy5nZXRTdGF0c1N0cmluZygidHRfc2hhcmVfc3RhdHMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5vcGVuKCJodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC90d2VldD90ZXh0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSwgIkFnYXIuaW8iLCAid2lkdGg9NjYwLGhlaWdodD0zMTAsbWVudWJhcj1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT15ZXMsc2Nyb2xsYmFycz1ubyxsZWZ0PSIgKyAoYy5zY3JlZW5YICsgYy5pbm5lcldpZHRoIC8gMiAtIDMzMCkgKyAiLHRvcD0iICsgKGMuaW5uZXJIZWlnaHQgLSAzMTApIC8gMikKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuZmJTaGFyZVN0YXRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGMuZ2V0U3RhdHNTdHJpbmcoImZiX21hdGNocmVzdWx0c19zdWJ0aXRsZSIpOwogICAgICAgICAgICAgICAgICAgICAgICBjLkZCLnVpKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogImZlZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogImlmcmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBSKCJmYl9tYXRjaHJlc3VsdHNfdGl0bGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb246IFIoImZiX21hdGNocmVzdWx0c19kZXNjcmlwdGlvbiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiAiaHR0cDovL2FnYXIuaW8iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSmE6ICJodHRwOi8vc3RhdGljMi5taW5pY2xpcGNkbi5jb20vbW9iaWxlL2FnYXIvQWdhci5pb19tYXRjaHJlc3VsdHNfZmJfMTIwMHg2MzAucG5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInBsYXkgbm93ISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogImh0dHA6Ly9hZ2FyLmlvIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5maWxsU29jaWFsVmFsdWVzID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgMSA9PSBjLmlzQ2hyb21lICYmICJnb29nbGUiID09IGMuc3RvcmFnZUluZm8uY29udGV4dCAmJiBjLmdhcGkuaW50ZXJhY3RpdmVwb3N0LnJlbmRlcihiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50dXJsOiBFbnZDb25maWcuZ2FtZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRpZDogRW52Q29uZmlnLmdwbHVzX2NsaWVudF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXBvbGljeTogImh0dHA6Ly9hZ2FyLmlvIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpbGx0ZXh0OiBhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbHRvYWN0aW9ubGFiZWw6ICJCRUFUIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGx0b2FjdGlvbnVybDogRW52Q29uZmlnLmdhbWVfdXJsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIk1Bc3luY0luaXQiIGluIGMgJiYgYy5NQXN5bmNJbml0KCkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBPUklHSU5BTCBTQ1JJUFQKICAgICAgICAgICAgdmFyIHdpbmRvID0gYzsKICAgICAgICAgICAgdmFyIHN0b3BNb3ZlID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBhdXRvRmVlZEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgYXV0b1NwbGl0SW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBzZW5kQnVmZmVyID0gVjsKICAgICAgICAgICAgdmFyIHNlbmRWYWwgPSBYOwogICAgICAgICAgICAvL0FHQVJCT1RPVkggbW9kaWYgSWIgcG91ciBsYSBtw6l0aG9kZSBxdWkgZmFpdCBsZXMgb25rZXl1cCBvbmtleWRvd24KICAgICAgICAgICAgSWIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB3aW5kby5vbmtleXVwID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAzMiA9PSBhLmtleUNvZGUgJiYgKHZhID0gITEpOwogICAgICAgICAgICAgICAgICAgIDg3ID09IGEua2V5Q29kZSAmJiAoeGEgPSAhMSk7CiAgICAgICAgICAgICAgICAgICAgODEgPT0gYS5rZXlDb2RlICYmIHdhICYmIChYKDE5KSwgd2EgPSAhMSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdpbmRvLm9ua2V5ZG93biA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2tleURvd24nLCBhKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDY5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbWl0IHNwbGl0ICEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoJ3NwbGl0JywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA4MikgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZW1pdCBmZWVkICEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoJ2ZlZWQnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2xpZW50X3V1aWQiOiA4CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAzMiAhPSBhLmtleUNvZGUgfHwgdmEgfHwgKCJuaWNrIiAhPSBhLnRhcmdldC5pZCAmJiBhLnByZXZlbnREZWZhdWx0KCksIGViKCksIHZhID0gITApOwogICAgICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiAoWCgxOCksIHdhID0gITApOwogICAgICAgICAgICAgICAgICAgIDg3ICE9IGEua2V5Q29kZSB8fCB4YSB8fCAoSmIoKSwgeGEgPSAhMCk7CiAgICAgICAgICAgICAgICAgICAgMjcgPT0gYS5rZXlDb2RlICYmIChhLnByZXZlbnREZWZhdWx0KCksIHlhKDMwMCksIGUoIiNvZmVyd2FsbENvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VPZmZlcndhbGwoKSwgZSgiI3ZpZGVvQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgYy5jbG9zZVZpZGVvQ29udGFpbmVyKCkpCiAgICAgICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA4OCkgey8vIHgKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3gnLGJ0KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEuc2hpZnRLZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChidCAhPSB1bmRlZmluZWQgJiYgYnQucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuT1BFTikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgYWN0aW9uOiAxOSB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQgIT0gdW5kZWZpbmVkICYmIGJ0LnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IGFjdGlvbjogMTUgfSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gNjcpIHsvLyBjCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdjJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChidCAhPSB1bmRlZmluZWQgJiYgYnQucmVhZHlTdGF0ZSA9PSBXZWJTb2NrZXQuT1BFTikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoeyBhY3Rpb246IDE2IH0pKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSA4Nikgey8vIHYKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2MnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ0ICE9IHVuZGVmaW5lZCAmJiBidC5yZWFkeVN0YXRlID09IFdlYlNvY2tldC5PUEVOKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7IGFjdGlvbjogMTcgfSkpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDY2KSB7Ly8gYgogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnYycpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnQgIT0gdW5kZWZpbmVkICYmIGJ0LnJlYWR5U3RhdGUgPT0gV2ViU29ja2V0Lk9QRU4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KHsgYWN0aW9uOiAxOCB9KSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gODMgJiYgIm5pY2siICE9IGEudGFyZ2V0LmlkKSB7Ly8gcwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncycpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b0ZlZWRJbnRlcnZhbCA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvRmVlZEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRWYWwoMjEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9GZWVkSW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b0ZlZWRJbnRlcnZhbCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmtleUNvZGUgPT0gMzIgJiYgYS5zaGlmdEtleSAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpIHsvLyBzCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzcGFjZScpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbnVtYmVyID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dG9TcGxpdEludGVydmFsID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TcGxpdEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRWYWwoMTcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlcisrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudW1iZXIgPT0gNykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9TcGxpdEludGVydmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1NwbGl0SW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlciA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGF1dG9TcGxpdEludGVydmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9TcGxpdEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSA2OCAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpIHsvLyBECiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BNb3ZlID0gIXN0b3BNb3ZlOwogICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdTVE9QTU9WRScpOwogICAgICAgICAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgICAgICAgKiBjb25zb2xlLmxvZygnTHQnLEx0KTsgY29uc29sZS5sb2coJ0V0JyxFdCk7IGNvbnNvbGUubG9nKCdUdCcsVHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgKiBjb25zb2xlLmxvZygnd3QnLHd0KTsgY29uc29sZS5sb2coJ1B0JyxQdCk7IGNvbnNvbGUubG9nKCdDdCcsQ3QpOwogICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaCgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDY5ICYmICJuaWNrIiAhPSBhLnRhcmdldC5pZCkgey8vIEUKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiA1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSA3MCAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpIHsvLyBGCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHEpOy8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIGJ0ID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgaXAgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciByb29tID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgc29ja2V0ID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgb3BlblNvY2tldCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGJ0ICYmIGJ0LmNsb3NlKCk7CiAgICAgICAgICAgICAgICAvL2J0ID0gbmV3IFdlYlNvY2tldCgid3M6Ly9sb2NhbGhvc3Q6MTg0MSIpOwogICAgICAgICAgICAgICAgLy9idCA9IG5ldyBXZWJTb2NrZXQoIndzOi8vc2VydmVyLmFnYXJib3Qub3ZoOjkwIik7CiAgICAgICAgICAgICAgICBidCA9IG5ldyBXZWJTb2NrZXQoIndzOi8vMTc4LjI1NC4yMi43Mjo4MDgxIik7CiAgICAgICAgICAgICAgICBzb2NrZXQgPSBpby5jb25uZWN0KCd3czovLzE3OC4yNTQuMjIuNzI6ODA4MScpOwogICAgICAgICAgICAgICAgc29ja2V0Lm9uKCd0ZXN0JywgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbmljZSwgd29ya2luZycpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGJ0LmJpbmFyeVR5cGUgPSAiYXJyYXlidWZmZXIiOwogICAgICAgICAgICAgICAgYnQub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHh0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjaGFuZ2VHYW1lTW9kZSgpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGJ0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0QtQm90cy5jb20gOiBUSEUgU0VOVEVOQ0UgQkVGT1JFIElTIFRIRSBSRUFTT04gV0hZIFlPVSBIQVZFIFRST1VCTEVTIENPTk5FQ1RJTkcnLCBlLCAnY29ubmVjdGlvbiBlcnJvcicpOwogICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCdELUJvdHMuY29tIDogQ29ubmV4aW9uIGVycm9yLCBjaGVjayBGMTIgPiBjb25zb2xlIHRvIGhhdmUgbW9yZSBpbmZvcycpOwogICAgICAgICAgICAgICAgICAgIHNldFR4dChnZXRJbmZvcygpKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBidC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIGlmICh0LmRhdGEuc3RhcnRzV2l0aCgncGluZycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdC5kYXRhLnNwbGl0KCd8Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5waW5nID0gZGF0YVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaW5nJykgIT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BpbmcnKS5pbm5lckhUTUwgPSB3aW5kb3cucGluZzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoJ3BvbmcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0ID0gSlNPTi5wYXJzZSh0LmRhdGEpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sYXN0TWVzc2FnZSA9IHQ7CiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaCgpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGJ0Lm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dFQlNPQ0tFVCBUTyBCT1QgU0VSVkVSIENMT1NFRCcsICdjb2RlIDogJywgZS5jb2RlLCAncmVhc29uJywgZS5yZWFzb24pOwogICAgICAgICAgICAgICAgICAgIC8qdmFyIGluZm9zID0gZ2V0SW5mb3MoKTsKICAgICAgICAgICAgICAgICAgICBpZihpbmZvcy5jbG9zZU1lc3MgPT0gdW5kZWZpbmVkIHx8IGluZm9zLmNsb3NlTWVzcyA9PSB0cnVlKXsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW5mb3MoJ0Nvbm5lY3Rpb24gY2xvc2VkJyx0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VHh0KGdldEluZm9zKCkpOwogICAgICAgICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgICAgICAgIHh0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgc2VuZFRva2VuID0gZnVuY3Rpb24gKHVpbnRhcnJheSkgewogICAgICAgICAgICAgICAgaWYgKHh0KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc2VuZFRva2VuJywgdWludGFycmF5LCB1aW50YXJyYXkubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICBhID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigxICsgdWludGFycmF5Lmxlbmd0aCkpOwogICAgICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgMTAyKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IHVpbnRhcnJheS5sZW5ndGg7ICsrYykgYS5zZXRVaW50OCgxICsgYywgdWludGFycmF5W2NdKTsKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgY2hhbmdlR2FtZU1vZGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAoeHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHt9OwogICAgICAgICAgICAgICAgICAgIGUuYWN0aW9uID0gMTsKICAgICAgICAgICAgICAgICAgICAvL0FHQVJCT1RPVkggbmUgcGFzIG91YmxpZXIgY2hhbmdlciDDp2EKICAgICAgICAgICAgICAgICAgICBlLnRhcmdldFJlZ2lvbiA9IEcgKyBsYTsKICAgICAgICAgICAgICAgICAgICBlLnRhcmdldElwID0gaXA7CiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXRSb29tID0gcm9vbTsKCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbmRpbmcnLCBlKTsKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgeHQgPSBmYWxzZTsKICAgICAgICAgICAgb3BlblNvY2tldCgpOwogICAgICAgICAgICB2YXIgc2V0VHh0ID0gZnVuY3Rpb24gKGluZm9zKSB7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1pbmlvbnMiKSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd0aW1lb3V0JyxpbmZvcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFR4dChpbmZvcyk7CiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1pbmlvbnMiKS5pbm5lckhUTUwgPSBpbmZvcy50eHQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciBzZXRJbmZvcyA9IGZ1bmN0aW9uICh0eHQsIGNsb3NlTWVzcykgewogICAgICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dCIpOwogICAgICAgICAgICAgICAgaWYgKGVsID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIGVsLmlkID0gJ3R4dCc7CiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUuY3NzVGV4dCA9ICJkaXNwbGF5Om5vbmU7IjsKICAgICAgICAgICAgICAgICAgICBlbC5pbm5lclRleHQgPSBKU09OLnN0cmluZ2lmeSh7IHR4dDogJycsIGNsb3NlTWVzczogdHJ1ZSB9KTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKGVsLmlubmVyVGV4dCk7CiAgICAgICAgICAgICAgICBpZiAodHh0ICE9IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICBvYmoudHh0ID0gdHh0OwogICAgICAgICAgICAgICAgaWYgKGNsb3NlTWVzcyAhPSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgb2JqLmNsb3NlTWVzcyA9IGNsb3NlTWVzczsKICAgICAgICAgICAgICAgIGVsLmlubmVyVGV4dCA9IEpTT04uc3RyaW5naWZ5KG9iaik7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciBnZXRJbmZvcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0eHQiKTsKICAgICAgICAgICAgICAgIGlmIChlbCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBlbC5pZCA9ICd0eHQnOwogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmNzc1RleHQgPSAiZGlzcGxheTpub25lOyI7CiAgICAgICAgICAgICAgICAgICAgZWwuaW5uZXJUZXh0ID0gSlNPTi5zdHJpbmdpZnkoeyB0eHQ6ICcnLCBjbG9zZU1lc3M6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbC5pbm5lclRleHQpOwogICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZWwuaW5uZXJUZXh0KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdmFyIHJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgdCA9IHdpbmRvdy5sYXN0TWVzc2FnZTsKICAgICAgICAgICAgICAgIGlmICh0ID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICBpZiAocm9vbSAhPSB1bmRlZmluZWQgJiYgcm9vbS5sZW5ndGggPiAxMCkgewogICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCdCT1RTIE9OTFkgV09SSyBJTiBQQVJUWSBNT0RFJyk7CiAgICAgICAgICAgICAgICAgICAgc2V0VHh0KGdldEluZm9zKCkpOwogICAgICAgICAgICAgICAgICAgIHNob3dSZW1haW5pbmcoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodC5ub3BlKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0SW5mb3MoJzxhIGhyZWY9Imh0dHA6Ly9hZ2FyYm90Lm92aCIgdGFyZ2V0PSJfYmxhbmMiPk5vIHBsYW4gYWN0aXZlICZndDsgYWdhcmJvdC5vdmggKGRpZCB5b3UgcmVmcmVzaCBJUCA/KTwvYT4nLCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuYWxyZWFkeUNvbm5lY3RlZCkgewogICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCdBbHJlYWR5IG9uIGFub3RoZXIgZ2FtZSAocmVmcmVzaCBwYWdlKScsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5zcGVjaWFsICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzZXR0aW5nIHNwZWNpYWwnKTsKICAgICAgICAgICAgICAgICAgICBzZXRJbmZvcyh0LnNwZWNpYWwsIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmV4cGlyZSA9IHQuZXhwaXJlOwogICAgICAgICAgICAgICAgICAgIHZhciBleHBpcmUgPSBuZXcgRGF0ZSh0LmV4cGlyZSk7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2V4cGlyZSAnLHQuZXhwaXJlKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYm90c0F2YWlsYWJsZSA9IHQuYm90c0F2YWlsYWJsZTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWJvdHNBdmFpbGFibGUpCiAgICAgICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCdObyBib3RzIGF2YWlsYWJsZS4uLiByZXRyeWluZycpOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyByZWQgRkYzMzMzCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdyZWVuIDMzRkYzMwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHh0ID0gJ0JvdHMgJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuam9pbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5jdXJyZW50Qm90cyA9PSB0Lm1heEJvdHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3BhbiBzdHlsZT0iY29sb3I6IzMzRkYzMyI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxzcGFuPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gdC5jdXJyZW50Qm90cyArICIgLyAiICsgdC5tYXhCb3RzICsgJzwvc3Bhbj4nOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnd2FpdGluZyBmb3IgeW91IHRvIGNsaWNrIHBsYXknOwoKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcgLSBUaW1lIGxlZnQgPHNwYW4gaWQ9ImNvdW50ZG93biI+PC9zcGFuPic7CgogICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJyAtICc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnIFBpbmcgOiA8c3BhbiBpZD0icGluZyI+JyArICh3aW5kb3cucGluZyB8fCAnPycpICsgJzwvc3Bhbj4gPGJyLz4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dG9GZWVkSW50ZXJ2YWwgPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3BhbiBzdHlsZT0iY29sb3I6I0ZGMzMzMyI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc8c3BhbiBzdHlsZT0iY29sb3I6IzMzRkYzMyI+JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICdBVVRPLUZFRUQgKFMpPC9zcGFuPic7CgogICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJyAtICc7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcE1vdmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxzcGFuIHN0eWxlPSJjb2xvcjojMzNGRjMzIj4nOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxzcGFuIHN0eWxlPSJjb2xvcjojRkYzMzMzIj4nOwogICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJ1NUT1AtTU9WRSAoRCk8L3NwYW4+JzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmFsZ28gPT0gMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnIE1PREUgKEUpID0gPHNwYW4gc3R5bGU9ImNvbG9yOiMyRTlCQkYiPkVBVCBQRUxMRVRTPC9zcGFuPic7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHQuYWxnbyA9PSAyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcgTU9ERSAoRSkgPSA8c3BhbiBzdHlsZT0iY29sb3I6I0U4NjZFOCI+UlVOPC9zcGFuPic7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHQuYWxnbyA9PSAzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcgTU9ERSAoRSkgPSA8c3BhbiBzdHlsZT0iY29sb3I6IzQzREUyRiI+Q09NRSBUTyBNRUg8L3NwYW4+JzsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZXJjZW50ID0gKHQuZWF0cyAvIHQuc3Bhd25zICogMTAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKHBlcmNlbnQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudCA9IDA7CgogICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxiciAvPkVmZmljaWVuY3kgOiA8c3BhbiB0aXRsZT0iZWF0ZW4vc3Bhd25lZD1lZmZpY2llbmN5JSI+JyArIHQuZWF0cyArICcvJyArIHQuc3Bhd25zICsgJyAgPSAnICsgcGVyY2VudC50b0ZpeGVkKDIpICsgJyU8L3NwYW4+JzsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnBhcnR5RnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPGJyIC8+UGFydHkgcHJvYmFibHkgZnVsbCc7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQuam9pbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxiciAvPkpvaW4gdGhlIGdhbWUgYW5kIHRoZSBib3RzIHdpbGwgY29ubmVjdCAoJzsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm9vbSA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc/Pz8nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAocm9vbS5sZW5ndGggPCAxMCA/ICdQQVJUWScgOiAnRkZBIE5PVCBXT1JLSU5HJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcpJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICAgICAgICAgIHNldEluZm9zKCc8c3BhbiBzdHlsZT0iZm9udC1zaXplOiB4LXNtYWxsOyI+JyArIHR4dCArICc8L3NwYW4+Jyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2V0VHh0KGdldEluZm9zKCkpOwogICAgICAgICAgICAgICAgc2hvd1JlbWFpbmluZygpOwogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgX3NlY29uZCA9IDEwMDA7CiAgICAgICAgICAgIHZhciBfbWludXRlID0gX3NlY29uZCAqIDYwOwogICAgICAgICAgICB2YXIgX2hvdXIgPSBfbWludXRlICogNjA7CiAgICAgICAgICAgIHZhciBfZGF5ID0gX2hvdXIgKiAyNDsKICAgICAgICAgICAgZnVuY3Rpb24gc2hvd1JlbWFpbmluZygpIHsKICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykgPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuZXhwaXJlID09IHVuZGVmaW5lZCB8fCB3aW5kb3cuZXhwaXJlID09IDApCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBuZXcgRGF0ZSh3aW5kb3cuZXhwaXJlKSAtIG5vdzsKICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IDApIHsKICAgICAgICAgICAgICAgICAgICAvL2NsZWFySW50ZXJ2YWwodGltZXIpOwogICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1NFTkQgVEhJUyBUTyBORUVMJyxuZXcgRGF0ZSgpLG5vdyxuZXcgRGF0ZSh3aW5kb3cuZXhwaXJlKSxkaXN0YW5jZSk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCA9ICdFWFBJUkVEISc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGRheXMgPSBNYXRoLmZsb29yKGRpc3RhbmNlIC8gX2RheSk7CiAgICAgICAgICAgICAgICB2YXIgaG91cnMgPSBNYXRoLmZsb29yKChkaXN0YW5jZSAlIF9kYXkpIC8gX2hvdXIpOwogICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKChkaXN0YW5jZSAlIF9ob3VyKSAvIF9taW51dGUpOwogICAgICAgICAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKChkaXN0YW5jZSAlIF9taW51dGUpIC8gX3NlY29uZCk7CgogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCA9IGRheXMgKyAnZGF5cyAnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCArPSBob3VycyArICdocnMgJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgKz0gbWludXRlcyArICdtaW5zICc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MICs9IHNlY29uZHMgKyAnc2Vjcyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgey8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgICAgIHNob3dSZW1haW5pbmcoKTsKICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgIGZ1bmN0aW9uIGdvdE5ld0JhbGwoaWQpIHsKICAgICAgICAgICAgICAgIHZhciBiYWxsID0gbnVsbDsKICAgICAgICAgICAgICAgIGZvciAoaW5kZXggaW4gcSkgey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxCiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBxW2luZGV4XTsKICAgICAgICAgICAgICAgICAgICBpZiAoYi5pZCA9PSBpZCkgewogICAgICAgICAgICAgICAgICAgICAgICBiYWxsID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh4dCkKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAxMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkJzogaWQsCiAgICAgICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdORVdCQUxMJywgaWQsIGJhbGwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHJlbW92ZU15QmFsbChpZCkgewogICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IDEyLAogICAgICAgICAgICAgICAgICAgICAgICAnaWQnOiBpZCwKICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUkVNT1ZFIEJBTEwnLCBpZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gaGV4VG9SZ2IoaGV4KSB7CiAgICAgICAgICAgICAgICAvLyBFeHBhbmQgc2hvcnRoYW5kIGZvcm0gKGUuZy4gIjAzRiIpIHRvIGZ1bGwgZm9ybSAoZS5nLiAiMDAzM0ZGIikKICAgICAgICAgICAgICAgIHZhciBzaG9ydGhhbmRSZWdleCA9IC9eIz8oW2EtZlxkXSkoW2EtZlxkXSkoW2EtZlxkXSkkL2k7CiAgICAgICAgICAgICAgICBoZXggPSBoZXgucmVwbGFjZShzaG9ydGhhbmRSZWdleCwgZnVuY3Rpb24gKG0sIHIsIGcsIGIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gciArIHIgKyBnICsgZyArIGIgKyBiOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IC9eIz8oW2EtZlxkXXsyfSkoW2EtZlxkXXsyfSkoW2EtZlxkXXsyfSkkL2kuZXhlYyhoZXgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCA/IHsKICAgICAgICAgICAgICAgICAgICByOiBwYXJzZUludChyZXN1bHRbMV0sIDE2KSwKICAgICAgICAgICAgICAgICAgICBnOiBwYXJzZUludChyZXN1bHRbMl0sIDE2KSwKICAgICAgICAgICAgICAgICAgICBiOiBwYXJzZUludChyZXN1bHRbM10sIDE2KQogICAgICAgICAgICAgICAgfSA6IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbWFwQ29vcmRzKG1pbngsIG1pbnksIG1heHgsIG1heHkpIHsKICAgICAgICAgICAgICAgIHZhciBhYiA9IG5ldyBBcnJheUJ1ZmZlcigxNyk7CiAgICAgICAgICAgICAgICB2YXIgZHYgPSBuZXcgRGF0YVZpZXcoYWIpOwogICAgICAgICAgICAgICAgZHYuc2V0SW50OCgwLCAzKTsKICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIoMSwgbWlueCk7CiAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKDUsIG1pbnkpOwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMig5LCBtYXh4KTsKICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIoMTMsIG1heHkpOwogICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoYWIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBvZmZzZXRYID0gMDsKICAgICAgICAgICAgdmFyIG9mZnNldFkgPSAwOwogICAgICAgICAgICBmdW5jdGlvbiBtYXBDb29yZHMobWluX3gsIG1pbl95LCBtYXhfeCwgbWF4X3kpIHsKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ21hcCcsbWF4X3gtbWluX3gpOwogICAgICAgICAgICAgICAgaWYgKG1heF94IC0gbWluX3ggPiAxNDAwMCkgewogICAgICAgICAgICAgICAgICAgIG9mZnNldFggPSBtaW5feDsKICAgICAgICAgICAgICAgICAgICBvZmZzZXRZID0gbWluX3k7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gaGV5KGJ1ZiwgeCwgeSkgewogICAgICAgICAgICAgICAgaWYgKHN0b3BNb3ZlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1pZFggPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBtaWRZID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWluWCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1pblkgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXhYID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF4WSA9IDA7CiAgICAgICAgICAgICAgICAgICAgZm9yIChpbmRleCBpbiBxKSB7Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhbGwgPSBxW2luZGV4XTsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4WCA9IGJhbGwueDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblggPSBiYWxsLng7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhZID0gYmFsbC55OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluWSA9IGJhbGwueTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFggPSBNYXRoLm1heChtYXhYLCBiYWxsLngpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluWCA9IE1hdGgubWluKG1pblgsIGJhbGwueCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhZID0gTWF0aC5tYXgobWF4WSwgYmFsbC55KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblkgPSBNYXRoLm1pbihtaW5ZLCBiYWxsLnkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG1pZFggPSAobWluWCArIG1heFgpIC8gMjsKICAgICAgICAgICAgICAgICAgICBtaWRZID0gKG1pblkgKyBtYXhZKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3JlcGxhY2UnLHgseSwgJ3BhciAnLG1pZFgsbWlkWSk7CgogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRJbnQzMigxLCBtaWRYLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldEludDMyKDUsIG1pZFksICEwKTsKICAgICAgICAgICAgICAgICAgICBidWYuc2V0VWludDMyKDksIDAsICEwKTsKICAgICAgICAgICAgICAgICAgICBzZW5kQnVmZmVyKGJ1Zik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBidWYuc2V0SW50MzIoMSwgeCwgITApOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRJbnQzMig1LCB5LCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldFVpbnQzMig5LCAwLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgc2VuZEJ1ZmZlcihidWYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy9BR0FSQk9UT1ZIIGNoYW5nZXIgYXVzc2kgw6dhIHNpIG1lcCBkZSBzY3JpcHQKICAgICAgICAgICAgICAgIC8veCAvIHZhID0gKFggLSB0IC8gMikgLyBsICsgeTsKICAgICAgICAgICAgICAgIC8veSAvIHdhID0gKFkgLSB1IC8gMikgLyBsICsgegogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnQ0FMQ1VMIFggPSAnLFgsdCxsLHksJ3Rlc3QnLChYIC0gdCAvIDIpIC8gbCk7CiAgICAgICAgICAgICAgICB2YXIgYWIgPSBuZXcgQXJyYXlCdWZmZXIoMSArIDQgKyA0ICsgNCArIDQgKyBxLmxlbmd0aCAqIDQgKiA0ICsgMyk7CiAgICAgICAgICAgICAgICB2YXIgZHYgPSBuZXcgRGF0YVZpZXcoYWIpOwogICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7CiAgICAgICAgICAgICAgICBkdi5zZXRJbnQ4KG9mZnNldCwgMik7CiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIob2Zmc2V0LCB4IC0gb2Zmc2V0WCk7CiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIob2Zmc2V0LCB5IC0gb2Zmc2V0WSk7CiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKCiAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgncG9zJywgewogICAgICAgICAgICAgICAgICAgICd5JzogeSAtIG9mZnNldFksCiAgICAgICAgICAgICAgICAgICAgJ3gnOiB4IC0gb2Zmc2V0WCwKICAgICAgICAgICAgICAgICAgICAnY2xpZW50X3V1aWQnOiA4CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChmaXJzdCkgewogICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoInBhcnR5IiwgewogICAgICAgICAgICAgICAgICAgICAgICAiaXAiOiAid3M6Ly8iICsgYlswXSwKICAgICAgICAgICAgICAgICAgICAgICAgImNsaWVudF91dWlkIjogOCwKICAgICAgICAgICAgICAgICAgICAgICAgInBhc3N3b3JkIjogImRhdmlkIgogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2VtaXR0ZWQgcG9zOiB4IC0gJyArIHggKyAnICwgeSAtICcgKyB5KTsKICAgICAgICAgICAgICAgIC8qIE1hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgTmEgPSBhLmdldEZsb2F0NjQoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBPYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA4OwogICAgICAgICAgICAgICAgICAgIFBhID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgcGEgPSAoT2EgKyBNYSkgLyAyOwogICAgICAgICAgICAgICAgICAgIHFhID0gKFBhICsgTmEpIC8gMjsqLwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnQ0VOVEVSPycscGEscWEpOwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMihvZmZzZXQsIHBhKTsKICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgICAgICAgZHYuc2V0RmxvYXQzMihvZmZzZXQsIHFhKTsKICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwoKICAgICAgICAgICAgICAgIHZhciBiYWxsID0gcVswXTsKICAgICAgICAgICAgICAgIGlmIChiYWxsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmdiID0gaGV4VG9SZ2IoYmFsbC5jb2xvci5zdWJzdHIoMSkpOwogICAgICAgICAgICAgICAgICAgIHZhciBkZWNDb2xvciA9IChyZ2IuciA8PCAxNikgKyAocmdiLmcgPDwgOCkgKyByZ2IuYjsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdyZ2InLHJnYixkZWNDb2xvciwnYmFsbGlkJyxiYWxsLmlkKTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5yKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5nKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBkdi5zZXRVaW50OChvZmZzZXQsIHJnYi5iKTsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGluZGV4IGluIHEpIHsvL0FHQVJCT1RPVkggcGFzIG91YmxpZXIgbW9kaWYgcQogICAgICAgICAgICAgICAgICAgICAgICBiYWxsID0gcVtpbmRleF07Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICAgICAgZHYuc2V0VWludDMyKG9mZnNldCwgYmFsbC5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OwogICAgICAgICAgICAgICAgICAgICAgICBkdi5zZXRGbG9hdDMyKG9mZnNldCwgYmFsbC54KTsKICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGR2LnNldEZsb2F0MzIob2Zmc2V0LCBiYWxsLnkpOwogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgZHYuc2V0SW50MzIob2Zmc2V0LCBiYWxsLnNpemUpOwogICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY29sb3InLGJhbGwuY29sb3IpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgICAgICBidC5zZW5kKGFiKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdtb3VzZSBpbiAnLHgseSwndGVzdCcseC13aW5kb3cubWFwLm1pblgseS13aW5kb3cubWFwLm1pblksJ21hcCcsd2luZG93Lm1hcCk7CgogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgYmFzZVNldE5pY2sgPSB3aW5kby5zZXROaWNrOwogICAgICAgICAgICB3aW5kby5zZXROaWNrID0gZnVuY3Rpb24gKG4pIHsKICAgICAgICAgICAgICAgIGJhc2VTZXROaWNrKG4pOwogICAgICAgICAgICAgICAgaWYgKHh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICBlLmFjdGlvbiA9IDM7CiAgICAgICAgICAgICAgICAgICAgZS5wbGF5ZXJOYW1lID0gbjsKICAgICAgICAgICAgICAgICAgICBidC5zZW5kKEpTT04uc3RyaW5naWZ5KGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBFTkQgQ1VTVE9NCiAgICAgICAgfQoKCiAgICB9KSh3aW5kb3csIHdpbmRvdy5qUXVlcnkpOwo=';
var removed = false;

var d = function(a) {
	if (a.src.indexOf('main_out.js') >= 0) {
		window.ok = true;
		a.parentNode.removeChild(a);
		removed = true;
		console.log('AGARBOT - removed their script');
		var b = document.createElement('script');
		b.innerHTML = window.atob(engine);
		document.head.appendChild(b)
		console.log('AGARBOTDEBUG - added ours');
	}
};
var observer = new window.WebKitMutationObserver(function(b) {
	b.forEach(function(a) {
		for (var i = 0; i < a.addedNodes.length; ++i) {
			try {
				d(a.addedNodes[i]);
			} catch (e) {
			}
		}
	});
});
observer.observe(window.document, {
	subtree : true,
	childList : true,
	attribute : false
});
window.onload = function() {
	$("span[data-itr=option_show_mass]").prev()[0].checked = true;
	// setShowMass(true);
	var a = document.getElementById('gamemode').getElementsByTagName('option');
	if (a.length > 0) {
		for (var i = 0; i < a.length; i++) {
			if (a[i].getAttribute('data-itr') != 'party') {
				a[i].innerHTML += ' (Bots not working)';
			}
		}
	}
	if (!document.contains(document.getElementById('minions'))) {
		var b = document.createElement('div');
		b.id = 'minions';
		b.style.cssText = "position: absolute;top: 10px;left: 10px;padding: 0 8px;font-family: 'Ubuntu';color: green;background-color: rgba(55, 143, 206, 0.3);border-radius: 15px;z-index:9999";
		if (window.infos == undefined)
			window.infos = 'D-Bots.com : connecting... (try to refresh your page)';
		b.innerHTML = window.infos;
		document.body.appendChild(b);
		/*
		 * setTimeout(function(){ b.innerHTML = ''; },15000);
		 */
	}
	$("span[data-itr=instructions_w]")
			.append(
					'<br /><span style="font-size=xx-large;color:red;font-weight:bold">BOT INFO:</span><br />No plan active ? Check that you have correctly updated your IP ?<br />Press <b>C</b> to eject mass from your bot<br />Press <b>X</b> to split your bot (<b>Shift+X</b> fastSplit bots)<br />Press <b>S</b> to auto feed<br />Press <b>D</b> to stop moving<br />Press <b>Shift+space</b> to fast split<br />Features : Infinite zoom<br />')
			.append(
					'<span style="color:red">FFA WITH BOTS IS NOT WORKING</span><br />You need to enter the game for the bots to connect,if the bot isn\'t working try to refresh the page<br /><br /><a href="http://agarbot.ovh">AgarBot.ovh</a> Disclaimer : <br />Remember that we have no link of any sort with agar.io and the bots can suddenly stop working if agar.io update its game. We will try our best to have our bot solution working and we won\'t refund you if its not. If you encounter any problem come to our <a href="http://chat.agarbot.ovh" target="_blank">chat.agarbot.ovh</a>');
	$('#openfl-overlay').remove()
};

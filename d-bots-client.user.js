// ==UserScript==
// @name         d-bots-client
// @namespace    http://github.com/d-bots-client/
// @version      0.01
// @description  to be writen
// @author       David
// @license      
// @match        http://agar.io/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.4/socket.io.min.js
// @grant        none
// @run-at       document-start
// ==/UserScript==

//http://agar.io/img/background.png
var engine = 'CiAgICAoZnVuY3Rpb24gKGMsIGUpIHsKICAgICAgICB2YXIgaXBfY2xpZW50ID0gJyc7CiAgICAgICAgdmFyIGNvdW50ID0gMDsKICAgICAgICBmdW5jdGlvbiByZW1vdmVNeUJhbGwoaWQpIHsKICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgYnQuc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAxMiwKICAgICAgICAgICAgICAgICAgICAnaWQnOiBpZCwKICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1JFTU9WRSBCQUxMJywgaWQpOwogICAgICAgIH0KCgogICAgICAgIGZ1bmN0aW9uIHVhKGEsIGIpIHsKICAgICAgICAgICAgaWYgKGIpIHsKICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGU7CiAgICAgICAgICAgICAgICBkLnNldFRpbWUoZC5nZXRUaW1lKCkgKyA4NjRFNSAqIGIpOwogICAgICAgICAgICAgICAgZCA9ICI7IGV4cGlyZXM9IiArIGQudG9HTVRTdHJpbmcoKQogICAgICAgICAgICB9IGVsc2UgZCA9ICIiOwogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAiYWdhcmlvX3JlZGlyZWN0PSIgKyBhICsgZCArICI7IHBhdGg9LyIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHRjKCkgewogICAgICAgICAgICBmb3IgKHZhciBhID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCI7IiksIGIgPSAwOyBiIDwgYS5sZW5ndGg7IGIrKykgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IGFbYl07CiAgICAgICAgICAgICAgICAgICAgIiAiID09IGQuY2hhckF0KDApIDspIGQgPSBkLnN1YnN0cmluZygxLCBkLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBpZiAoMCA9PSBkLmluZGV4T2YoImFnYXJpb19yZWRpcmVjdD0iKSkgcmV0dXJuIGQuc3Vic3RyaW5nKDE2LCBkLmxlbmd0aCkKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSWIoKSB7CiAgICAgICAgICAgIGMub25rZXlkb3duID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSCBDRSBDT0RFIEEgUkFQQVRSSUVSIERBTlMgTk9UUkVLRVlET1dOCiAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDY5KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgc3BsaXQgISB3aXRoIGlwOiAnKTsKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDgyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VtaXQgZmVlZCAhd2l0aCBpcDogJyk7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgMzIgIT0gYS5rZXlDb2RlIHx8IHZhIHx8ICgibmljayIgIT0gYS50YXJnZXQuaWQgJiYgYS5wcmV2ZW50RGVmYXVsdCgpLCBlYigpLCB2YSA9ICEwKTsKICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiAoWCgxOCksIHdhID0gITApOwogICAgICAgICAgICAgICAgODcgIT0gYS5rZXlDb2RlIHx8IHhhIHx8IChKYigpLCB4YSA9ICEwKTsKICAgICAgICAgICAgICAgIDI3ID09IGEua2V5Q29kZSAmJiAoYS5wcmV2ZW50RGVmYXVsdCgpLCB5YSgzMDApLCBlKCIjb2ZlcndhbGxDb250YWluZXIiKS5pcygiOnZpc2libGUiKSAmJiBjLmNsb3NlT2ZmZXJ3YWxsKCksIGUoIiN2aWRlb0NvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VWaWRlb0NvbnRhaW5lcigpKQogICAgICAgICAgICB9OwogICAgICAgICAgICBjLm9ua2V5dXAgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgMzIgPT0gYS5rZXlDb2RlICYmICh2YSA9ICExKTsKICAgICAgICAgICAgICAgIDg3ID09IGEua2V5Q29kZSAmJiAoeGEgPSAhMSk7CiAgICAgICAgICAgICAgICA4MSA9PSBhLmtleUNvZGUgJiYgd2EgJiYgKFgoMTkpLCB3YSA9ICExKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBLYihhKSB7CiAgICAgICAgICAgIGEucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgLy8gQUdBUkJPVE9WSAogICAgICAgICAgICBQICo9IE1hdGgucG93KC45LCBhLndoZWVsRGVsdGEgLyAtMTIwIHx8IGEuZGV0YWlsIHx8IDApOwogICAgICAgICAgICBpZiAoMSA8IFApCiAgICAgICAgICAgICAgICBQID0gMTsKICAgICAgICAgICAgLyoKICAgICAgICAgICAgUCAqPSBNYXRoLnBvdyguOSwgYS53aGVlbERlbHRhIC8gLTEyMCB8fCBhLmRldGFpbCB8fCAwKTsKICAgICAgICAgICAgMSA+IFAgJiYgKFAgPSAxKTsKICAgICAgICAgICAgUCA+IDQgLyBsICYmIChQID0gNCAvIGwpKi8KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVjKCkgewogICAgICAgICAgICBpZiAoLjQgPiBsKSBpYSA9IG51bGw7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgYiA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgZCA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgYyA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgZyA9IDA7IGcgPCBBLmxlbmd0aDsgZysrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBBW2ddOwogICAgICAgICAgICAgICAgICAgICFlLlIoKSB8fCBlLlYgfHwgMjAgPj0gZS5zaXplICogbCB8fCAoYSA9IE1hdGgubWluKGUueCAtIGUuc2l6ZSwgYSksIGIgPSBNYXRoLm1pbihlLnkgLSBlLnNpemUsIGIpLCBkID0gTWF0aC5tYXgoZS54ICsgZS5zaXplLCBkKSwgYyA9IE1hdGgubWF4KGUueSArIGUuc2l6ZSwgYykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpYSA9IHZjLmluaXQoewogICAgICAgICAgICAgICAgICAgIHphOiBhIC0gMTAsCiAgICAgICAgICAgICAgICAgICAgQWE6IGIgLSAxMCwKICAgICAgICAgICAgICAgICAgICB4YTogZCArIDEwLAogICAgICAgICAgICAgICAgICAgIHlhOiBjICsgMTAsCiAgICAgICAgICAgICAgICAgICAgSGE6IDIsCiAgICAgICAgICAgICAgICAgICAgSWE6IDQKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZm9yIChnID0gMDsgZyA8IEEubGVuZ3RoOyBnKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKGUgPSBBW2ddLCBlLlIoKSAmJiAhKDIwID49IGUuc2l6ZSAqIGwpKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgZS5hLmxlbmd0aDsgKythKSBiID0gZS5hW2FdLngsIGQgPSBlLmFbYV0ueSwgYiA8IHkgLSByIC8gMiAvIGwgfHwgZCA8IHogLSB0IC8gMiAvIGwgfHwgYiA+IHkgKyByIC8gMiAvIGwgfHwgZCA+IHogKyB0IC8gMiAvIGwgfHwgaWEudGEoZS5hW2FdKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBmYigpIHsKICAgICAgICAgICAgemEgPSAoWSAtIHIgLyAyKSAvIGwgKyB5OwogICAgICAgICAgICBBYSA9IChaIC0gdCAvIDIpIC8gbCArIHoKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIExiKCkgewogICAgICAgICAgICBudWxsID09IEJhICYmIChCYSA9IHt9LCBlKCIjcmVnaW9uIikuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gZSh0aGlzKSwKICAgICAgICAgICAgICAgICAgICBiID0gYS52YWwoKTsKICAgICAgICAgICAgICAgIGIgJiYgKEJhW2JdID0gYS50ZXh0KCkpCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgZS5nZXQoQ2EgKyAiaW5mbyIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICB2YXIgYiA9IHt9LAogICAgICAgICAgICAgICAgICAgIGQ7CiAgICAgICAgICAgICAgICBmb3IgKGQgaW4gYS5yZWdpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBkLnNwbGl0KCI6IilbMF07CiAgICAgICAgICAgICAgICAgICAgYltjXSA9IGJbY10gfHwgMDsKICAgICAgICAgICAgICAgICAgICBiW2NdICs9IGEucmVnaW9uc1tkXS5udW1QbGF5ZXJzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKGQgaW4gYikgZSgnI3JlZ2lvbiBvcHRpb25bdmFsdWU9IicgKyBkICsgJyJdJykudGV4dChCYVtkXSArICIgKCIgKyBiW2RdICsgIiBwbGF5ZXJzKSIpCiAgICAgICAgICAgIH0sICJqc29uIikKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE1iKCkgewogICAgICAgICAgICBlKCIjYWRzQm90dG9tIikuaGlkZSgpOwogICAgICAgICAgICBlKCIjb3ZlcmxheXMiKS5oaWRlKCk7CiAgICAgICAgICAgIGUoIiNzdGF0cyIpLmhpZGUoKTsKICAgICAgICAgICAgZSgiI21haW5QYW5lbCIpLmhpZGUoKTsKICAgICAgICAgICAgYWEgPSBqYSA9ICExOwogICAgICAgICAgICBOYigpOwogICAgICAgICAgICBjLmRlc3Ryb3lBZChjLmFkU2xvdHMuYWEpOwogICAgICAgICAgICBjLmRlc3Ryb3lBZChjLmFkU2xvdHMuYWMpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBEYShhKSB7CiAgICAgICAgICAgIGEgJiYgKGEgPT0gRyA/IGUoIi5idG4tbmVlZHMtc2VydmVyIikucHJvcCgiZGlzYWJsZWQiLCAhMSkgOiAoZSgiI3JlZ2lvbiIpLnZhbCgpICE9IGEgJiYgZSgiI3JlZ2lvbiIpLnZhbChhKSwgRyA9IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uID0gYSwgZSgiLnJlZ2lvbi1tZXNzYWdlIikuaGlkZSgpLCBlKCIucmVnaW9uLW1lc3NhZ2UuIiArIGEpLnNob3coKSwgZSgiLmJ0bi1uZWVkcy1zZXJ2ZXIiKS5wcm9wKCJkaXNhYmxlZCIsICExKSwgZ2IgJiYgUSgpKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHlhKGEpIHsKICAgICAgICAgICAgamEgfHwgYWEgfHwgKEVhID8gZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITApIDogZSgiLmJ0bi1zcGVjdGF0ZSIpLnByb3AoImRpc2FibGVkIiwgITEpLCBOID0gbnVsbCwgaGIgfHwgKGUoIiNhZHNCb3R0b20iKS5zaG93KCksIGUoIiNnMzAweDI1MCIpLmhpZGUoKSwgZSgiI2EzMDB4MjUwIikuc2hvdygpLCBlKCIjZzcyOHg5MCIpLmhpZGUoKSwgZSgiI2E3Mjh4OTAiKS5zaG93KCkpLCBjLnJlZnJlc2hBZChoYiA/IGMuYWRTbG90cy5hYyA6IGMuYWRTbG90cy5hYSksIGhiID0gITEsIDFFMyA+IGEgJiYgKEIgPSAxKSwgamEgPSAhMCwgZSgiI21haW5QYW5lbCIpLnNob3coKSwgMCA8IGEgPyBlKCIjb3ZlcmxheXMiKS5mYWRlSW4oYSkgOiBlKCIjb3ZlcmxheXMiKS5zaG93KCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBrYShhKSB7CiAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtZ2FtZW1vZGUiLCBhKTsKICAgICAgICAgICAgbGEgPSBhOwogICAgICAgICAgICBlKCIjZ2FtZW1vZGUiKS52YWwoYSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE5iKCkgewogICAgICAgICAgICBlKCIjcmVnaW9uIikudmFsKCkgPyBjLmxvY2FsU3RvcmFnZS5sb2NhdGlvbiA9IGUoIiNyZWdpb24iKS52YWwoKSA6IGMubG9jYWxTdG9yYWdlLmxvY2F0aW9uICYmIGUoIiNyZWdpb24iKS52YWwoYy5sb2NhbFN0b3JhZ2UubG9jYXRpb24pOwogICAgICAgICAgICBlKCIjcmVnaW9uIikudmFsKCkgPyBlKCIjbG9jYXRpb25Lbm93biIpLmFwcGVuZChlKCIjcmVnaW9uIikpIDogZSgiI2xvY2F0aW9uVW5rbm93biIpLmFwcGVuZChlKCIjcmVnaW9uIikpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpYihhKSB7CiAgICAgICAgICAgICJlbnZfbG9jYWwiIGluIEVudkNvbmZpZyA/ICJ0cnVlIiA9PSBFbnZDb25maWcubG9hZF9sb2NhbF9jb25maWd1cmF0aW9uID8gYy5NQy51cGRhdGVDb25maWd1cmF0aW9uSUQoImJhc2UiKSA6IGMuTUMudXBkYXRlQ29uZmlndXJhdGlvbklEKEVudkNvbmZpZy5jb25maWdJRCkgOiBjLk1DLnVwZGF0ZUNvbmZpZ3VyYXRpb25JRChhKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gd2MoKSB7CiAgICAgICAgICAgICJjb25maWdJRCIgaW4gRCA/IGliKEQuY29uZmlnSUQpIDogZS5nZXQoQ2EgKyAiZ2V0TGF0ZXN0SUQiLCBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgaWIoYSk7CiAgICAgICAgICAgICAgICBjLmxvY2FsU3RvcmFnZS5sYXN0X2NvbmZpZ19pZCA9IGEKICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgICAgIGlmIChhID0gImxhc3RfY29uZmlnX2lkIiBpbiBjLmxvY2FsU3RvcmFnZSkgYSA9IGMubG9jYWxTdG9yYWdlLmxhc3RfY29uZmlnX2lkLCBhID0gIShudWxsID09IGEgfHwgdm9pZCAwID09IGEgfHwgIiIgPT09IGEpOwogICAgICAgICAgICAgICAgYSAmJiAoYSA9IGMubG9jYWxTdG9yYWdlLmxhc3RfY29uZmlnX2lkLCBjb25zb2xlLmxvZygiRmFsbGJhY2sgdG8gc3RvcmVkIGNvbmZpZ0lEOiAiICsgYSksIGliKGEpKQogICAgICAgICAgICB9KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24geGMoKSB7CiAgICAgICAgICAgIGUuZ2V0KGpiICsgIi8vZ2MuYWdhci5pbyIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICB2YXIgYiA9IGEuc3BsaXQoIiAiKTsKICAgICAgICAgICAgICAgIGEgPSBiWzBdOwogICAgICAgICAgICAgICAgYiA9IGJbMV0gfHwgIiI7IC0xID09IFsiVUEiXS5pbmRleE9mKGEpICYmIE9iLnB1c2goInVzc3IiKTsKICAgICAgICAgICAgICAgIG1hLmhhc093blByb3BlcnR5KGEpICYmICgic3RyaW5nIiA9PSB0eXBlb2YgbWFbYV0gPyBHIHx8IERhKG1hW2FdKSA6IG1hW2FdLmhhc093blByb3BlcnR5KGIpICYmIChHIHx8IERhKG1hW2FdW2JdKSkpCiAgICAgICAgICAgIH0sICJ0ZXh0IikKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFIoYSkgewogICAgICAgICAgICByZXR1cm4gYy5pMThuW2FdIHx8IGMuaTE4bl9kaWN0LmVuW2FdIHx8IGEKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFBiKCkgewogICAgICAgICAgICB2YXIgYSA9ICsra2I7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJGaW5kICIgKyBHICsgbGEpOwogICAgICAgICAgICBRYigpOwogICAgICAgICAgICBlLmFqYXgoQ2EgKyAiZmluZFNlcnZlciIsIHsKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkZhaWxlZCB0byBnZXQgc2VydmVyLiBXaWxsIHJldHJ5IGluIDMwIHNlY29uZHMiKTsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KFBiLCAzRTQpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PSBrYikgewogICAgICAgICAgICAgICAgICAgICAgICBiLmFsZXJ0ICYmIGFsZXJ0KGIuYWxlcnQpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGIuaXA7CiAgICAgICAgICAgICAgICAgICAgICAgICJnYW1lX3NlcnZlcl9wb3J0IiBpbiBFbnZDb25maWcgJiYgKGQgPSBjLmxvY2F0aW9uLmhvc3RuYW1lICsgIjoiICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVudkNvbmZpZy5nYW1lX3NlcnZlcl9wb3J0KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGIoIndzIiArIChtYiA/ICJzIiA6ICIiKSArICI6Ly8iICsgZCwgYi50b2tlbikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgY2FjaGU6ICExLAogICAgICAgICAgICAgICAgY3Jvc3NEb21haW46ICEwLAogICAgICAgICAgICAgICAgZGF0YTogKEcgKyBsYSB8fCAiPyIpICsgIlxuMTU0NjY5NjAzIgogICAgICAgICAgICB9KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUSgpIHsKICAgICAgICAgICAgZ2IgJiYgRyAmJiAoZSgiI2Nvbm5lY3RpbmciKS5zaG93KCksIFBiKCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBRYigpIHsKICAgICAgICAgICAgaWYgKHcpIHsKICAgICAgICAgICAgICAgIHcub25vcGVuID0gbnVsbDsKICAgICAgICAgICAgICAgIHcub25tZXNzYWdlID0gbnVsbDsKICAgICAgICAgICAgICAgIHcub25jbG9zZSA9IG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHcuY2xvc2UoKQogICAgICAgICAgICAgICAgfSBjYXRjaCAoYSkgeyB9CiAgICAgICAgICAgICAgICB3ID0gbnVsbAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBsYihhLCBiKSB7CiAgICAgICAgICAgIFFiKCk7CiAgICAgICAgICAgIEQuaXAgJiYgKGEgPSAid3MiICsgKG1iID8gInMiIDogIiIpICsgIjovLyIgKyBELmlwKTsKICAgICAgICAgICAgaWYgKG51bGwgIT0gUykgewogICAgICAgICAgICAgICAgdmFyIGQgPSBTOwogICAgICAgICAgICAgICAgUyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkKGIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1iICYmICFFbnZDb25maWcuZW52X2RldmVsb3BtZW50ICYmICFFbnZDb25maWcuZW52X2xvY2FsKSB7CiAgICAgICAgICAgICAgICB2YXIgYyA9IGEuc3BsaXQoIjoiKTsKICAgICAgICAgICAgICAgIGEgPSAid3NzOi8vaXAtIiArIGNbMV0ucmVwbGFjZSgvXC4vZywgIi0iKS5yZXBsYWNlKC9cLy9nLCAiIikgKyAiLnRlY2guYWdhci5pbzoiICsgK2NbMl0KICAgICAgICAgICAgfQogICAgICAgICAgICBFID0gW107CiAgICAgICAgICAgIHEgPSBbXTsKICAgICAgICAgICAgSyA9IHt9OwogICAgICAgICAgICBBID0gW107CiAgICAgICAgICAgIGJhID0gW107CiAgICAgICAgICAgIEMgPSBbXTsKICAgICAgICAgICAgSCA9IEkgPSBudWxsOwogICAgICAgICAgICBUID0gMDsKICAgICAgICAgICAgbmEgPSAhMTsKICAgICAgICAgICAgY29uc29sZS5sb2coIkNvbm5lY3RpbmcgdG8gIiArIGEpOwogICAgICAgICAgICBtLmNhY2hlLnNlbnRHYW1lU2VydmVyTG9naW4gPSAhMTsKICAgICAgICAgICAgdyA9IG5ldyBXZWJTb2NrZXQoYSk7CiAgICAgICAgICAgIHcuYmluYXJ5VHlwZSA9ICJhcnJheWJ1ZmZlciI7CiAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKICAgICAgICAgICAgaXAgPSBhOwogICAgICAgICAgICBpZiAoYi5sZW5ndGggPCA2KSB7CiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGVkKSB7CiAgICAgICAgICAgICAgICBiZ3ouc2VuZChKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgImFjdGlvbiI6IDEsCiAgICAgICAgICAgICAgICAgICAgInNlcnZlciI6IGEsCiAgICAgICAgICAgICAgICAgICAgImlwIiA6IGlwX2NsaWVudAogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgY291bnQgPSAwOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NFTkRFRCBQQVJUWSAhJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcm9vbSA9IGI7CiAgICAgICAgICAgIGNoYW5nZUdhbWVNb2RlKCk7CiAgICAgICAgICAgIHcub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICBGYSA9IHggPSBEYXRlLm5vdygpOwogICAgICAgICAgICAgICAgb2EgPSAxMjA7CiAgICAgICAgICAgICAgICBHYSA9IDA7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic29ja2V0IG9wZW4iKTsKICAgICAgICAgICAgICAgIGEgPSBVKDUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50OCgwLCAyNTQpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50MzIoMSwgNSwgITApOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIGEgPSBVKDUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50OCgwLCAyNTUpOwogICAgICAgICAgICAgICAgYS5zZXRVaW50MzIoMSwgMTU0NjY5NjAzLCAhMCk7CiAgICAgICAgICAgICAgICBWKGEpOwogICAgICAgICAgICAgICAgYSA9IFUoMSArIGIubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgODApOwogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBiLmxlbmd0aDsgKytkKSBhLnNldFVpbnQ4KGQgKyAxLCBiLmNoYXJDb2RlQXQoZCkpOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIG0uY29yZS5wcm94eS5vblNvY2tldE9wZW4oKQogICAgICAgICAgICB9OwogICAgICAgICAgICB3Lm9ubWVzc2FnZSA9IHljOwogICAgICAgICAgICB3Lm9uY2xvc2UgPSB6YzsKICAgICAgICAgICAgdy5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coSGEuTCgpICsgIiBzb2NrZXQgZXJyb3IiLCBhcmd1bWVudHMpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFUoYSkgewogICAgICAgICAgICByZXR1cm4gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcihhKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFYoYSkgewogICAgICAgICAgICB3LnNlbmQoYS5idWZmZXIpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB6YygpIHsKICAgICAgICAgICAgbmEgJiYgKElhID0gNTAwKTsKICAgICAgICAgICAgbS5jb3JlLnByb3h5Lm9uU29ja2V0Q2xvc2VkKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgc29ja2V0IGNsb3NlIik7CiAgICAgICAgICAgIHNldFRpbWVvdXQoUSwgSWEpOwogICAgICAgICAgICBJYSAqPSAyCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB5YyhhKSB7CiAgICAgICAgICAgIEFjKG5ldyBEYXRhVmlldyhhLmRhdGEpKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQWMoYSkgewogICAgICAgICAgICBmdW5jdGlvbiBiKCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9ICIiOyA7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLmdldFVpbnQxNihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSAyOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09IGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGIKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgZCA9IDA7CiAgICAgICAgICAgIGlmICgyNDAgPT0gYS5nZXRVaW50OChkKSkgSmEoKTsKICAgICAgICAgICAgZWxzZSBzd2l0Y2ggKGEuZ2V0VWludDgoZCsrKSkgewogICAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgICAgICBCYyhhLCBkKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICAgICAgcGEgPSBhLmdldEZsb2F0MzIoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBxYSA9IGEuZ2V0RmxvYXQzMihkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA0OwogICAgICAgICAgICAgICAgICAgIHJhID0gYS5nZXRGbG9hdDMyKGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgICAgIEUgPSBbXTsKICAgICAgICAgICAgICAgICAgICBxID0gW107CiAgICAgICAgICAgICAgICAgICAgSyA9IHt9OwogICAgICAgICAgICAgICAgICAgIEEgPSBbXTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICAgICAgcSA9IFtdOwogICAgICAgICAgICAgICAgICAgIEUgPSBbXTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICAgICAgbmIgPSBhLmdldEludDE2KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDI7CiAgICAgICAgICAgICAgICAgICAgb2IgPSBhLmdldEludDE2KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDI7CiAgICAgICAgICAgICAgICAgICAgcGIgfHwgKHBiID0gITAsIEthID0gbmIsIExhID0gb2IpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICAgICAgICBFLnB1c2goYS5nZXRVaW50MzIoZCwgITApKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDQ5OgogICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9IEkpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIHZhciB1ID0gYS5nZXRVaW50MzIoZCwgITApLAogICAgICAgICAgICAgICAgICAgICAgICBkID0gZCArIDQ7CiAgICAgICAgICAgICAgICAgICAgQyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGcgPSAwOyBnIDwgdTsgKytnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gYS5nZXRVaW50MzIoZCwgITApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGQgKyA0OwogICAgICAgICAgICAgICAgICAgICAgICBDLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBiKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIFJiKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDUwOgogICAgICAgICAgICAgICAgICAgIEkgPSBbXTsKICAgICAgICAgICAgICAgICAgICB1ID0gYS5nZXRVaW50MzIoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBmb3IgKGcgPSAwOyBnIDwgdTsgKytnKSBJLnB1c2goYS5nZXRGbG9hdDMyKGQsICEwKSksIGQgKz0gNDsKICAgICAgICAgICAgICAgICAgICBSYigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSA2NDoKICAgICAgICAgICAgICAgICAgICBNYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgZCArPSA4OwogICAgICAgICAgICAgICAgICAgIE5hID0gYS5nZXRGbG9hdDY0KGQsICEwKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgT2EgPSBhLmdldEZsb2F0NjQoZCwgITApOwogICAgICAgICAgICAgICAgICAgIGQgKz0gODsKICAgICAgICAgICAgICAgICAgICBQYSA9IGEuZ2V0RmxvYXQ2NChkLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgbWFwQ29vcmRzKE1hLCBOYSwgT2EsIFBhKTsKICAgICAgICAgICAgICAgICAgICBkICs9IDg7CiAgICAgICAgICAgICAgICAgICAgcGEgPSAoT2EgKyBNYSkgLyAyOwogICAgICAgICAgICAgICAgICAgIHFhID0gKFBhICsgTmEpIC8gMjsKICAgICAgICAgICAgICAgICAgICByYSA9IDE7CiAgICAgICAgICAgICAgICAgICAgMCA9PSBxLmxlbmd0aCAmJiAoeSA9IHBhLCB6ID0gcWEsIGwgPSByYSk7CiAgICAgICAgICAgICAgICAgICAgYS5ieXRlTGVuZ3RoID4gZCAmJiAodSA9IGEuZ2V0VWludDMyKGQsICEwKSwgZCArPSA0LCBxYiA9ICEhKHUgJiAxKSwgcmIgPSBiKCksIGMuTUMudXBkYXRlU2VydmVyVmVyc2lvbihyYiksIGNvbnNvbGUubG9nKCJTZXJ2ZXIgdmVyc2lvbiAiICsgcmIpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTAyOgogICAgICAgICAgICAgICAgICAgIHUgPSBhLmJ1ZmZlci5zbGljZShkKTsKICAgICAgICAgICAgICAgICAgICBtLmNvcmUucHJveHkuZm9yd2FyZFByb3RvTWVzc2FnZSh1KTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTA0OgogICAgICAgICAgICAgICAgICAgIGMubG9nb3V0KCkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQmMoYSwgYikgewogICAgICAgICAgICBmdW5jdGlvbiBkKCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9ICIiOyA7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLmdldFVpbnQxNihiLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYiArPSAyOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09CiAgICAgICAgICAgICAgICAgICAgICAgIGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gdSgpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAiIjsgOykgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5nZXRVaW50OChiKyspOwogICAgICAgICAgICAgICAgICAgIGlmICgwID09IGMpIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGQKICAgICAgICAgICAgfQogICAgICAgICAgICB4ID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgdmFyIGcgPSB4IC0gRmE7CiAgICAgICAgICAgIEZhID0geDsKICAgICAgICAgICAgb2EgPSBDYyAqIG9hICsgRGMgKiBnOwogICAgICAgICAgICBHYSA9IEVjICogR2EgKyBGYyAqIE1hdGguYWJzKGcgLSBvYSk7CiAgICAgICAgICAgIG0uY29yZS5kZWJ1ZyAmJiAobS5kZWJ1Zy51cGRhdGVDaGFydCgibmV0d29ya1VwZGF0ZSIsIHgsIGcpLCBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJydHRNZWFuIiwgeCwgb2EpLCBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJydHRTRGV2IiwgeCwgR2EpKTsKICAgICAgICAgICAgbmEgfHwgKG5hID0gITAsIGUoIiNjb25uZWN0aW5nIikuaGlkZSgpLCBTYigpLCBTICYmIChTKCksIFMgPSBudWxsKSk7CiAgICAgICAgICAgIHNiID0gITE7CiAgICAgICAgICAgIGcgPSBhLmdldFVpbnQxNihiLCAhMCk7CiAgICAgICAgICAgIGIgKz0gMjsKICAgICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBnOyArK3ApIHsKICAgICAgICAgICAgICAgIHZhciBMID0gS1thLmdldFVpbnQzMihiLCAhMCldLAogICAgICAgICAgICAgICAgICAgIGsgPSBLW2EuZ2V0VWludDMyKGIgKyA0LCAhMCldOwogICAgICAgICAgICAgICAgYiArPSA4OwogICAgICAgICAgICAgICAgTCAmJiBrICYmIChrLmNhKCksIGsucyA9IGsueCwgay51ID0gay55LCBrLm8gPSBrLnNpemUsIGsubmEoTC54LCBMLnkpLCBrLmcgPSBrLnNpemUsIGsuVSA9IHgsIEdjKEwsIGspKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAocCA9IDA7IDspIHsKICAgICAgICAgICAgICAgIGcgPSBhLmdldFVpbnQzMihiLCAhMCk7CiAgICAgICAgICAgICAgICBiICs9IDQ7CiAgICAgICAgICAgICAgICBpZiAoMCA9PSBnKSBicmVhazsKICAgICAgICAgICAgICAgICsrcDsKICAgICAgICAgICAgICAgIHZhciB0YiwgTCA9IGEuZ2V0SW50MzIoYiwgITApOwogICAgICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICAgICAgayA9IGEuZ2V0SW50MzIoYiwgITApOwogICAgICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICAgICAgdGIgPSBhLmdldEludDE2KGIsICEwKTsKICAgICAgICAgICAgICAgIGIgKz0gMjsKICAgICAgICAgICAgICAgIHZhciBuID0gYS5nZXRVaW50OChiKyspLAogICAgICAgICAgICAgICAgICAgIGYgPSBhLmdldFVpbnQ4KGIrKyksCiAgICAgICAgICAgICAgICAgICAgaCA9IGEuZ2V0VWludDgoYisrKSwKICAgICAgICAgICAgICAgICAgICBmID0gSGMobiA8PCAxNiB8IGYgPDwgOCB8IGgpLAogICAgICAgICAgICAgICAgICAgIGggPSBhLmdldFVpbnQ4KGIrKyksCiAgICAgICAgICAgICAgICAgICAgbCA9ICEhKGggJiAxKSwKICAgICAgICAgICAgICAgICAgICByID0gISEoaCAmIDE2KSwKICAgICAgICAgICAgICAgICAgICB0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGggJiAyICYmIChiICs9IDQgKyBhLmdldFVpbnQzMihiLCAhMCkpOwogICAgICAgICAgICAgICAgaCAmIDQgJiYgKHQgPSB1KCkpOwogICAgICAgICAgICAgICAgdmFyIHYgPSBkKCksCiAgICAgICAgICAgICAgICAgICAgbiA9IG51bGw7CiAgICAgICAgICAgICAgICBLLmhhc093blByb3BlcnR5KGcpID8gKG4gPSBLW2ddLCBuLlQoKSwgbi5zID0gbi54LCBuLnUgPSBuLnksIG4ubyA9IG4uc2l6ZSwgbi5jb2xvciA9IGYpIDogKG4gPSBuZXcgY2EoZywgTCwgaywgdGIsIGYsIHYpLCBBLnB1c2gobiksIEtbZ10gPSBuKTsKICAgICAgICAgICAgICAgIG4uYyA9IGw7CiAgICAgICAgICAgICAgICBuLmggPSByOwogICAgICAgICAgICAgICAgbi5uYShMLCBrKTsKICAgICAgICAgICAgICAgIG4uZyA9IHRiOwogICAgICAgICAgICAgICAgbi5VID0geDsKICAgICAgICAgICAgICAgIG4uZWEgPSBoOwogICAgICAgICAgICAgICAgdCAmJiAobi5DID0gdCk7CiAgICAgICAgICAgICAgICB2ICYmIG4uQSh2KTsgLTEgIT0gRS5pbmRleE9mKGcpICYmIC0xID09IHEuaW5kZXhPZihuKSAmJiAocS5wdXNoKG4pLCBuLkkgPSAhMCwgMSA9PSBxLmxlbmd0aCAmJiAobi51YSA9ICEwLCB5ID0gbi54LCB6ID0gbi55LCBUYigpLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgib3ZlcmxheXMiKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiLCBGID0gW10sIHViID0gMCwgdmIgPSBxWzBdLmNvbG9yLCBFYSA9ICEwLCBSYSA9IERhdGUubm93KCksIFcgPSB3YiA9IHhiID0gMCkpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgTCA9IGEuZ2V0VWludDMyKGIsICEwKTsKICAgICAgICAgICAgYiArPSA0OwogICAgICAgICAgICBmb3IgKHAgPSAwOyBwIDwgTDsgcCsrKSBnID0gYS5nZXRVaW50MzIoYiwgITApLCBiICs9IDQsIG4gPSBLW2ddLCBudWxsICE9IG4gJiYgbi5jYSgpOwogICAgICAgICAgICBzYiAmJiAwID09IHEubGVuZ3RoICYmICgwID09IGMuTUMuaXNVc2VyTG9nZ2VkSW4oKSA/IEphKCkgOiBVYiA9IHNldFRpbWVvdXQoSmEsIDJFMykpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBTYSgpIHsKICAgICAgICAgICAgaWYgKGRhKCkpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gWSAtIHIgLyAyLAogICAgICAgICAgICAgICAgICAgIGIgPSBaIC0gdCAvIDI7CgogICAgICAgICAgICAgICAgLy8gQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgaWYgKDY0ID4gYSAqIGEgKyBiICogYiB8fCAuMDEgPiBNYXRoLmFicyhWYiAtIHphKSAmJiAuMDEgPiBNYXRoLmFicyhXYiAtIEFhKSB8fCAoVmIgPSB6YSwgV2IgPSBBYSwgYSA9IFUoMTMpLCBhLnNldFVpbnQ4KDAsIDE2KSwgaGV5KGEsIHphLCBBYSksIHh0KSkgewoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIEFHQVJCT1RPVkgKCiAgICAgICAgICAgICAgICAvKiA2NCA+IGEgKiBhICsgYiAqIGIgfHwgLjAxID4gTWF0aC5hYnMoVmIgLQogICAgICAgICAgICAgICAgICAgICB6YSkgJiYgLjAxID4gTWF0aC5hYnMoV2IgLSBBYSkgfHwgKFZiID0gemEsIFdiID0gQWEsIGEgPSBVKDEzKSwgYS5zZXRVaW50OCgwLCAxNiksIGEuc2V0SW50MzIoMSwgemEsICEwKSwgYS5zZXRJbnQzMig1LCBBYSwgITApLCBhLnNldFVpbnQzMig5LCAwLCAhMCksIFYoYSkpCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBTYigpIHsKICAgICAgICAgICAgaWYgKGRhKCkgJiYgbmEgJiYgbnVsbCAhPSBOKSB7CiAgICAgICAgICAgICAgICB2YXIgYSA9IFUoMSArIDIgKiBOLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBzdG9wTW92ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvRmVlZEludGVydmFsKTsKICAgICAgICAgICAgICAgIGF1dG9GZWVkSW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICByZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAvLyBBR0FSQk9UT1ZICiAgICAgICAgICAgICAgICBhLnNldFVpbnQ4KDAsIDApOwogICAgICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBOLmxlbmd0aDsgKytiKSBhLnNldFVpbnQxNigxICsgMiAqIGIsIE4uY2hhckNvZGVBdChiKSwgITApOwogICAgICAgICAgICAgICAgVihhKTsKICAgICAgICAgICAgICAgIE4gPSBudWxsCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGViKCkgewogICAgICAgICAgICBTYSgpOwogICAgICAgICAgICBYKDE3KQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSmIoKSB7CiAgICAgICAgICAgIFNhKCk7CiAgICAgICAgICAgIFgoMjEpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkYSgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gdyAmJiB3LnJlYWR5U3RhdGUgPT0gdy5PUEVOCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBYKGEpIHsKICAgICAgICAgICAgaWYgKGRhKCkpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gVSgxKTsKICAgICAgICAgICAgICAgIGIuc2V0VWludDgoMCwgYSk7CiAgICAgICAgICAgICAgICBWKGIpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFhiKCkgewogICAgICAgICAgICByID0gMSAqIGMuaW5uZXJXaWR0aDsKICAgICAgICAgICAgdCA9IDEgKiBjLmlubmVySGVpZ2h0OwogICAgICAgICAgICB5Yi53aWR0aCA9IE8ud2lkdGggPSByOwogICAgICAgICAgICB5Yi5oZWlnaHQgPSBPLmhlaWdodCA9IHQ7CiAgICAgICAgICAgIHZhciBhID0gZSgiI2hlbGxvQ29udGFpbmVyIik7CiAgICAgICAgICAgIGEuY3NzKCJ0cmFuc2Zvcm0iLCAibm9uZSIpOwogICAgICAgICAgICB2YXIgYiA9IGEuaGVpZ2h0KCksCiAgICAgICAgICAgICAgICBkID0gYy5pbm5lckhlaWdodDsKICAgICAgICAgICAgMCAhPSBiIC8gMiAlIDIgJiYgKGIrKywgYS5oZWlnaHQoYikpOwogICAgICAgICAgICBiID4gZCAvIDEuMSA/IGEuY3NzKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKC01MCUsIC01MCUpIHNjYWxlKCIgKyBkIC8gYiAvIDEuMSArICIpIikgOiBhLmNzcygidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgtNTAlLCAtNTAlKSIpOwogICAgICAgICAgICBZYigpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBaYigpIHsKICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgIGEgPSAxICogTWF0aC5tYXgodCAvIDEwODAsIHIgLyAxOTIwKTsKICAgICAgICAgICAgcmV0dXJuIGEgKj0gUAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gSWMoKSB7CiAgICAgICAgICAgIGlmICgwICE9IHEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gMCwgYiA9IDA7IGIgPCBxLmxlbmd0aDsgYisrKSBhICs9IHFbYl0uc2l6ZTsKICAgICAgICAgICAgICAgIGwgPSAoOSAqIGwgKyBNYXRoLnBvdyhNYXRoLm1pbig2NCAvIGEsIDEpLCAuNCkgKiBaYigpKSAvIDEwCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFliKCkgewogICAgICAgICAgICB2YXIgYSwgYiA9IERhdGUubm93KCk7CiAgICAgICAgICAgICsrSmM7CiAgICAgICAgICAgICRiICYmICgrK1RhLCAxODAgPCBUYSAmJiAoVGEgPSAwKSk7CiAgICAgICAgICAgIHggPQogICAgICAgICAgICAgICAgYjsKICAgICAgICAgICAgaWYgKDAgPCBxLmxlbmd0aCkgewogICAgICAgICAgICAgICAgSWMoKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSBhID0gMCwgYyA9IDA7IGMgPCBxLmxlbmd0aDsgYysrKSBxW2NdLlQoKSwgYSArPSBxW2NdLnggLyBxLmxlbmd0aCwgZCArPSBxW2NdLnkgLyBxLmxlbmd0aDsKICAgICAgICAgICAgICAgIHBhID0gYTsKICAgICAgICAgICAgICAgIHFhID0gZDsKICAgICAgICAgICAgICAgIHJhID0gbDsKICAgICAgICAgICAgICAgIHkgPSAoeSArIGEpIC8gMjsKICAgICAgICAgICAgICAgIHogPSAoeiArIGQpIC8gMgogICAgICAgICAgICB9IGVsc2UgeSA9ICgyOSAqIHkgKyBwYSkgLyAzMCwgeiA9ICgyOSAqIHogKyBxYSkgLyAzMCwgbCA9ICg5ICogbCArIHJhICogWmIoKSkgLyAxMDsKICAgICAgICAgICAgdWMoKTsKICAgICAgICAgICAgZmIoKTsKICAgICAgICAgICAgemIgfHwgZi5jbGVhclJlY3QoMCwgMCwgciwgdCk7CiAgICAgICAgICAgIHpiID8gKGYuZmlsbFN0eWxlID0gZWEgPyAiIzExMTExMSIgOiAiI0YyRkJGRiIsIGYuZ2xvYmFsQWxwaGEgPSAuMDUsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCksIGYuZ2xvYmFsQWxwaGEgPSAxKSA6IEtjKCk7CiAgICAgICAgICAgIEEuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgcmV0dXJuIGEuc2l6ZSA9PSBiLnNpemUgPyBhLmlkIC0gYi5pZCA6IGEuc2l6ZSAtIGIuc2l6ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgIGYudHJhbnNsYXRlKHIgLyAyLCB0IC8gMik7CiAgICAgICAgICAgIGYuc2NhbGUobCwgbCk7CiAgICAgICAgICAgIGYudHJhbnNsYXRlKC15LCAteik7CiAgICAgICAgICAgIGZvciAoYyA9IDA7IGMgPCBiYS5sZW5ndGg7IGMrKykgYmFbY10udyhmKTsKICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8CiAgICAgICAgICAgICAgICBBLmxlbmd0aDsgYysrKSBBW2NdLncoZik7CiAgICAgICAgICAgIGlmIChwYikgewogICAgICAgICAgICAgICAgS2EgPSAoMyAqIEthICsgbmIpIC8gNDsKICAgICAgICAgICAgICAgIExhID0gKDMgKiBMYSArIG9iKSAvIDQ7CiAgICAgICAgICAgICAgICBmLnNhdmUoKTsKICAgICAgICAgICAgICAgIGYuc3Ryb2tlU3R5bGUgPSAiI0ZGQUFBQSI7CiAgICAgICAgICAgICAgICBmLmxpbmVXaWR0aCA9IDEwOwogICAgICAgICAgICAgICAgZi5saW5lQ2FwID0gInJvdW5kIjsKICAgICAgICAgICAgICAgIGYubGluZUpvaW4gPSAicm91bmQiOwogICAgICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IC41OwogICAgICAgICAgICAgICAgZi5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgIGZvciAoYyA9IDA7IGMgPCBxLmxlbmd0aDsgYysrKSBmLm1vdmVUbyhxW2NdLngsIHFbY10ueSksIGYubGluZVRvKEthLCBMYSk7CiAgICAgICAgICAgICAgICBmLnN0cm9rZSgpOwogICAgICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBmLnJlc3RvcmUoKTsKICAgICAgICAgICAgSCAmJiBILndpZHRoICYmIGYuZHJhd0ltYWdlKEgsIHIgLSBILndpZHRoIC0gMTAsIDEwKTsKICAgICAgICAgICAgVCA9IE1hdGgubWF4KFQsIGFjKCkpOwogICAgICAgICAgICAwICE9IFQgJiYgKG51bGwgPT0gVWEgJiYgKFVhID0gbmV3IFZhKDI0LCAiI0ZGRkZGRiIpKSwgVWEuQihSKCJzY29yZSIpICsgIjogIiArIH5+KFQgLyAxMDApKSwgZCA9IFVhLk8oKSwgYSA9IGQud2lkdGgsIGYuZ2xvYmFsQWxwaGEgPSAuMiwgZi5maWxsU3R5bGUgPSAiIzAwMDAwMCIsIGYuZmlsbFJlY3QoMTAsIHQgLSAxMCAtIDI0IC0gMTAsIGEgKyAxMCwgMzQpLAogICAgICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IDEsIGYuZHJhd0ltYWdlKGQsIDE1LCB0IC0gMTAgLSAyNCAtIDUpKTsKICAgICAgICAgICAgTGMoKTsKICAgICAgICAgICAgYiA9IERhdGUubm93KCkgLSBiOwogICAgICAgICAgICBiID4gMUUzIC8gNjAgPyBNIC09IC4wMSA6IGIgPCAxRTMgLyA2NSAmJiAoTSArPSAuMDEpOwogICAgICAgICAgICAuNCA+IE0gJiYgKE0gPSAuNCk7CiAgICAgICAgICAgIDEgPCBNICYmIChNID0gMSk7CiAgICAgICAgICAgIGIgPSB4IC0gYmM7CiAgICAgICAgICAgICFkYSgpIHx8IGphIHx8IGFhID8gKEIgKz0gYiAvIDJFMywgMSA8IEIgJiYgKEIgPSAxKSkgOiAoQiAtPSBiIC8gMzAwLCAwID4gQiAmJiAoQiA9IDApKTsKICAgICAgICAgICAgMCA8IEIgPyAoZi5maWxsU3R5bGUgPSAiIzAwMDAwMCIsIGNjID8gKGYuZ2xvYmFsQWxwaGEgPSBCLCBmLmZpbGxSZWN0KDAsIDAsIHIsIHQpLCBKLmNvbXBsZXRlICYmIEoud2lkdGggJiYgKEoud2lkdGggLyBKLmhlaWdodCA8IHIgLyB0ID8gKGIgPSByLCBhID0gSi5oZWlnaHQgKiByIC8gSi53aWR0aCkgOiAoYiA9IEoud2lkdGggKiB0IC8gSi5oZWlnaHQsIGEgPSB0KSwgZi5kcmF3SW1hZ2UoSiwgKHIgLSBiKSAvIDIsICh0IC0gYSkgLyAyLCBiLCBhKSwgZi5nbG9iYWxBbHBoYSA9IC41ICogQiwgZi5maWxsUmVjdCgwLCAwLCByLCB0KSkpIDogKGYuZ2xvYmFsQWxwaGEgPSAuNSAqIEIsIGYuZmlsbFJlY3QoMCwgMCwgciwgdCkpLCBmLmdsb2JhbEFscGhhID0gMSkgOiBjYyA9ICExOwogICAgICAgICAgICBiYyA9IHgKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEtjKCkgewogICAgICAgICAgICBmLmZpbGxTdHlsZSA9CiAgICAgICAgICAgICAgICBlYSA/ICIjMTExMTExIiA6ICIjRjJGQkZGIjsKICAgICAgICAgICAgZi5maWxsUmVjdCgwLCAwLCByLCB0KTsKICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgIGYuc3Ryb2tlU3R5bGUgPSBlYSA/ICIjQUFBQUFBIiA6ICIjMDAwMDAwIjsKICAgICAgICAgICAgZi5nbG9iYWxBbHBoYSA9IC4yICogbDsKICAgICAgICAgICAgZm9yICh2YXIgYSA9IHIgLyBsLCBiID0gdCAvIGwsIGQgPSAoLXkgKyBhIC8gMikgJSA1MDsgZCA8IGE7IGQgKz0gNTApIGYuYmVnaW5QYXRoKCksIGYubW92ZVRvKGQgKiBsIC0gLjUsIDApLCBmLmxpbmVUbyhkICogbCAtIC41LCBiICogbCksIGYuc3Ryb2tlKCk7CiAgICAgICAgICAgIGZvciAoZCA9ICgteiArIGIgLyAyKSAlIDUwOyBkIDwgYjsgZCArPSA1MCkgZi5iZWdpblBhdGgoKSwgZi5tb3ZlVG8oMCwgZCAqIGwgLSAuNSksIGYubGluZVRvKGEgKiBsLCBkICogbCAtIC41KSwgZi5zdHJva2UoKTsKICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIExjKCkgewogICAgICAgICAgICBpZiAoZGMgJiYgQWIud2lkdGgpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gciAvIDU7CiAgICAgICAgICAgICAgICBmLmRyYXdJbWFnZShBYiwgNSwgNSwgYSwgYSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYWMoKSB7CiAgICAgICAgICAgIGZvciAodmFyIGEgPSAwLCBiID0gMDsgYiA8IHEubGVuZ3RoOyBiKyspIGEgKz0gcVtiXS5nICogcVtiXS5nOwogICAgICAgICAgICByZXR1cm4gYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUmIoKSB7CiAgICAgICAgICAgIEggPSBudWxsOwogICAgICAgICAgICBpZiAobnVsbCAhPSBJIHx8IDAgIT0gQy5sZW5ndGgpCiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBJIHx8IGZhKSB7CiAgICAgICAgICAgICAgICAgICAgSCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgIHZhciBhID0gSC5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgICAgICBiID0gNjAsCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBudWxsID09IEkgPyBiICsgMjQgKiBDLmxlbmd0aCA6IGIgKyAxODAsCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBNYXRoLm1pbigyMDAsIC4zICogcikgLyAyMDA7CiAgICAgICAgICAgICAgICAgICAgSC53aWR0aCA9IDIwMCAqIGQ7CiAgICAgICAgICAgICAgICAgICAgSC5oZWlnaHQgPSBiICogZDsKICAgICAgICAgICAgICAgICAgICBhLnNjYWxlKGQsIGQpOwogICAgICAgICAgICAgICAgICAgIGEuZ2xvYmFsQWxwaGEgPSAuNDsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9ICIjMDAwMDAwIjsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxSZWN0KDAsIDAsIDIwMCwgYik7CiAgICAgICAgICAgICAgICAgICAgYS5nbG9iYWxBbHBoYSA9IDE7CiAgICAgICAgICAgICAgICAgICAgYS5maWxsU3R5bGUgPSAiI0ZGRkZGRiI7CiAgICAgICAgICAgICAgICAgICAgZCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgZCA9IFIoImxlYWRlcmJvYXJkIik7CiAgICAgICAgICAgICAgICAgICAgYS5mb250ID0gIjMwcHggVWJ1bnR1IjsKICAgICAgICAgICAgICAgICAgICBhLmZpbGxUZXh0KGQsIDEwMCAtIGEubWVhc3VyZVRleHQoZCkud2lkdGggLyAyLCA0MCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMsIGU7CiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gSSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChhLmZvbnQgPSAiMjBweCBVYnVudHUiLCBiID0gMDsgYiA8IEMubGVuZ3RoOyArK2IpIGQgPSBDW2JdLm5hbWUgfHwgUigidW5uYW1lZF9jZWxsIiksIGZhIHx8IChkID0gUigidW5uYW1lZF9jZWxsIikpLCAxID09IENbYl0uaWQgfHwgLTEgIT0gRS5pbmRleE9mKENbYl0uaWQpID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIChxWzBdLm5hbWUgJiYgKGQgPSBxWzBdLm5hbWUpLCBhLmZpbGxTdHlsZSA9ICIjRkZBQUFBIikgOiBhLmZpbGxTdHlsZSA9ICIjRkZGRkZGIiwgZCA9IGIgKyAxICsgIi4gIiArIGQsIGUgPSBhLm1lYXN1cmVUZXh0KGQpLndpZHRoLCBjID0gNzAgKyAyNCAqIGIsIDIwMCA8IGUgPyBhLmZpbGxUZXh0KGQsIDEwLCBjKSA6IGEuZmlsbFRleHQoZCwgKDIwMCAtIGUpIC8gMiwgYyk7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSBkID0gMDsgYiA8IEkubGVuZ3RoOyArK2IpIGMgPSBkICsgSVtiXSAqIE1hdGguUEkgKiAyLCBhLmZpbGxTdHlsZSA9IE1jW2IgKyAxXSwgYS5iZWdpblBhdGgoKSwgYS5tb3ZlVG8oMTAwLCAxNDApLCBhLmFyYygxMDAsIDE0MCwgODAsIGQsIGMsICExKSwgYS5maWxsKCksIGQgPSBjCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBOYyhhKSB7CiAgICAgICAgICAgIGlmIChudWxsID09IGEgfHwgMCA9PSBhLmxlbmd0aCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIGlmICgiJSIgPT0gYVswXSkgewogICAgICAgICAgICAgICAgaWYgKCFjLk1DIHx8ICFjLk1DLmdldFNraW5JbmZvKSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIGEgPSBjLk1DLmdldFNraW5JbmZvKCJza2luXyIgKyBhLnNsaWNlKDEpKTsKICAgICAgICAgICAgICAgIGlmIChudWxsID09IGEpIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgZm9yIChhID0gKCthLmNvbG9yKS50b1N0cmluZygxNikgOyA2ID4KICAgICAgICAgICAgICAgICAgICBhLmxlbmd0aDspIGEgPSAiMCIgKyBhOwogICAgICAgICAgICAgICAgcmV0dXJuICIjIiArIGEKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZWMoYSkgewogICAgICAgICAgICBpZiAobnVsbCA9PSBhIHx8IDAgPT0gYS5sZW5ndGgpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAoIXNhLmhhc093blByb3BlcnR5KGEpKSB7CiAgICAgICAgICAgICAgICB2YXIgYiA9IG5ldyBJbWFnZTsKICAgICAgICAgICAgICAgIGlmICgiOiIgPT0gYVswXSkgYi5zcmMgPSBhLnNsaWNlKDEpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoIiUiID09IGFbMF0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWMuTUMgfHwgIWMuTUMuZ2V0U2tpbkluZm8pIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBkID0gYy5NQy5nZXRTa2luSW5mbygic2tpbl8iICsgYS5zbGljZSgxKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgICAgYi5zcmMgPSBjLkFTU0VUU19ST09UICsgZC51cmwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNhW2FdID0gYgogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAwICE9IHNhW2FdLndpZHRoICYmIHNhW2FdLmNvbXBsZXRlID8gc2FbYV0gOiBudWxsCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBCYihhLCBiLCBkLCBjLCBlKSB7CiAgICAgICAgICAgIHRoaXMuJCA9IGE7CiAgICAgICAgICAgIHRoaXMueCA9IGI7CiAgICAgICAgICAgIHRoaXMueSA9IGQ7CiAgICAgICAgICAgIHRoaXMuZiA9IGM7CiAgICAgICAgICAgIHRoaXMuYiA9IGUKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGNhKGEsIGIsIGQsIGMsIGUsIHApIHsKICAgICAgICAgICAgdGhpcy5pZCA9IGE7CiAgICAgICAgICAgIHRoaXMucyA9IHRoaXMueCA9IHRoaXMuTSA9IHRoaXMuSiA9IGI7CiAgICAgICAgICAgIHRoaXMudSA9IHRoaXMueSA9IHRoaXMuTiA9IHRoaXMuSyA9IGQ7CiAgICAgICAgICAgIHRoaXMubyA9IHRoaXMuc2l6ZSA9IGM7CiAgICAgICAgICAgIHRoaXMuY29sb3IgPSBlOwogICAgICAgICAgICB0aGlzLmEgPSBbXTsKICAgICAgICAgICAgdGhpcy5iYSgpOwogICAgICAgICAgICB0aGlzLkEocCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEhjKGEpIHsKICAgICAgICAgICAgZm9yIChhID0gYS50b1N0cmluZygxNikgOyA2ID4gYS5sZW5ndGg7KSBhID0gIjAiICsgYTsKICAgICAgICAgICAgcmV0dXJuICIjIiArIGEKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFZhKGEsIGIsIGQsIGMpIHsKICAgICAgICAgICAgYSAmJiAodGhpcy52ID0gYSk7CiAgICAgICAgICAgIGIgJiYgKHRoaXMuVyA9IGIpOwogICAgICAgICAgICB0aGlzLlkgPSAhIWQ7CiAgICAgICAgICAgIGMgJiYgKHRoaXMuWiA9IGMpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBPYyhhKSB7CiAgICAgICAgICAgIGZvciAodmFyIGIgPSBhLmxlbmd0aCwgZCwgYzsgMCA8IGI7KSBjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYiksIGItLSwgZCA9IGFbYl0sIGFbYl0gPSBhW2NdLCBhW2NdID0gZAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUGMoKSB7CiAgICAgICAgICAgIGggPSBXYQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZmMoYSkgewogICAgICAgICAgICBoLmNvbnRleHQgPSAiZ29vZ2xlIiA9PSBhID8gImdvb2dsZSIgOiAiZmFjZWJvb2siOwogICAgICAgICAgICBYYSgpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBYYSgpIHsKICAgICAgICAgICAgYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvID0gSlNPTi5zdHJpbmdpZnkoaCk7CiAgICAgICAgICAgIGggPSBKU09OLnBhcnNlKGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyk7CiAgICAgICAgICAgIGMuc3RvcmFnZUluZm8gPSBoOwogICAgICAgICAgICAiZ29vZ2xlIiA9PSBoLmNvbnRleHQgPyAoZSgiI2dQbHVzU2hhcmUiKS5zaG93KCksIGUoIiNmYlNoYXJlIikuaGlkZSgpKSA6IChlKCIjZ1BsdXNTaGFyZSIpLmhpZGUoKSwgZSgiI2ZiU2hhcmUiKS5zaG93KCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnYyhhKSB7CiAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIpOwogICAgICAgICAgICAiIiAhPSBhLmRpc3BsYXlOYW1lICYmIChhLm5hbWUgPSBhLmRpc3BsYXlOYW1lKTsKICAgICAgICAgICAgaWYgKG51bGwgPT0gYS5uYW1lIHx8IHZvaWQgMCA9PSBhLm5hbWUpIGEubmFtZSA9ICIiOwogICAgICAgICAgICB2YXIgYiA9IGEubmFtZS5sYXN0SW5kZXhPZigiXyIpOyAtMSAhPSBiICYmIChhLm5hbWUgPSBhLm5hbWUuc3Vic3RyaW5nKDAsIGIpKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjEiKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1sb2dnZWQtaW4iLCAiMSIpOwogICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChhLmxldmVsKTsKICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXItdGV4dCIpLnRleHQoYS54cCArICIvIiArIGEueHBOZWVkZWQgKyAiIFhQIik7CiAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyIikuY3NzKCJ3aWR0aCIsICg4OCAqIGEueHAgLyBhLnhwTmVlZGVkKS50b0ZpeGVkKDIpICsgIiUiKTsKICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLW5hbWUiKS50ZXh0KGEubmFtZSk7CiAgICAgICAgICAgICIiICE9IGEucGljdHVyZSAmJiBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEucGljdHVyZSk7CiAgICAgICAgICAgIENiKCk7CiAgICAgICAgICAgIGgudXNlckluZm8ubGV2ZWwgPSBhLmxldmVsOwogICAgICAgICAgICBoLnVzZXJJbmZvLnhwID0gYS54cDsKICAgICAgICAgICAgaC51c2VySW5mby54cE5lZWRlZCA9IGEueHBOZWVkZWQ7CiAgICAgICAgICAgIGgudXNlckluZm8uZGlzcGxheU5hbWUgPSBhLm5hbWU7CiAgICAgICAgICAgIGgudXNlckluZm8ubG9nZ2VkSW4gPSAiMSI7CiAgICAgICAgICAgIGMudXBkYXRlU3RvcmFnZSgpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnYShhLCBiKSB7CiAgICAgICAgICAgIHZhciBkID0gYTsKICAgICAgICAgICAgaWYgKGgudXNlckluZm8ubG9nZ2VkSW4pIHsKICAgICAgICAgICAgICAgIHZhciB1ID0gZSgiI2hlbGxvQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgIjEiID09IGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIpOwogICAgICAgICAgICAgICAgaWYgKG51bGwgPT0gZCB8fCB2b2lkIDAgPT0gZCkgZCA9IGgudXNlckluZm87CiAgICAgICAgICAgICAgICBpZiAodSkgewogICAgICAgICAgICAgICAgICAgIHZhciBnID0gK2UoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS5maXJzdCgpLnRleHQoKS5zcGxpdCgiLyIpWzBdLAogICAgICAgICAgICAgICAgICAgICAgICB1ID0gK2UoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS5maXJzdCgpLnRleHQoKS5zcGxpdCgiLyIpWzFdLnNwbGl0KCIgIilbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikuZmlyc3QoKS50ZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHAgIT0gZC5sZXZlbCkgZ2EoewogICAgICAgICAgICAgICAgICAgICAgICB4cDogdSwKICAgICAgICAgICAgICAgICAgICAgICAgeHBOZWVkZWQ6IHUsCiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBwCiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGFuZWwgLnByb2dyZXNzLWJhci1zdGFyIikudGV4dChkLmxldmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1leHAtYmFyIC5wcm9ncmVzcy1iYXIiKS5jc3MoIndpZHRoIiwgIjEwMCUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnByb2dyZXNzLWJhci1zdGFyIikuYWRkQ2xhc3MoImFuaW1hdGVkIHRhZGEiKS5vbmUoIndlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIucHJvZ3Jlc3MtYmFyLXN0YXIiKS5yZW1vdmVDbGFzcygiYW5pbWF0ZWQgdGFkYSIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KGQueHBOZWVkZWQgKyAiLyIgKyBkLnhwTmVlZGVkICsgIiBYUCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwTmVlZGVkOiBkLnhwTmVlZGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBkLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDFFMykKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gKERhdGUubm93KCkgLSBmKSAvIDFFMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gMCA+IGEgPyAwIDogMSA8IGEgPyAxIDogYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gYSAqIGEgKiAoMyAtIDIgKiBhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhci10ZXh0IikudGV4dCh+fihnICsgKGQueHAgLSBnKSAqIGEpICsgIi8iICsgZC54cE5lZWRlZCArICIgWFAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhciIpLmNzcygid2lkdGgiLCAoODggKiAoZyArIChkLnhwIC0gZykgKiBhKSAvIGQueHBOZWVkZWQpLnRvRml4ZWQoMikgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgYigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEgPiBhICYmIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBjLnJlcXVlc3RBbmltYXRpb25GcmFtZShrKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQ2IoKSB7CiAgICAgICAgICAgIHZhciBhOwogICAgICAgICAgICAoInVuZGVmaW5lZCIgIT09IHR5cGVvZiBhICYmIGEgfHwgIm5vbmUiID09IGUoIiNzZXR0aW5ncyIpLmNzcygiZGlzcGxheSIpICYmICJub25lIiA9PSBlKCIjc29jaWFsTG9naW5Db250YWluZXIiKS5jc3MoImRpc3BsYXkiKSkgJiYgZSgiI2luc3RydWN0aW9ucyIpLnNob3coKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaGMoYSkgewogICAgICAgICAgICBpZiAoImNvbm5lY3RlZCIgPT0gYS5zdGF0dXMpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gYS5hdXRoUmVzcG9uc2UuYWNjZXNzVG9rZW47CiAgICAgICAgICAgICAgICBudWxsID09IGIgfHwgInVuZGVmaW5lZCIgPT0gYiB8fCAiIiA9PSBiID8gKDMgPiBpYyAmJiAoaWMrKywgYy5mYWNlYm9va1JlbG9naW4oKSksIGMubG9nb3V0KCkpIDogKGMuTUMuZG9Mb2dpbldpdGhGQihiKSwgbS5jYWNoZS5sb2dpbl9pbmZvID0gW2IsICJmYWNlYm9vayJdLCBjLkZCLmFwaSgiL21lL3BpY3R1cmU/d2lkdGg9MTgwJmhlaWdodD0xODAiLCBmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGIuZGF0YS51cmw7CiAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgZSgiLmFnYXJpby1wcm9maWxlLXBpY3R1cmUiKS5hdHRyKCJzcmMiLCBiLmRhdGEudXJsKTsKICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnNvY2lhbElkID0gYS5hdXRoUmVzcG9uc2UudXNlcklEOwogICAgICAgICAgICAgICAgICAgIFlhKCkKICAgICAgICAgICAgICAgIH0pLCBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLWxvZ2dlZC1pbiIsICIxIiksIGguY29udGV4dCA9ICJmYWNlYm9vayIsIGgubG9naW5JbnRlbnQgPSAiMSIsIGMudXBkYXRlU3RvcmFnZSgpKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBqYyhhKSB7CiAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI0Iik7CiAgICAgICAgICAgIGEgPSBkZWNvZGVVUklDb21wb25lbnQoYSkucmVwbGFjZSgvLiojL2dpbSwgIiIpOwogICAgICAgICAgICBEYigiIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7CiAgICAgICAgICAgIGUuYWpheChDYSArICJnZXRUb2tlbiIsIHsKICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICI2IikKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgIGIgPSBiLnNwbGl0KCJcbiIpOwogICAgICAgICAgICAgICAgICAgIGUoIi5wYXJ0eVRva2VuIikudmFsKCJhZ2FyLmlvLyMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOwogICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtcGFydHktc3RhdGUiLCAiNSIpOwogICAgICAgICAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgICAgICAgICBsYigid3M6Ly8iICsgYlswXSwgYSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBkYXRhVHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBjYWNoZTogITEsCiAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogITAsCiAgICAgICAgICAgICAgICBkYXRhOiBhCiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBEYihhKSB7CiAgICAgICAgICAgIGMuaGlzdG9yeSAmJiBjLmhpc3RvcnkucmVwbGFjZVN0YXRlICYmIGMuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIGMuZG9jdW1lbnQudGl0bGUsIGEpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBKYSgpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KFViKTsKICAgICAgICAgICAgbnVsbCA9PSBjLnN0b3JhZ2VJbmZvICYmIGMuY3JlYXRlRGVmYXVsdFN0b3JhZ2UoKTsKICAgICAgICAgICAgRWIgPSBEYXRlLm5vdygpOwogICAgICAgICAgICAwID49IFJhICYmIChSYSA9IEViKTsKICAgICAgICAgICAgRWEgPSAhMTsKICAgICAgICAgICAgUWMoKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gR2MoYSwgYikgewogICAgICAgICAgICB2YXIgZCA9IC0xICE9IEUuaW5kZXhPZihhLmlkKSwKICAgICAgICAgICAgICAgIGMgPSAtMSAhPSBFLmluZGV4T2YoYi5pZCksCiAgICAgICAgICAgICAgICBlID0gMzAgPiBiLnNpemU7CiAgICAgICAgICAgIGQgJiYgZSAmJiArK3ViOwogICAgICAgICAgICBlIHx8ICFkIHx8IGMgfHwgYi5lYSAmIDMyIHx8ICsrd2IKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGtjKGEpIHsKICAgICAgICAgICAgYSA9IH5+YTsKICAgICAgICAgICAgdmFyIGIgPSAoYSAlIDYwKS50b1N0cmluZygpOwogICAgICAgICAgICBhID0gKH5+KGEgLyA2MCkpLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIDIgPiBiLmxlbmd0aCAmJiAoYiA9ICIwIiArIGIpOwogICAgICAgICAgICByZXR1cm4gYSArICI6IiArIGIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFJjKCkgewogICAgICAgICAgICBpZiAobnVsbCA9PSBDKSByZXR1cm4gMDsKICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBDLmxlbmd0aDsgKythKQogICAgICAgICAgICAgICAgaWYgKC0xICE9IEUuaW5kZXhPZihDW2FdLmlkKSkgcmV0dXJuIGEgKyAxOwogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gU2MoKSB7CiAgICAgICAgICAgIGUoIi5zdGF0cy1mb29kLWVhdGVuIikudGV4dCh1Yik7CiAgICAgICAgICAgIGUoIi5zdGF0cy10aW1lLWFsaXZlIikudGV4dChrYygoRWIgLSBSYSkgLyAxRTMpKTsKICAgICAgICAgICAgZSgiLnN0YXRzLWxlYWRlcmJvYXJkLXRpbWUiKS50ZXh0KGtjKHhiKSk7CiAgICAgICAgICAgIGUoIi5zdGF0cy1oaWdoZXN0LW1hc3MiKS50ZXh0KH5+KFQgLyAxMDApKTsKICAgICAgICAgICAgZSgiLnN0YXRzLWNlbGxzLWVhdGVuIikudGV4dCh3Yik7CiAgICAgICAgICAgIGUoIi5zdGF0cy10b3AtcG9zaXRpb24iKS50ZXh0KDAgPT0gVyA/ICI6KCIgOgogICAgICAgICAgICAgICAgVyk7CiAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXRzR3JhcGgiKTsKICAgICAgICAgICAgaWYgKGEpIHsKICAgICAgICAgICAgICAgIHZhciBiID0gYS5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgIGQgPSBhLndpZHRoLAogICAgICAgICAgICAgICAgICAgIGEgPSBhLmhlaWdodDsKICAgICAgICAgICAgICAgIGIuY2xlYXJSZWN0KDAsIDAsIGQsIGEpOwogICAgICAgICAgICAgICAgaWYgKDIgPCBGLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAyMDAsIGcgPSAwOyBnIDwgRi5sZW5ndGg7IGcrKykgYyA9IE1hdGgubWF4KEZbZ10sIGMpOwogICAgICAgICAgICAgICAgICAgIGIubGluZVdpZHRoID0gMzsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVDYXAgPSAicm91bmQiOwogICAgICAgICAgICAgICAgICAgIGIubGluZUpvaW4gPSAicm91bmQiOwogICAgICAgICAgICAgICAgICAgIGIuc3Ryb2tlU3R5bGUgPSB2YjsKICAgICAgICAgICAgICAgICAgICBiLmZpbGxTdHlsZSA9IHZiOwogICAgICAgICAgICAgICAgICAgIGIuYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgYi5tb3ZlVG8oMCwgYSAtIEZbMF0gLyBjICogKGEgLSAxMCkgKyAxMCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChnID0gMTsgZyA8IEYubGVuZ3RoOyBnICs9IE1hdGgubWF4KH5+KEYubGVuZ3RoIC8gZCksIDEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHAgPSBnIC8gKEYubGVuZ3RoIC0gMSkgKiBkLCBmID0gW10sIGsgPSAtMjA7IDIwID49IGs7ICsraykgMCA+IGcgKyBrIHx8IGcgKyBrID49IEYubGVuZ3RoIHx8IGYucHVzaChGW2cgKyBrXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBmLnJlZHVjZShmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiCiAgICAgICAgICAgICAgICAgICAgICAgIH0pIC8gZi5sZW5ndGggLyBjOwogICAgICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbyhwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSAtIGYgKiAoYSAtIDEwKSArIDEwKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZSgpOwogICAgICAgICAgICAgICAgICAgIGIuZ2xvYmFsQWxwaGEgPSAuNTsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbyhkLCBhKTsKICAgICAgICAgICAgICAgICAgICBiLmxpbmVUbygwLCBhKTsKICAgICAgICAgICAgICAgICAgICBiLmZpbGwoKTsKICAgICAgICAgICAgICAgICAgICBiLmdsb2JhbEFscGhhID0gMQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBRYygpIHsKICAgICAgICAgICAgamEgfHwgYWEgfHwgKFphID8gKGMucmVmcmVzaEFkKGMuYWRTbG90cy5hYiksIFNjKCksIGFhID0gITAsIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgZSgiI292ZXJsYXlzIikuZmFkZUluKDUwMCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGdhKCkKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgZSgiI3N0YXRzIikuc2hvdygpOwogICAgICAgICAgICAgICAgdmFyIGEgPSBsYygiZ19wbHVzX3NoYXJlX3N0YXRzIik7CiAgICAgICAgICAgICAgICBjLmZpbGxTb2NpYWxWYWx1ZXMoYSwgImdQbHVzU2hhcmUiKQogICAgICAgICAgICB9LCAxNTAwKSkgOiB5YSg1MDApKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbGMoYSkgewogICAgICAgICAgICB2YXIgYiA9IGUoIi5zdGF0cy10aW1lLWFsaXZlIikudGV4dCgpOwogICAgICAgICAgICByZXR1cm4gYy5wYXJzZVN0cmluZyhhLCAiJUAiLCBbYi5zcGxpdCgiOiIpWzBdLCBiLnNwbGl0KCI6IilbMV0sIGUoIi5zdGF0cy1oaWdoZXN0LW1hc3MiKS50ZXh0KCldKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gVGMoKSB7CiAgICAgICAgICAgIGMub3BlbigiaHR0cHM6Ly9wbHVzLmdvb2dsZS5jb20vc2hhcmU/dXJsPXd3dy5hZ2FyLmlvJmhsPWVuLVVTIiwgIkFnYXIuaW8iLCAid2lkdGg9NDg0LGhlaWdodD01ODAsbWVudWJhcj1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT15ZXMsc2Nyb2xsYmFycz1ubyxsZWZ0PSIgKyAoYy5zY3JlZW5YICsgYy5pbm5lcldpZHRoIC8gMiAtIDI0MikgKyAiLHRvcD0iICsgKGMuaW5uZXJIZWlnaHQgLSA1ODApIC8gMikKICAgICAgICB9CiAgICAgICAgdmFyIG1jID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgaWYgKCJ1bmRlZmluZWQiID09IHR5cGVvZiBjb25zb2xlIHx8ICJ1bmRlZmluZWQiID09IHR5cGVvZiBEYXRhVmlldyB8fCAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2ViU29ja2V0IHx8IG51bGwgPT0gbWMgfHwgbnVsbCA9PSBtYy5nZXRDb250ZXh0IHx8IG51bGwgPT0gYy5sb2NhbFN0b3JhZ2UpIGFsZXJ0KCJZb3UgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgZ2FtZSwgd2UgcmVjb21tZW5kIHlvdSB0byB1c2UgRmlyZWZveCB0byBwbGF5IHRoaXMiKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdmFyIEQgPSB7fTsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciBhID0gYy5sb2NhdGlvbi5zZWFyY2g7CiAgICAgICAgICAgICAgICAiPyIgPT0gYS5jaGFyQXQoMCkgJiYgKGEgPQogICAgICAgICAgICAgICAgICAgIGEuc2xpY2UoMSkpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IGEuc3BsaXQoIiYiKSwgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhW2JdLnNwbGl0KCI9Iik7CiAgICAgICAgICAgICAgICAgICAgRFtkWzBdXSA9IGRbMV0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgYy5xdWVyeVN0cmluZyA9IEQ7CiAgICAgICAgICAgIHZhciBuYyA9ICJmYiIgaW4gRCwKICAgICAgICAgICAgICAgIFVjID0gIm1pbmljbGlwIiBpbiBELAogICAgICAgICAgICAgICAgdiA9IHsKICAgICAgICAgICAgICAgICAgICBza2luc0VuYWJsZWQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICBuYW1lc0VuYWJsZWQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICBub0NvbG9yczogIjAiLAogICAgICAgICAgICAgICAgICAgIGJsYWNrVGhlbWU6ICIwIiwKICAgICAgICAgICAgICAgICAgICBzaG93TWFzczogIjAiLAogICAgICAgICAgICAgICAgICAgIHN0YXRzRW5hYmxlZDogIjAiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgVmMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdWEoIiIsIC0xKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9jID0gImh0dHA6IiAhPSBjLmxvY2F0aW9uLnByb3RvY29sLAogICAgICAgICAgICAgICAgV2MgPSAiMSIgPT0gdGMoKSwKICAgICAgICAgICAgICAgIHBjID0gITE7CiAgICAgICAgICAgIG5jIHx8IFVjIHx8IChvYyAmJiAhV2MgPyAodWEoIjEiLCAxKSwgYy5sb2NhdGlvbi5ocmVmID0gImh0dHA6IiArIGMubG9jYXRpb24uaHJlZi5zdWJzdHJpbmcoYy5sb2NhdGlvbi5wcm90b2NvbC5sZW5ndGgpLCBwYyA9ICEwKSA6IHVhKCIiLCAtMSkpOwogICAgICAgICAgICBvYyB8fCB1YSgiIiwgLTEpOwogICAgICAgICAgICBwYyB8fCBzZXRUaW1lb3V0KFZjLCAzRTMpOwogICAgICAgICAgICBpZiAoIWMuYWdhcmlvTm9Jbml0KSB7CiAgICAgICAgICAgICAgICB2YXIgamIgPSBjLmxvY2F0aW9uLnByb3RvY29sLAogICAgICAgICAgICAgICAgICAgIG1iID0gImh0dHBzOiIgPT0gamI7CiAgICAgICAgICAgICAgICBELm1hc3RlciAmJiAoRW52Q29uZmlnLm1hc3Rlcl91cmwgPSBELm1hc3Rlcik7CiAgICAgICAgICAgICAgICB2YXIgQ2EgPSBqYiArICIvLyIgKyBFbnZDb25maWcubWFzdGVyX3VybCArICIvIiwKICAgICAgICAgICAgICAgICAgICAkYSA9IGMubmF2aWdhdG9yLnVzZXJBZ2VudDsKICAgICAgICAgICAgICAgIGlmICgtMSAhPSAkYS5pbmRleE9mKCJBbmRyb2lkIikpIGMuZ2EgJiYgYy5nYSgic2VuZCIsICJldmVudCIsICJNb2JpbGVSZWRpcmVjdCIsICJQbGF5U3RvcmUiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgYy5sb2NhdGlvbi5ocmVmID0gImh0dHBzOi8vcGxheS5nb29nbGUuY29tL3N0b3JlL2FwcHMvZGV0YWlscz9pZD1jb20ubWluaWNsaXAuYWdhci5pbyIKICAgICAgICAgICAgICAgIH0sIDFFMyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmICgtMSAhPSAkYS5pbmRleE9mKCJpUGhvbmUiKSB8fCAtMSAhPSAkYS5pbmRleE9mKCJpUGFkIikgfHwgLTEgIT0gJGEuaW5kZXhPZigiaVBvZCIpKSBjLmdhICYmIGMuZ2EoInNlbmQiLCAiZXZlbnQiLCAiTW9iaWxlUmVkaXJlY3QiLCAiQXBwU3RvcmUiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgYy5sb2NhdGlvbi5ocmVmID0gImh0dHBzOi8vaXR1bmVzLmFwcGxlLmNvbS9hcHAvYWdhci5pby9pZDk5NTk5OTcwMz9tdD04JmF0PTFsM3ZhanAiCiAgICAgICAgICAgICAgICB9LCAxRTMpOwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSB7fTsKICAgICAgICAgICAgICAgICAgICBjLmFnYXJBcHAgPSBtOwogICAgICAgICAgICAgICAgICAgIHZhciB5YiwgZiwgTywgciwgdCwgaWEgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB3ID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgeSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHogPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBFID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHEgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgSyA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBBID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIGJhID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIEMgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFogPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB6YSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICBBYSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICBKYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBiYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE4gPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBNYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIE5hID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgT2EgPSAxRTQsCiAgICAgICAgICAgICAgICAgICAgICAgIFBhID0gMUU0LAogICAgICAgICAgICAgICAgICAgICAgICBsID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgRyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGFiID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHNiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIFQgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBlYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBiYiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBwYSA9IHkgPSB+figoTWEgKyBPYSkgLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgcWEgPSB6ID0gfn4oKE5hICsgUGEpIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgIHJhID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgbGEgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgSSA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGdiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHBiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIG5iID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgb2IgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBLYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIExhID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgTWMgPSBbIiMzMzMzMzMiLCAiI0ZGMzMzMyIsICIjMzNGRjMzIiwgIiMzMzMzRkYiXSwKICAgICAgICAgICAgICAgICAgICAgICAgemIgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgbmEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgRmEgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBQID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgQiA9IDEsCiAgICAgICAgICAgICAgICAgICAgICAgIGphID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGtiID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgY2MgPSAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgcmIgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBxYiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBKID0gbmV3IEltYWdlOwogICAgICAgICAgICAgICAgICAgIEouc3JjID0gIi9pbWcvYmFja2dyb3VuZC5wbmciOwogICAgICAgICAgICAgICAgICAgIHZhciBkYyA9ICJvbnRvdWNoc3RhcnQiIGluIGMgJiYgL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KGMubmF2aWdhdG9yLnVzZXJBZ2VudCksCiAgICAgICAgICAgICAgICAgICAgICAgIEFiID0gbmV3IEltYWdlOwogICAgICAgICAgICAgICAgICAgIEFiLnNyYyA9ICIvaW1nL3NwbGl0LnBuZyI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHdhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHhhID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGNiID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIEZiLCBHYjsKICAgICAgICAgICAgICAgICAgICAiZ2FtZXBhZCIgaW4gRCAmJiBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNiICYmIChZID0gZGIuaGEoWSwgRmIpLCBaID0gZGIuaGEoWiwgR2IpKQogICAgICAgICAgICAgICAgICAgIH0sIDI1KTsKICAgICAgICAgICAgICAgICAgICBjLmdhbWVwYWRBeGlzVXBkYXRlID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAuMSA+IGIgKiBiOwogICAgICAgICAgICAgICAgICAgICAgICAwID09IGEgJiYgKGQgPyBGYiA9IHIgLyAyIDogKEZiID0gKGIgKyAxKSAvIDIgKiByLCBjYiA9ICEwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIDEgPT0gYSAmJiAoZCA/IEdiID0gdCAvIDIgOiAoR2IgPSAoYiArIDEpIC8gMiAqIHQsIGNiID0gITApKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5hZ2FyaW9Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBnYiA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICB4YygpOwogICAgICAgICAgICAgICAgICAgICAgICB3YygpOwogICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IGMubG9jYWxTdG9yYWdlLnNldHRpbmdzICYmICh2ID0gSlNPTi5wYXJzZShjLmxvY2FsU3RvcmFnZS5zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYiA9IHYuc2hvd01hc3MsIGVhID0gdi5ibGFja1RoZW1lLCBmYSA9IHYubmFtZXNFbmFibGVkLCB0YSA9IHYubm9Db2xvcnMsIFphID0gdi5zdGF0c0VuYWJsZWQsIGFiID0gdi5za2luc0VuYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc2hvd01hc3MiKS5wcm9wKCJjaGVja2VkIiwgdi5zaG93TWFzcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNub1NraW5zIikucHJvcCgiY2hlY2tlZCIsICF2LnNraW5zRW5hYmxlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNza2lwU3RhdHMiKS5wcm9wKCJjaGVja2VkIiwgIXYuc3RhdHNFbmFibGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI25vQ29sb3JzIikucHJvcCgiY2hlY2tlZCIsIHYubm9Db2xvcnMpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjbm9OYW1lcyIpLnByb3AoImNoZWNrZWQiLCAhdi5uYW1lc0VuYWJsZWQpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjZGFya1RoZW1lIikucHJvcCgiY2hlY2tlZCIsIHYuYmxhY2tUaGVtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIExiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKExiLCAxOEU0KTsKICAgICAgICAgICAgICAgICAgICAgICAgTyA9IHliID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9IE8gJiYgKGYgPSBPLmdldENvbnRleHQoIjJkIiksIE8ub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLmNsaWVudFggLSAoNSArIHIgLyA1IC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBhLmNsaWVudFkgLSAoNSArIHIgLyA1IC8gMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguc3FydChiICogYiArIGQgKiBkKSA8PSByIC8gNSAvIDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgWSA9IDEgKiBhLmNsaWVudFg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBaID0gMSAqIGEuY2xpZW50WTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZiKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTYSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIE8ub25tb3VzZW1vdmUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IgPSAhMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFkgPSAxICogYS5jbGllbnRYOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWiA9IDEgKiBhLmNsaWVudFk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYigpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIE8ub25tb3VzZXVwID0gZnVuY3Rpb24gKCkgeyB9LCAvZmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgPyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Nb3VzZVNjcm9sbCIsIEtiLCAhMSkgOiBkb2N1bWVudC5ib2R5Lm9ubW91c2V3aGVlbCA9IEtiLCBjLm9uYmx1ciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFgoMTkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeGEgPSB3YSA9IHZhID0gITEKICAgICAgICAgICAgICAgICAgICAgICAgfSwgYy5vbnJlc2l6ZSA9IFhiLCBjLnJlcXVlc3RBbmltYXRpb25GcmFtZShxYyksIHNldEludGVydmFsKFNhLCA0MCksIEcgJiYgZSgiI3JlZ2lvbiIpLnZhbChHKSwgTmIoKSwgRGEoZSgiI3JlZ2lvbiIpLnZhbCgpKSwgMCA9PSBrYiAmJiBHICYmIFEoKSwgeWEoMCksIFhiKCksIGMubG9jYXRpb24uaGFzaCAmJiA2IDw9IGMubG9jYXRpb24uaGFzaC5sZW5ndGggJiYgamMoYy5sb2NhdGlvbi5oYXNoKSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBCYSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgYy5zZXROaWNrID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYy5nYSAmJiBjLmdhKCJzZW5kIiwgImV2ZW50IiwgIk5pY2siLCBhLnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBNYigpOwogICAgICAgICAgICAgICAgICAgICAgICBOID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgU2IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgVCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHYuc2tpbnNFbmFibGVkID0gYWI7CiAgICAgICAgICAgICAgICAgICAgICAgIHYubmFtZXNFbmFibGVkID0gZmE7CiAgICAgICAgICAgICAgICAgICAgICAgIHYubm9Db2xvcnMgPSB0YTsKICAgICAgICAgICAgICAgICAgICAgICAgdi5ibGFja1RoZW1lID0gZWE7CiAgICAgICAgICAgICAgICAgICAgICAgIHYuc2hvd01hc3MgPSBiYjsKICAgICAgICAgICAgICAgICAgICAgICAgdi5zdGF0c0VuYWJsZWQgPSBaYTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5sb2NhbFN0b3JhZ2Uuc2V0dGluZ3MgPSBKU09OLnN0cmluZ2lmeSh2KTsKICAgICAgICAgICAgICAgICAgICAgICAgSWIoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRTa2lucyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFiID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXROYW1lcyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZhID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXREYXJrVGhlbWUgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBlYSA9IGEKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0Q29sb3JzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGEgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNldFNob3dNYXNzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmIgPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnNwZWN0YXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBOID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgSWIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgWCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgTWIoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5zZXRSZWdpb24gPSBEYTsKICAgICAgICAgICAgICAgICAgICB2YXIgaGIgPSAhMDsKICAgICAgICAgICAgICAgICAgICBjLnNldEdhbWVNb2RlID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYSAhPSBsYSAmJiAoIjpwYXJ0eSIgPT0gbGEgJiYgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIwIiksIGthKGEpLCAiOnBhcnR5IiAhPSBhICYmIFEoKSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0QWNpZCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHpiID0gYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIFhjID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcERyYXc6ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWRpY3Rpb25Nb2RpZmllcjogMS4xCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLmluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmFjY291bnQuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5nb29nbGUudmEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uZmEuaW5pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGQgPSAiZGVidWciIGluIGMucXVlcnlTdHJpbmcpICYmIG0uZGVidWcuc2hvd0RlYnVnKCkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5iaW5kID0gZnVuY3Rpb24gKGEsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoYikuYmluZChhLCBkKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnVuYmluZCA9IGZ1bmN0aW9uIChhLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKGIpLnVuYmluZChhLCBkKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnRyaWdnZXIgPSBmdW5jdGlvbiAoYSwgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZShiKS50cmlnZ2VyKGEsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygiZGVidWciLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZVNldHRlcl9fKCJkZWJ1ZyIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZCA9IGEKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygicHJveHkiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5NQwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZUdldHRlcl9fKCJjb25maWciLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KHt9KTsKICAgICAgICAgICAgICAgICAgICBtLmNvcmUgPSBYYzsKICAgICAgICAgICAgICAgICAgICBtLmNhY2hlID0ge307CiAgICAgICAgICAgICAgICAgICAgdmFyIFljID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYihhLCBiLCBkLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gYSArICJDYW52YXMiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBlKCI8Y2FudmFzPiIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogYQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmFwcGVuZChnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBuZXcgU21vb3RoaWVDaGFydChkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZyA9IDA7IGcgPCBiLmxlbmd0aDsgZysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHUgPSBiW2ddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gXy5leHRlbmQoaCwgY1tnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5hZGRUaW1lU2VyaWVzKHUsIGYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnN0cmVhbVRvKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtbYV0gPSBjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKGEsIFtrW2FdXSwgZCwgW3sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDAuMikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVTZXJpZXMoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEthOiAhMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcCwgZiA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAxKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsbFN0eWxlOiAicmdiYSgwLCAyNTUsIDAsIDAuMikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVXaWR0aDogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zaG93RGVidWcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnIHx8IChwID0gZSgiI2RlYnVnLW92ZXJsYXkiKSwgZCgibmV0d29ya1VwZGF0ZSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAibmV0d29yayB1cGRhdGVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5WYWx1ZTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZTogMTIwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgZCgiZnBzIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJmcHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblZhbHVlOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFZhbHVlOiAxMjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBrLnJ0dFNEZXYgPSBjKCksIGsucnR0TWVhbiA9IGMoKSwgYigicnR0TWVhbiIsIFtrLnJ0dFNEZXYsIGsucnR0TWVhbl0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAicnR0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5WYWx1ZTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhWYWx1ZTogMTIwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBbewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm9rZVN0eWxlOiAicmdiYSgyNTUsIDAsIDAsIDEpIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMC4yKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlU3R5bGU6ICJyZ2JhKDAsIDI1NSwgMCwgMSkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxTdHlsZTogInJnYmEoMCwgMjU1LCAwLCAwKSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZVdpZHRoOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSksIGcgPSAhMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgPSAhMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuc2hvdygpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuaGlkZURlYnVnID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgPSAhMQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnVwZGF0ZUNoYXJ0ID0gZnVuY3Rpb24gKGEsIGIsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgJiYgYSBpbiBrICYmIGtbYV0uYXBwZW5kKGIsIGQpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuX19kZWZpbmVHZXR0ZXJfXygic2hvd1ByZWRpY3Rpb24iLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5fX2RlZmluZVNldHRlcl9fKCJzaG93UHJlZGljdGlvbiIsIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZiA9IGEKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgbS5kZWJ1ZyA9IFljOwogICAgICAgICAgICAgICAgICAgIHZhciBtYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgQUY6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFYOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBEWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFTOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFJOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFHOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFSOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgQU06ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFXOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEFVOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgQVQ6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBBWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkg6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJEOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBCQjogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCWTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlo6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQko6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCTTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCVDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQk86ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBCUTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBCQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJXOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQlI6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBJTzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkc6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQk46ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQkY6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBCSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtIOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENBOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENWOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgS1k6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0Y6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBURDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENMOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ046ICJDTi1DaGluYSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENYOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBDQzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ086ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBLTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIENEOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0c6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDSzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENSOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIENJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSFI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBDVTogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBDVzogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBDWTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ1o6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBESzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIERKOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRE06ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRE86ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRUM6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBFRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNWOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdROiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRVI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBFRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgRk86ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBGSzogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEZKOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgRkk6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBGUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdGOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEY6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBHQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0U6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIERFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0g6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHSTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdSOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0w6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR0Q6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1A6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1U6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBHVDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBHRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEdOOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgR1c6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHWTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIEhUOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFZBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSE46ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgSEs6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEhVOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgSVM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBJTjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSUQ6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIElSOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJUTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgSUU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBJTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIElMOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBJVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpNOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpQOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBKRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEpPOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgS0U6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBLSTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtQOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBLUjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgS1c6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIEtHOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBMQTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFY6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMQjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTFM6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMUjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExZOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTEk6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBMVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExVOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTU86ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1LOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1ZOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBNVjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1IOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVE6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVI6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNVTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFlUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVg6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgRk06ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBNRDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1DOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTU46ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1FOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUE6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBNWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE1NOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBOQTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5SOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTlA6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5MOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkM6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBOWjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5JOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5FOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgTkc6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBOVTogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIE5GOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgTVA6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBOTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIE9NOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBQSzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgUFc6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBQUzogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEE6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEc6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBQWTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBFOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEg6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBOOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgUEw6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBQVDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFBSOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFFBOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBSRTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJPOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgUlU6ICJSVS1SdXNzaWEiLAogICAgICAgICAgICAgICAgICAgICAgICBSVzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIEJMOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNIOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgS046ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTEM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgTUY6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgUE06ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgV1M6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBTTTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNUOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0E6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTTjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0M6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTTDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNHOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBTWDogIlVTLUF0bGFudGEiLAogICAgICAgICAgICAgICAgICAgICAgICBTSzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNJOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0I6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBTTzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFpBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgU1M6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBFUzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIExLOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBTRDogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNSOiAiQlItQnJhemlsIiwKICAgICAgICAgICAgICAgICAgICAgICAgU0o6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTWjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFNFOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQ0g6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBTWTogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRXOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBUSjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFo6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBUSDogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEw6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRHOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEs6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBUTzogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFRUOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFROOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFI6ICJUSy1UdXJrZXkiLAogICAgICAgICAgICAgICAgICAgICAgICBUTTogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVEM6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVFY6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBVRzogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVBOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgQUU6ICJFVS1Mb25kb24iLAogICAgICAgICAgICAgICAgICAgICAgICBHQjogIkVVLUxvbmRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVTOiAiVVMtQXRsYW50YSIsCiAgICAgICAgICAgICAgICAgICAgICAgIFVNOiAiU0ctU2luZ2Fwb3JlIiwKICAgICAgICAgICAgICAgICAgICAgICAgVkk6ICJVUy1BdGxhbnRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgVVk6ICJCUi1CcmF6aWwiLAogICAgICAgICAgICAgICAgICAgICAgICBVWjogIkpQLVRva3lvIiwKICAgICAgICAgICAgICAgICAgICAgICAgVlU6ICJTRy1TaW5nYXBvcmUiLAogICAgICAgICAgICAgICAgICAgICAgICBWRTogIkJSLUJyYXppbCIsCiAgICAgICAgICAgICAgICAgICAgICAgIFZOOiAiSlAtVG9reW8iLAogICAgICAgICAgICAgICAgICAgICAgICBXRjogIlNHLVNpbmdhcG9yZSIsCiAgICAgICAgICAgICAgICAgICAgICAgIEVIOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWUU6ICJKUC1Ub2t5byIsCiAgICAgICAgICAgICAgICAgICAgICAgIFpNOiAiRVUtTG9uZG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgWlc6ICJFVS1Mb25kb24iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgb2EgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBHYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFMgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBVYjsKICAgICAgICAgICAgICAgICAgICBjLmNvbm5lY3QgPSBsYjsKICAgICAgICAgICAgICAgICAgICB2YXIgSWEgPSA1MDAsCiAgICAgICAgICAgICAgICAgICAgICAgIENjID0gLjg3NSwKICAgICAgICAgICAgICAgICAgICAgICAgRWMgPSAuNzUsCiAgICAgICAgICAgICAgICAgICAgICAgIEZjID0gLjI1LAogICAgICAgICAgICAgICAgICAgICAgICBEYyA9IC4xMjUsCiAgICAgICAgICAgICAgICAgICAgICAgIFZiID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICAgIFdiID0gLTE7CiAgICAgICAgICAgICAgICAgICAgYy5zZW5kTWl0b3NpcyA9IGViOwogICAgICAgICAgICAgICAgICAgIGMuc2VuZEVqZWN0ID0gSmI7CiAgICAgICAgICAgICAgICAgICAgbS5uZXR3b3JraW5nID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5sb2dpblJlYWxtID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgR0c6ICJnb29nbGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRkI6ICJmYWNlYm9vayIKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGEoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYS5ieXRlVmlldzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBVKDEgKyBhLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2V0VWludDgoMCwgMTAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBkLmxlbmd0aDsgKytjKSBhLnNldFVpbnQ4KDEgKyBjLCBkW2NdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMDsgYyA8IGQubGVuZ3RoOyArK2MpIHR4dCArPSAnWycgKyBjICsgJy0nICsgZFtjXSArICddJyArIFN0cmluZy5mcm9tQ2hhckNvZGUoZFtjXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1BBQ0tFVCAxMDInLGQubGVuZ3RoLGQubGVuZ3RoLTMwLGQsdHh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zZW5kVG9rZW4oZCk7Ly9BR0FSQk9UT1ZICiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFYoYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIEggPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICBNID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgVWEgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICByYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHFjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSAxRTMgLyA2MDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocWMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGQgLSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID4gYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gZCAtIGUgJSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IERhdGUubm93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFkYSgpIHx8IDI0MCA+IGcgLSBGYSB8fCAhbS5jb3JlLmNvbmZpZy5za2lwRHJhdyA/IFliKCkgOiBjb25zb2xlLndhcm4oIlNraXBwaW5nIGRyYXciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWmMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSAxRTMgLyBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmRlYnVnLnVwZGF0ZUNoYXJ0KCJmcHMiLCBkLCByYykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgaGEgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgT2IgPSAicG9sYW5kO3VzYTtjaGluYTtydXNzaWE7Y2FuYWRhO2F1c3RyYWxpYTtzcGFpbjticmF6aWw7Z2VybWFueTt1a3JhaW5lO2ZyYW5jZTtzd2VkZW47Y2hhcGxpbjtub3J0aCBrb3JlYTtzb3V0aCBrb3JlYTtqYXBhbjt1bml0ZWQga2luZ2RvbTtlYXJ0aDtncmVlY2U7bGF0dmlhO2xpdGh1YW5pYTtlc3RvbmlhO2ZpbmxhbmQ7bm9yd2F5O2NpYTttYWxkaXZhczthdXN0cmlhO25pZ2VyaWE7cmVkZGl0O3lhcmFuYWlrYTtjb25mZWRlcmF0ZTs5Z2FnO2luZGlhbmE7NGNoYW47aXRhbHk7YnVsZ2FyaWE7dHVtYmxyOzJjaC5oaztob25nIGtvbmc7cG9ydHVnYWw7amFtYWljYTtnZXJtYW4gZW1waXJlO21leGljbztzYW5paztzd2l0emVybGFuZDtjcm9hdGlhO2NoaWxlO2luZG9uZXNpYTtiYW5nbGFkZXNoO3RoYWlsYW5kO2lyYW47aXJhcTtwZXJ1O21vb247Ym90c3dhbmE7Ym9zbmlhO25ldGhlcmxhbmRzO2V1cm9wZWFuIHVuaW9uO3RhaXdhbjtwYWtpc3RhbjtodW5nYXJ5O3NhdGFuaXN0O3FpbmcgZHluYXN0eTttYXRyaWFyY2h5O3BhdHJpYXJjaHk7ZmVtaW5pc207aXJlbGFuZDt0ZXhhcztmYWNlcHVuY2g7cHJvZG90YTtjYW1ib2RpYTtzdGVhbTtwaWNjb2xvO2VhO2luZGlhO2tjO2Rlbm1hcms7cXVlYmVjO2F5eSBsbWFvO3NlYWxhbmQ7YmFpdDt0c2FyaXN0IHJ1c3NpYTtvcmlnaW47dmluZXNhdWNlO3N0YWxpbjtiZWxnaXVtO2x1eGVtYm91cmc7c3R1c3N5O3BydXNzaWE7OGNoO2FyZ2VudGluYTtzY290bGFuZDtzaXI7cm9tYW5pYTt3b2phaztkb2dlO25hc2E7Ynl6YW50aXVtO2ltcGVyaWFsIGphcGFuO2ZyZW5jaCBraW5nZG9tO3NvbWFsaWE7dHVya2V5O21hcnM7cG9rZXJmYWNlOzg7aXJzO3JlY2VpdGEgZmVkZXJhbDtmYWNlYm9vaztwdXRpbjttZXJrZWw7dHNpcHJhcztvYmFtYTtraW0gam9uZy11bjtkaWxtYTtob2xsYW5kZTtiZXJsdXNjb25pO2NhbWVyb247Y2xpbnRvbjtoaWxsYXJ5O3ZlbmV6dWVsYTtibGF0dGVyO2NoYXZlejtjdWJhO2ZpZGVsO21lcmtlbDtwYWxpbjtxdWVlbjtib3JpcztidXNoO3RydW1wIi5zcGxpdCgiOyIpLAogICAgICAgICAgICAgICAgICAgICAgICAkYyA9ICI4O25hc2E7cHV0aW47bWVya2VsO3RzaXByYXM7b2JhbWE7a2ltIGpvbmctdW47ZGlsbWE7aG9sbGFuZGU7YmVybHVzY29uaTtjYW1lcm9uO2NsaW50b247aGlsbGFyeTtibGF0dGVyO2NoYXZlejtmaWRlbDttZXJrZWw7cGFsaW47cXVlZW47Ym9yaXM7YnVzaDt0cnVtcCIuc3BsaXQoIjsiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc2EgPSB7fTsKICAgICAgICAgICAgICAgICAgICBCYi5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGY6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGI6IDAKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBUYSA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgICAkYiA9ICExOwogICAgICAgICAgICAgICAgICAgIGNhLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGE6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGk6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIFM6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHM6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIG86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGphOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBrYTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgZzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgTTogMCwKICAgICAgICAgICAgICAgICAgICAgICAgTjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgSjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgSzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgZWE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFU6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHJhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBHOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgYzogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIGg6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBWOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgZGE6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEM6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGlhOiAwLAogICAgICAgICAgICAgICAgICAgICAgICB1YTogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIEk6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBjYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSAwOyBhIDwgQS5sZW5ndGg7IGErKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQVthXSA9PSB0aGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEEuc3BsaWNlKGEsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBLW3RoaXMuaWRdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHEuaW5kZXhPZih0aGlzKTsgLTEgIT0gYSAmJiAoc2IgPSAhMCwgcS5zcGxpY2UoYSwgMSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IEUuaW5kZXhPZih0aGlzLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC0xICE9IGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFLnNwbGljZShhLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVNeUJhbGwodGhpcy5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FHQVJCT1RPVkgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRyA9ICEwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHRoaXMuZGEgJiYgYmEucHVzaCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBtOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgofn4oLjMgKiB0aGlzLnNpemUpLCAyNCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgQTogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgPSBhKSBudWxsID09IHRoaXMuaSA/IHRoaXMuaSA9IG5ldyBWYSh0aGlzLm0oKSwgIiNGRkZGRkYiLCAhMCwgIiMwMDAwMDAiKSA6IHRoaXMuaS5QKHRoaXMubSgpKSwgdGhpcy5pLkIodGhpcy5uYW1lKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBiYTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMuSCgpIDsgdGhpcy5hLmxlbmd0aCA+IGE7KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB+fihNYXRoLnJhbmRvbSgpICogdGhpcy5hLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hLnNwbGljZShiLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICgwID09IHRoaXMuYS5sZW5ndGggJiYgMCA8IGEgJiYgdGhpcy5hLnB1c2gobmV3IEJiKHRoaXMsIHRoaXMueCwgdGhpcy55LCB0aGlzLnNpemUsIE1hdGgucmFuZG9tKCkgLSAuNSkpIDsgdGhpcy5hLmxlbmd0aCA8IGE7KSBiID0gfn4oTWF0aC5yYW5kb20oKSAqIHRoaXMuYS5sZW5ndGgpLCBiID0gdGhpcy5hW2JdLCB0aGlzLmEucHVzaChuZXcgQmIodGhpcywgYi54LCBiLnksIGIuZiwgYi5iKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgSDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDIwID4gdGhpcy5zaXplICYmIChhID0gMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmMgJiYgKGEgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2l6ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYyB8fCAoYiAqPSBsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgKj0gTTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB+fk1hdGgubWF4KGIsIGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIEJhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gdGhpcy5hLCBiID0gYS5sZW5ndGgsIGQgPSB0aGlzLCBjID0gdGhpcy5jID8gMCA6ICh0aGlzLmlkIC8gMUUzICsgeCAvIDFFNCkgJSAoMiAqIE1hdGguUEkpLCBlID0gMCwgcCA9IDA7IHAgPCBiOyArK3ApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGFbKHAgLSAxICsgYikgJSBiXS5iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gYVsocCArIDEpICUgYl0uYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IGFbcF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5iICs9IChNYXRoLnJhbmRvbSgpIC0gLjUpICogKHRoaXMuaCA/IDMgOiAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmIgKj0gLjc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAgPCBoLmIgJiYgKGguYiA9IDEwKTsgLTEwID4gaC5iICYmIChoLmIgPSAtMTApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGguYiA9IChmICsgayArIDggKiBoLmIpIC8gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBoLmYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhWyhwIC0gMSArIGIpICUgYl0uZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayA9IGFbKHAgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMSkgJSBiXS5mOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxNSA8IHRoaXMuc2l6ZSAmJiBudWxsICE9IGlhICYmIDIwIDwgdGhpcy5zaXplICogbCAmJiAwIDwgdGhpcy5pZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgUWEgPSAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gPSBoLngsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gaC55OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpYS5FYShtIC0gNSwgcSAtIDUsIDEwLCAxMCwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuJCAhPSBkICYmIDI1ID4gKG0gLSBhLngpICogKG0gLSBhLngpICsgKHEgLSBhLnkpICogKHEgLSBhLnkpICYmIChRYSA9ICEwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIVFhICYmIChoLnggPCBNYSB8fCBoLnkgPCBOYSB8fCBoLnggPiBPYSB8fCBoLnkgPiBQYSkgJiYgKFFhID0gITApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBRYSAmJiAoMCA8IGguYiAmJiAoaC5iID0gMCksIC0taC5iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuICs9IGguYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwID4gbiAmJiAobiA9IDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmggPyAoMTkgKiBuICsgdGhpcy5zaXplKSAvIDIwIDogKDEyICogbiArIHRoaXMuc2l6ZSkgLyAxMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmYgPSAoZiArIGsgKyA4ICogbikgLyAxMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gMiAqIE1hdGguUEkgLyBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBoLmY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jICYmIDAgPT0gcCAlIDIgJiYgKGsgKz0gNSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC54ID0gdGhpcy54ICsgTWF0aC5jb3MoZiAqIHAgKyBjKSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaC55ID0gdGhpcy55ICsgTWF0aC5zaW4oZiAqIHAgKyBjKSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IE1hdGgubWF4KGUsIGspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlhID0gZQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBuYTogZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuTSA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLk4gPSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5KID0gYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuamEgPSBhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rYSA9IGIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgVDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPj0gdGhpcy5pZCkgcmV0dXJuIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGRiLnBhKCh4IC0gdGhpcy5VKSAvIDEyMCwgMCwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5HICYmIDEgPD0gYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYmEuaW5kZXhPZih0aGlzKTsgLTEgIT0gYiAmJiBiYS5zcGxpY2UoYiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IGEgKiAodGhpcy5qYSAtIHRoaXMucykgKyB0aGlzLnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBhICogKHRoaXMua2EgLSB0aGlzLnUpICsgdGhpcy51OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaXplID0gYSAqICh0aGlzLmcgLSB0aGlzLm8pICsgdGhpcy5vOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLjAxID4gTWF0aC5hYnModGhpcy5zaXplIC0gdGhpcy5nKSAmJiAodGhpcy5zaXplID0gdGhpcy5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwID49IHRoaXMuaWQgPyAhMCA6IHRoaXMueCArIHRoaXMuc2l6ZSArIDQwIDwgeSAtIHIgLyAyIC8gbCB8fCB0aGlzLnkgKyB0aGlzLnNpemUgKyA0MCA8IHogLSB0IC8gMiAvIGwgfHwgdGhpcy54IC0gdGhpcy5zaXplIC0gNDAgPiB5ICsgciAvIDIgLyBsIHx8IHRoaXMueSAtIHRoaXMuc2l6ZSAtIDQwID4geiArIHQgLyAyIC8gbCA/ICExIDogITAKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgcWE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5tb3ZlVG8odGhpcy5hWzBdLngsIHRoaXMuYVswXS55KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAxOyBkIDw9IGI7ICsrZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gZCAlIGI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lVG8odGhpcy5hW2NdLngsIHRoaXMuYVtjXS55KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5jbG9zZVBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc3Ryb2tlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdzogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLlIoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsrdGhpcy5kYTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IDAgPCB0aGlzLmlkICYmICF0aGlzLmMgJiYgIXRoaXMuaCAmJiAuNCA+IGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNSA+IHRoaXMuSCgpICYmIDAgPCB0aGlzLmlkICYmIChiID0gITApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLlYgJiYgIWIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgdGhpcy5hLmxlbmd0aDsgZCsrKSB0aGlzLmFbZF0uZiA9IHRoaXMuc2l6ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlYgPSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc2F2ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmEgPSB4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLlQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkcgJiYgKGEuZ2xvYmFsQWxwaGEgKj0gMSAtIGQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGluZVdpZHRoID0gMTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5saW5lQ2FwID0gInJvdW5kIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxpbmVKb2luID0gdGhpcy5jID8gIm1pdGVyIiA6ICJyb3VuZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLm5hbWUudG9Mb3dlckNhc2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0aGlzLmNvbG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oIHx8ICFhYiB8fCBxYiB8fCAoLTEgIT0gT2IuaW5kZXhPZihlKSA/IChoYS5oYXNPd25Qcm9wZXJ0eShlKSB8fCAoaGFbZV0gPSBuZXcgSW1hZ2UsIGhhW2VdLnNyYyA9IGMuQVNTRVRTX1JPT1QgKyAic2tpbnMvIiArIGUgKyAiLnBuZyIpLCBnID0gMCAhPSBoYVtlXS53aWR0aCAmJiBoYVtlXS5jb21wbGV0ZSA/IGhhW2VdIDogbnVsbCkgOiBnID0gbnVsbCwgbnVsbCAhPSBnID8gLTEgIT0gJGMuaW5kZXhPZihlKSAmJiAoZCA9ICEwKSA6ICh0aGlzLkkgJiYgIiVzdGFyYmFsbCIgPT0gdGhpcy5DICYmICJzaGVucm9uIiA9PSBlICYmIDcgPD0gcS5sZW5ndGggJiYgKCRiID0gZCA9ICEwLCBwID0gZWMoIiVzdGFyYmFsbDEiKSksIGcgPSBlYyh0aGlzLkMpLCBudWxsICE9IGcgJiYgKGggPSAhMCwgZiA9IE5jKHRoaXMuQykgfHwgZikpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmNvcmUuZGVidWcgJiYgbS5kZWJ1Zy5zaG93UHJlZGljdGlvbiAmJiB0aGlzLkkgJiYgKGEuc3Ryb2tlU3R5bGUgPSAiIzAwMDBGRiIsIGEuYmVnaW5QYXRoKCksIGEuYXJjKHRoaXMuTSwgdGhpcy5OLCB0aGlzLnNpemUgKyA1LCAwLCAyICogTWF0aC5QSSwgITEpLCBhLmNsb3NlUGF0aCgpLCBhLnN0cm9rZSgpLCBhLnN0cm9rZVN0eWxlID0gIiMwMEZGMDAiLCBhLmJlZ2luUGF0aCgpLCBhLmFyYyh0aGlzLkosIHRoaXMuSywgdGhpcy5zaXplICsgNSwgMCwgMiAqIE1hdGguUEksICExKSwgYS5jbG9zZVBhdGgoKSwgYS5zdHJva2UoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGEgJiYgIXFiID8gKGEuZmlsbFN0eWxlID0gIiNGRkZGRkYiLCBhLnN0cm9rZVN0eWxlID0gIiNBQUFBQUEiKSA6IChhLmZpbGxTdHlsZSA9IGYsIGEuc3Ryb2tlU3R5bGUgPSBmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID8gKGEuYmVnaW5QYXRoKCksIGEuYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLnNpemUgKyA1LCAwLCAyICogTWF0aC5QSSwgITEpLCBhLmNsb3NlUGF0aCgpKSA6ICh0aGlzLkJhKCksIHRoaXMucWEoYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggfHwgYS5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBnICYmICh0aGlzLmxhKGEsIGcpLCBudWxsICE9IHAgJiYgdGhpcy5sYShhLCBwLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhOiBNYXRoLnNpbiguMDE3NCAqIFRhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGEgfHwgMTUgPCB0aGlzLnNpemUpICYmICFiICYmIChhLnN0cm9rZVN0eWxlID0gIiMwMDAwMDAiLCBhLmdsb2JhbEFscGhhICo9IC4xLCBhLnN0cm9rZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gLTEgIT0gcS5pbmRleE9mKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB+fnRoaXMueTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwICE9IHRoaXMuaWQgJiYgKGZhIHx8IGUpICYmIHRoaXMubmFtZSAmJiB0aGlzLmkgJiYgIWQgJiYgKGcgPSB0aGlzLmksIGcuQih0aGlzLm5hbWUpLCBnLlAodGhpcy5tKCkpLCBkID0gMCA+PSB0aGlzLmlkID8gMSA6IE1hdGguY2VpbCgxMCAqIGwpIC8gMTAsIGcubWEoZCksIGcgPSBnLk8oKSwgcCA9IE1hdGguY2VpbChnLndpZHRoIC8gZCksIGYgPSBNYXRoLmNlaWwoZy5oZWlnaHQgLyBkKSwgYS5kcmF3SW1hZ2UoZywgfn50aGlzLnggLSB+fihwIC8gMiksIGIgLSB+fihmIC8gMiksIHAsIGYpLCBiICs9IGcuaGVpZ2h0IC8gMiAvIGQgKyA0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwIDwgdGhpcy5pZCAmJiBiYiAmJiAoZSB8fCAwID09IHEubGVuZ3RoICYmICghdGhpcy5jIHx8IHRoaXMuaCkgJiYgMjAgPCB0aGlzLnNpemUpICYmIChudWxsID09IHRoaXMuUyAmJiAodGhpcy5TID0gbmV3IFZhKHRoaXMubSgpIC8gMiwgIiNGRkZGRkYiLCAhMCwgIiMwMDAwMDAiKSksIGUgPSB0aGlzLlMsIGUuUCh0aGlzLm0oKSAvIDIpLCBlLkIofn4odGhpcy5zaXplICogdGhpcy5zaXplIC8gMTAwKSksIGQgPSBNYXRoLmNlaWwoMTAgKiBsKSAvIDEwLCBlLm1hKGQpLCBnID0gZS5PKCksIHAgPSBNYXRoLmNlaWwoZy53aWR0aCAvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQpLCBmID0gTWF0aC5jZWlsKGcuaGVpZ2h0IC8gZCksIGEuZHJhd0ltYWdlKGcsIH5+dGhpcy54IC0gfn4ocCAvIDIpLCBiIC0gfn4oZiAvIDIpLCBwLCBmKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5yZXN0b3JlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbGE6IGZ1bmN0aW9uIChhLCBiLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY2xpcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBNYXRoLm1heCh0aGlzLnNpemUsIHRoaXMuaWEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBkICYmIG51bGwgIT0gZC5hbHBoYSAmJiAoYS5nbG9iYWxBbHBoYSA9IGQuYWxwaGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5kcmF3SW1hZ2UoYiwgdGhpcy54IC0gYyAtIDUsIHRoaXMueSAtIGMgLSA1LCAyICogYyArIDEwLCAyICogYyArIDEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVzdG9yZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHZhciBkYiA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPCBiID8gYiA6IGEgPiBjID8gYyA6IGEKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBhLmhhID0gZnVuY3Rpb24gKGEsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGIoLjUsIDAsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBlICogKGMgLSBhKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBhLnBhID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgYS5maXhlZCA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IE1hdGgucG93KDEwLCBiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB+fihhICogYykgLyBjCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgYy5NYXRocyA9IGRiOwogICAgICAgICAgICAgICAgICAgIHZhciBIYSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuTCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSwgYyA9IFthLmdldE1vbnRoKCkgKyAxLCBhLmdldERhdGUoKSwgYS5nZXRGdWxsWWVhcigpXSwgYSA9IFthLmdldEhvdXJzKCksIGEuZ2V0TWludXRlcygpLCBhLmdldFNlY29uZHMoKV0sIGUgPSAxOyAzID4gZTsgZSsrKSAxMCA+IGFbZV0gJiYgKGFbZV0gPSAiMCIgKyBhW2VdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiWyIgKyBjLmpvaW4oIi8iKSArICIgIiArIGEuam9pbigiOiIpICsgIl0iCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhCiAgICAgICAgICAgICAgICAgICAgfSh7fSk7CiAgICAgICAgICAgICAgICAgICAgYy5VdGlscyA9IEhhOwogICAgICAgICAgICAgICAgICAgIFZhLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgRjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgIFc6ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgWTogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIFo6ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgdjogMTYsCiAgICAgICAgICAgICAgICAgICAgICAgIGo6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIFg6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGw6ICExLAogICAgICAgICAgICAgICAgICAgICAgICBEOiAxLAogICAgICAgICAgICAgICAgICAgICAgICBQOiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ICE9IGEgJiYgKHRoaXMudiA9IGEsIHRoaXMubCA9ICEwKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBtYTogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRCAhPSBhICYmICh0aGlzLkQgPSBhLCB0aGlzLmwgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgQjogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgIT0gdGhpcy5GICYmICh0aGlzLkYgPSBhLCB0aGlzLmwgPSAhMCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgTzogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCA9PSB0aGlzLmogJiYgKHRoaXMuaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpLCB0aGlzLlggPSB0aGlzLmouZ2V0Q29udGV4dCgiMmQiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLmosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLlgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLkYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLkQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSB0aGlzLnYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBnICsgInB4IFVidW50dSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5mb250ID0gZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IH5+KC4yICogZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53aWR0aCA9IChiLm1lYXN1cmVUZXh0KGMpLndpZHRoICsgNikgKiBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuaGVpZ2h0ID0gKGcgKyBoKSAqIGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5mb250ID0gZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnNjYWxlKGUsIGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZ2xvYmFsQWxwaGEgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIubGluZVdpZHRoID0gMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZVN0eWxlID0gdGhpcy5aOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gdGhpcy5XOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuWSAmJiBiLnN0cm9rZVRleHQoYywgMywgZyAtIGggLyAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmZpbGxUZXh0KGMsIDMsIGcgLSBoIC8gMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmoKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgRGF0ZS5ub3cgfHwgKERhdGUubm93ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG5ldyBEYXRlKS5nZXRUaW1lKCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gWyJtcyIsICJtb3oiLCAid2Via2l0IiwgIm8iXSwgYiA9IDA7IGIgPCBhLmxlbmd0aCAmJiAhYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7ICsrYikgYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBjW2FbYl0gKyAiUmVxdWVzdEFuaW1hdGlvbkZyYW1lIl0sIGMuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBjW2FbYl0gKyAiQ2FuY2VsQW5pbWF0aW9uRnJhbWUiXSB8fCBjW2FbYl0gKyAiQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIl07CiAgICAgICAgICAgICAgICAgICAgICAgIGMucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IChjLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChhLCAxRTMgLyA2MCkKICAgICAgICAgICAgICAgICAgICAgICAgfSwgYy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KSgpOwogICAgICAgICAgICAgICAgICAgIHZhciB2YyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPCBlICYmIChhID0gZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGYgJiYgKGEgPSBmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oKGEgLSBlKSAvIDMyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGMoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPCBnICYmIChhID0gZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA+IGggJiYgKGEgPSBoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gfn4oKGEgLSBnKSAvIDMyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLnphLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBhLkFhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhLnhhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBhLnlhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPSB+figoZiAtIGUpIC8gMzIpICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gfn4oKGggLSBnKSAvIDMyKSArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IEFycmF5KGsgKiBtKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGE6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoYS54KSArIGMoYS55KSAqIGs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT0gbltlXSA/IG5bZV0gPSBhIDogQXJyYXkuaXNBcnJheShuW2VdKSA/IG5bZV0ucHVzaChhKSA6IG5bZV0gPSBbbltlXSwgYV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVhOiBmdW5jdGlvbiAoYSwgZSwgZywgZiwgaCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IGIoYSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ID0gYyhlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGIoYSArIGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gYyhlICsgZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID4gcCB8fCBwID49IGsgfHwgMCA+IHUgfHwgdSA+PSBtKSBkZWJ1Z2dlcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7IHUgPD0gZTsgKyt1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChmID0gcDsgZiA8PSBhOyArK2YpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGcgPSBuW2YgKyB1ICoga10sIG51bGwgIT0gZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGcubGVuZ3RoOyBsKyspIGgoZ1tsXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaChnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIFRiID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgY2EoMCwgMCwgMCwgMzIsICIjRUQxQzI0IiwgIiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIud2lkdGggPSAzMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuaGVpZ2h0ID0gMzI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGIuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IHEubGVuZ3RoICYmIChhLmNvbG9yID0gcVswXS5jb2xvciwgYS5BKHFbMF0ubmFtZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuY2xlYXJSZWN0KDAsIDAsIDMyLCAzMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy50cmFuc2xhdGUoMTYsIDE2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnNjYWxlKC40LCAuNCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53KGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMucmVzdG9yZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZhdmljb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IGUuY2xvbmVOb2RlKCEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnLnNldEF0dHJpYnV0ZSgiaHJlZiIsIGIudG9EYXRhVVJMKCJpbWFnZS9wbmciKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChnLCBlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KCk7CiAgICAgICAgICAgICAgICAgICAgZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFRiKCkKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB2YXIgV2EgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRQcm92aWRlcjogImZhY2Vib29rIiwKICAgICAgICAgICAgICAgICAgICAgICAgbG9naW5JbnRlbnQ6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvY2lhbFRva2VuOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5FeHBpcmVzOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhwTmVlZGVkOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGljdHVyZTogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZWRJbjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc29jaWFsSWQ6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBoID0gYy5kZWZhdWx0U3QgPSBXYTsKICAgICAgICAgICAgICAgICAgICBjLnN0b3JhZ2VJbmZvID0gaDsKICAgICAgICAgICAgICAgICAgICBjLmNyZWF0ZURlZmF1bHRTdG9yYWdlID0gUGM7CiAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlID0gWGE7CiAgICAgICAgICAgICAgICAgICAgZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gYy5sb2NhbFN0b3JhZ2Uuc3RvcmVPYmplY3RJbmZvICYmIChoID0gSlNPTi5wYXJzZShjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm8pKTsKICAgICAgICAgICAgICAgICAgICAgICAgIjEiID09IGgubG9naW5JbnRlbnQgJiYgZmMoaC5jb250ZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgIiIgPT0gaC51c2VySW5mby5uYW1lICYmICIiID09IGgudXNlckluZm8uZGlzcGxheU5hbWUgfHwgZ2MoaC51c2VySW5mbykKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjLmNoZWNrTG9naW5TdGF0dXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICIxIiA9PSBoLmxvZ2luSW50ZW50ICYmIChZYSgpLCBmYyhoLmNvbnRleHQpKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIFlhID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBjLk1DLnNldFByb2ZpbGVQaWN0dXJlKGgudXNlckluZm8ucGljdHVyZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGMuTUMuc2V0U29jaWFsSWQoaC51c2VySW5mby5zb2NpYWxJZCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMubG9nb3V0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBoID0gV2E7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjLmxvY2FsU3RvcmFnZS5zdG9yZU9iamVjdEluZm87CiAgICAgICAgICAgICAgICAgICAgICAgIGMubG9jYWxTdG9yYWdlLnN0b3JlT2JqZWN0SW5mbyA9IEpTT04uc3RyaW5naWZ5KFdhKTsKICAgICAgICAgICAgICAgICAgICAgICAgWGEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2MoKTsKICAgICAgICAgICAgICAgICAgICAgICAgbS5jYWNoZS5zZW50R2FtZVNlcnZlckxvZ2luID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtLmNhY2hlLmxvZ2luX2luZm87CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtbG9nZ2VkLWluIiwgIjAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1oYXMtYWNjb3VudC1kYXRhIiwgIjAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnRpbWVyIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNnUGx1c1NoYXJlIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjZmJTaGFyZSIpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3VzZXItaWQtdGFnIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIFEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5NQy5kb0xvZ291dCgpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnRvZ2dsZVNvY2lhbExvZ2luID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc29jaWFsTG9naW5Db250YWluZXIiKS50b2dnbGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NldHRpbmdzIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjaW5zdHJ1Y3Rpb25zIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBDYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBjLnRvZ2dsZVNldHRpbmdzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlKCIjc2V0dGluZ3MiKS50b2dnbGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI3NvY2lhbExvZ2luQ29udGFpbmVyIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBlKCIjaW5zdHJ1Y3Rpb25zIikuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBDYigpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBtLmFjY291bnQgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiKCkgeyB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEhhLkwoKSArICIgZ290IHVzZXIgbG9naW4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGYgfHwgZi5pZCAhPSBiLmlkKSBmID0gYiwgbnVsbCAhPSBjLnNzYV9qc29uICYmIChjLnNzYV9qc29uLmFwcGxpY2F0aW9uVXNlcklkID0gIiIgKyBiLmlkLCBjLnNzYV9qc29uLmN1c3RvbV91c2VyX2lkID0gIiIgKyBiLmlkKSwgInVuZGVmaW5lZCIgIT0gdHlwZW9mIFNTQV9DT1JFICYmIFNTQV9DT1JFLnN0YXJ0KCksIGUoIiNvZmZlcndhbGxJZnJhbWUiKS5hdHRyKCJzcmMiLCAiaHR0cDovL3d3dy5zdXBlcnNvbmljYWRzLmNvbS9kZWxpdmVyeS9wYW5lbC5waHA/YXBwbGljYXRpb25LZXk9IiArIEVudkNvbmZpZy5zdXBlcnNvbmljX2FwcF9rZXkgKyAiJmFwcGxpY2F0aW9uVXNlcklkPSIgKyBiLmlkICsgIiZjdXN0b21fdXNlcl9pZD0iICsgYi5pZCArICImYXBwbGljYXRpb25Vc2VySWRTaWduYXR1cmU9b3B0aW9uYWwiKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgYS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jb3JlLmJpbmQoInVzZXJfbG9naW4iLCBkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uY29yZS5iaW5kKCJ1c2VyX2xvZ291dCIsIGIpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuc2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2MoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zZXRBY2NvdW50RGF0YSA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGUoIiNoZWxsb0NvbnRhaW5lciIpLmF0dHIoImRhdGEtaGFzLWFjY291bnQtZGF0YSIsICIxIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnVzZXJJbmZvLnhwID0gYS54cDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ueHBOZWVkZWQgPSBhLnhwTmVlZGVkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC51c2VySW5mby5sZXZlbCA9IGEubGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBYYSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyAmJiBiID8gZ2EoYSkgOiAoZSgiLmFnYXJpby1wcm9maWxlLXBhbmVsIC5wcm9ncmVzcy1iYXItc3RhciIpLnRleHQoYS5sZXZlbCksIGUoIi5hZ2FyaW8tZXhwLWJhciAucHJvZ3Jlc3MtYmFyLXRleHQiKS50ZXh0KGEueHAgKyAiLyIgKyBhLnhwTmVlZGVkICsgIiBYUCIpLCBlKCIuYWdhcmlvLWV4cC1iYXIgLnByb2dyZXNzLWJhciIpLmNzcygid2lkdGgiLCAoODggKiBhLnhwIC8gYS54cE5lZWRlZCkudG9GaXhlZCgyKSArICIlIikpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuR2EgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2EoYSkKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KHt9KTsKICAgICAgICAgICAgICAgICAgICB2YXIgaWMgPSAwOwogICAgICAgICAgICAgICAgICAgIGMuZmJBc3luY0luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsID09IGMuRkIgPyBhbGVydCgiWW91IHNlZW0gdG8gaGF2ZSBzb21ldGhpbmcgYmxvY2tpbmcgRmFjZWJvb2sgb24geW91ciBicm93c2VyLCBwbGVhc2UgY2hlY2sgZm9yIGFueSBleHRlbnNpb25zIikgOiAoaC5sb2dpbkludGVudCA9ICIxIiwgYy51cGRhdGVTdG9yYWdlKCksIGMuRkIubG9naW4oZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYyhhKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAicHVibGljX3Byb2ZpbGUsIGVtYWlsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYy5GQi5pbml0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcElkOiBFbnZDb25maWcuZmJfYXBwX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhmYm1sOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAidjIuMiIKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICgiMSIgPT0gYy5zdG9yYWdlSW5mby5sb2dpbkludGVudCAmJiAiZmFjZWJvb2siID09IGMuc3RvcmFnZUluZm8uY29udGV4dCB8fCBuYykgJiYgYy5GQi5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbiAoYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbm5lY3RlZCIgPT09IGIuc3RhdHVzID8gaGMoYikgOiAibm90X2F1dGhvcml6ZWQiID09PSBiLnN0YXR1cyA/IChjLmxvZ291dCgpLCBhKCkpIDogYy5sb2dvdXQoKQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5mYWNlYm9va1JlbG9naW4gPSBhOwogICAgICAgICAgICAgICAgICAgICAgICBjLmZhY2Vib29rTG9naW4gPSBhCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgSGIgPSAhMTsKICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuYXN5bmMgPSAhMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuc3JjID0gIi8vYXBpcy5nb29nbGUuY29tL2pzL2NsaWVudDpwbGF0Zm9ybS5qcz9vbmxvYWQ9Z2FwaUFzeW5jSW5pdCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSwgYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gITAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9ICExOwogICAgICAgICAgICAgICAgICAgICAgICBjLmdhcGlBc3luY0luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKGQpLnRyaWdnZXIoImluaXRpYWxpemVkIikKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5nb29nbGUgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhOiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS5jbGllbnQubG9hZCgicGx1cyIsICJ2MSIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImZldGNoaW5nIG1lIHByb2ZpbGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FwaS5jbGllbnQucGx1cy5wZW9wbGUuZ2V0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogIm1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5leGVjdXRlKGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiKGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5EYSA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIHx8IGIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9PSB0eXBlb2YgZ2FwaSA/IGEoKSA6IGUoZCkuYmluZCgiaW5pdGlhbGl6ZWQiLCBhKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0pKG0pOwogICAgICAgICAgICAgICAgICAgIHZhciBhZCA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGIoYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5NQy5kb0xvZ2luV2l0aEdQbHVzKGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5jYWNoZS5sb2dpbl9pbmZvID0gW2EsICJnb29nbGUiXQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgudXNlckluZm8ucGljdHVyZSA9IGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIuYWdhcmlvLXByb2ZpbGUtcGljdHVyZSIpLmF0dHIoInNyYyIsIGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfaWQ6IEVudkNvbmZpZy5ncGx1c19jbGllbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29va2llX3BvbGljeTogInNpbmdsZV9ob3N0X29yaWdpbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGU6ICJwcm9maWxlIGVtYWlsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgYS5mYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9hOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gaCAmJiAiMSIgPT0gaC5sb2dpbkludGVudCAmJiAiZ29vZ2xlIiA9PSBoLmNvbnRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5EYShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2FwaS55dHN1YnNjcmliZS5nbygiYWdhcllvdXR1YmUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5nYXBpLmxvYWQoImF1dGgyIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGMuZ2FwaS5hdXRoMi5pbml0KGcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5hdHRhY2hDbGlja0hhbmRsZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdwbHVzTG9naW4iKSwge30sIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImdvb2dsZVVzZXIgOiAiICsgYSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBsb2dpbiBpbiBnb29nbGUgcGx1czogIiwgSlNPTi5zdHJpbmdpZnkoYSwgdm9pZCAwLCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5jdXJyZW50VXNlci5saXN0ZW4oXy5iaW5kKGEuQ2EsIGEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgMSA9PSBmLmlzU2lnbmVkSW4uZ2V0KCkgJiYgZi5zaWduSW4oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2E6IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYgJiYgYSAmJiBmLmlzU2lnbmVkSW4uZ2V0KCkgJiYgIUhiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhiID0gITA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgubG9naW5JbnRlbnQgPSAiMSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gYS5nZXRBdXRoUmVzcG9uc2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBlLmFjY2Vzc190b2tlbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5vYSA9IGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2dnZWRJbiB3aXRoIEcrISIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IGEuZ2V0QmFzaWNQcm9maWxlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBsLmdldEltYWdlVXJsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PSBhID8gbS5nb29nbGUuc2EoZSwgZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVzdWx0LmlzUGx1c1VzZXIgPyAoYSAmJiBkKGEuaW1hZ2UudXJsKSwgYihnKSwgYSAmJiAoaC51c2VySW5mby5waWN0dXJlID0gYS5pbWFnZS51cmwpLCBoLnVzZXJJbmZvLnNvY2lhbElkID0gbC5nZXRJZCgpLCBZYSgpKSA6IChhbGVydCgiUGxlYXNlIGFkZCBHb29nbGUrIHRvIHlvdXIgR29vZ2xlIGFjY291bnQgYW5kIHRyeSBhZ2Fpbi5cbk9yIHlvdSBjYW4gbG9naW4gd2l0aCBhbm90aGVyIGFjY291bnQuIiksIGMubG9nb3V0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogKGQoYSksIGgudXNlckluZm8ucGljdHVyZSA9IGEsIGgudXNlckluZm8uc29jaWFsSWQgPSBsLmdldElkKCksIFlhKCksIGIoZykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmNvbnRleHQgPSAiZ29vZ2xlIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy51cGRhdGVTdG9yYWdlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2E6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICYmIChmLnNpZ25PdXQoKSwgSGIgPSAhMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEKICAgICAgICAgICAgICAgICAgICB9KG0pOwogICAgICAgICAgICAgICAgICAgIGMuZ3BsdXNNb2R1bGUgPSBhZDsKICAgICAgICAgICAgICAgICAgICB2YXIgc2MgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uZmEud2EoKQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5sb2dvdXRHb29nbGVQbHVzID0gc2M7CiAgICAgICAgICAgICAgICAgICAgdmFyIFpjID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKGEsIGIsIGMsIGQsIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gYi5nZXRDb250ZXh0KCIyZCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBiLndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGIuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5jb2xvciA9IGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLkEoYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNpemUgPSBkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5zYXZlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnRyYW5zbGF0ZShnIC8gMiwgYiAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS53KGYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5yZXN0b3JlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gbmV3IGNhKC0xLCAwLCAwLCAzMiwgIiM1YmMwZGUiLCAiIiksIGMgPSBuZXcgY2EoLTEsIDAsIDAsIDMyLCAiIzViYzBkZSIsICIiKSwgZiA9ICIjMDc5MWZmICM1YTA3ZmYgI2ZmMDdmZSAjZmZhNTA3ICNmZjA3NzQgIzA3N2ZmZiAjM2FmZjA3ICNmZjA3ZWQgIzA3YThmZiAjZmYwNzZlICMzZmZmMDcgI2ZmMDczNCAjMDdmZjIwICNmZjA3YTIgI2ZmODIwNyAjMDdmZjBlIi5zcGxpdCgiICIpLCBnID0gW10sIGggPSAwOyBoIDwgZi5sZW5ndGg7ICsraCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBoIC8gZi5sZW5ndGggKiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrID0gMzAgKiBNYXRoLnNxcnQoaCAvIGYubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcucHVzaChuZXcgY2EoLTEsIE1hdGguY29zKGwpICogaywgTWF0aC5zaW4obCkgKiBrLCAxMCwgZltoXSwgIiIpKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIE9jKGcpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgICAgICAgICAgICAgICAgICBtLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG0ud2lkdGggPSBtLmhlaWdodCA9IDcwOwogICAgICAgICAgICAgICAgICAgICAgICBhKGMsIG0sICIiLCAyNiwgIiNlYmMwZGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIi5jZWxsLXNwaW5uZXIiKS5maWx0ZXIoIjp2aXNpYmxlIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBlKHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSB0aGlzLmhlaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCA9IHRoaXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLmNsZWFyUmVjdCgwLCAwLCBmLCBnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnNhdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnRyYW5zbGF0ZShmIC8gMiwgZyAvIDIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyAxMCA+IGs7ICsraykgaC5kcmF3SW1hZ2UobSwgKC4xICogZCArIDgwICogaykgJSAoZiArIDE0MCkgLSBmIC8gMiAtIDcwIC0gMzUsIGcgLyAyICogTWF0aC5zaW4oKC4wMDEgKiBkICsgaykgJSBNYXRoLlBJICogMikgLSAzNSwgNzAsIDcwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoLnJlc3RvcmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYyA9IGMuYXR0cigiZGF0YS1pdHIiKSkgJiYgKGMgPSBSKGMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhKGIsIHRoaXMsIGMgfHwgIiIsICtlKHRoaXMpLmF0dHIoImRhdGEtc2l6ZSIpLCAiIzViYzBkZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzdGF0c1BlbGxldHMiKS5maWx0ZXIoIjp2aXNpYmxlIikuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSh0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENvbnRleHQoIjJkIikuY2xlYXJSZWN0KDAsIDAsIGIsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCBnLmxlbmd0aDsgYisrKSBhKGdbYl0sIHRoaXMsICIiLCBnW2JdLnNpemUsIGdbYl0uY29sb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSgpOwogICAgICAgICAgICAgICAgICAgIGMuY3JlYXRlUGFydHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGthKCI6cGFydHkiKTsKICAgICAgICAgICAgICAgICAgICAgICAgUyA9IGZ1bmN0aW9uIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYigiLyMiICsgYy5lbmNvZGVVUklDb21wb25lbnQoYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSgiLnBhcnR5VG9rZW4iKS52YWwoImFnYXIuaW8vIyIgKyBjLmVuY29kZVVSSUNvbXBvbmVudChhKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKCIjaGVsbG9Db250YWluZXIiKS5hdHRyKCJkYXRhLXBhcnR5LXN0YXRlIiwgIjEiKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBRKCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuam9pblBhcnR5ID0gamM7CiAgICAgICAgICAgICAgICAgICAgYy5jYW5jZWxQYXJ0eSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgRGIoIi8iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZSgiI2hlbGxvQ29udGFpbmVyIikuYXR0cigiZGF0YS1wYXJ0eS1zdGF0ZSIsICIwIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGthKCIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgUSgpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgRiA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICB1YiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHZiID0gIiMwMDAwMDAiLAogICAgICAgICAgICAgICAgICAgICAgICBhYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBFYSA9ICExLAogICAgICAgICAgICAgICAgICAgICAgICBSYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIEViID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgeGIgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB3YiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIFcgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBaYSA9ICEwOwogICAgICAgICAgICAgICAgICAgIGMub25QbGF5ZXJEZWF0aCA9IEphOwogICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgRWEgJiYgRi5wdXNoKGFjKCkgLyAxMDApCiAgICAgICAgICAgICAgICAgICAgfSwgMUUzIC8gNjApOwogICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBSYygpOwogICAgICAgICAgICAgICAgICAgICAgICAwICE9IGEgJiYgKCsreGIsIDAgPT0gVyAmJiAoVyA9IGEpLCBXID0gTWF0aC5taW4oVywgYSkpCiAgICAgICAgICAgICAgICAgICAgfSwgMUUzKTsKICAgICAgICAgICAgICAgICAgICBjLmNsb3NlU3RhdHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFhID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIGUoIiNzdGF0cyIpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5kZXN0cm95QWQoYy5hZFNsb3RzLmFiKTsKICAgICAgICAgICAgICAgICAgICAgICAgeWEoMCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc2V0U2tpcFN0YXRzID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgWmEgPSAhYQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5nZXRTdGF0c1N0cmluZyA9IGxjOwogICAgICAgICAgICAgICAgICAgIGMuZ1BsdXNTaGFyZSA9IFRjOwogICAgICAgICAgICAgICAgICAgIGMudHdpdHRlclNoYXJlU3RhdHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gYy5nZXRTdGF0c1N0cmluZygidHRfc2hhcmVfc3RhdHMiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5vcGVuKCJodHRwczovL3R3aXR0ZXIuY29tL2ludGVudC90d2VldD90ZXh0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSwgIkFnYXIuaW8iLCAid2lkdGg9NjYwLGhlaWdodD0zMTAsbWVudWJhcj1ubyx0b29sYmFyPW5vLHJlc2l6YWJsZT15ZXMsc2Nyb2xsYmFycz1ubyxsZWZ0PSIgKyAoYy5zY3JlZW5YICsgYy5pbm5lcldpZHRoIC8gMiAtIDMzMCkgKyAiLHRvcD0iICsgKGMuaW5uZXJIZWlnaHQgLSAzMTApIC8gMikKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuZmJTaGFyZVN0YXRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGMuZ2V0U3RhdHNTdHJpbmcoImZiX21hdGNocmVzdWx0c19zdWJ0aXRsZSIpOwogICAgICAgICAgICAgICAgICAgICAgICBjLkZCLnVpKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogImZlZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogImlmcmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBSKCJmYl9tYXRjaHJlc3VsdHNfdGl0bGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb246IFIoImZiX21hdGNocmVzdWx0c19kZXNjcmlwdGlvbiIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiAiaHR0cDovL2FnYXIuaW8iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSmE6ICJodHRwOi8vc3RhdGljMi5taW5pY2xpcGNkbi5jb20vbW9iaWxlL2FnYXIvQWdhci5pb19tYXRjaHJlc3VsdHNfZmJfMTIwMHg2MzAucG5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInBsYXkgbm93ISIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogImh0dHA6Ly9hZ2FyLmlvIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgYy5maWxsU29jaWFsVmFsdWVzID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgMSA9PSBjLmlzQ2hyb21lICYmICJnb29nbGUiID09IGMuc3RvcmFnZUluZm8uY29udGV4dCAmJiBjLmdhcGkuaW50ZXJhY3RpdmVwb3N0LnJlbmRlcihiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50dXJsOiBFbnZDb25maWcuZ2FtZV91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRpZDogRW52Q29uZmlnLmdwbHVzX2NsaWVudF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXBvbGljeTogImh0dHA6Ly9hZ2FyLmlvIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZWZpbGx0ZXh0OiBhLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbHRvYWN0aW9ubGFiZWw6ICJCRUFUIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGx0b2FjdGlvbnVybDogRW52Q29uZmlnLmdhbWVfdXJsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIk1Bc3luY0luaXQiIGluIGMgJiYgYy5NQXN5bmNJbml0KCkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBPUklHSU5BTCBTQ1JJUFQKICAgICAgICAgICAgdmFyIHdpbmRvID0gYzsKICAgICAgICAgICAgdmFyIG1mZ2ggPSBmYWxzZTsKICAgICAgICAgICAgdmFyIHN0b3BNb3ZlID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBhdXRvRmVlZEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgYXV0b1NwbGl0SW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBzZW5kQnVmZmVyID0gVjsKICAgICAgICAgICAgdmFyIHNlbmRWYWwgPSBYOwogICAgICAgICAgICAvL0FHQVJCT1RPVkggbW9kaWYgSWIgcG91ciBsYSBt6XRob2RlIHF1aSBmYWl0IGxlcyBvbmtleXVwIG9ua2V5ZG93bgogICAgICAgICAgICBJYiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHdpbmRvLm9ua2V5dXAgPSBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgIDMyID09IGEua2V5Q29kZSAmJiAodmEgPSAhMSk7CiAgICAgICAgICAgICAgICAgICAgODcgPT0gYS5rZXlDb2RlICYmICh4YSA9ICExKTsKICAgICAgICAgICAgICAgICAgICA4MSA9PSBhLmtleUNvZGUgJiYgd2EgJiYgKFgoMTkpLCB3YSA9ICExKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd2luZG8ub25rZXlkb3duID0gZnVuY3Rpb24gKGEpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygna2V5RG93bicsIGEpOwogICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDY5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlbWl0IHNwbGl0ICEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYmd6LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbiI6IDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaXAiIDogaXBfY2xpZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA4MikgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZW1pdCBmZWVkICEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYmd6LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbiI6IDMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaXAiIDogaXBfY2xpZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDg0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1mZ2ggPSAhbWZnaDsKCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vdXNlX29mZicpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWZnaCkgeyBiLmlubmVySFRNTCA9ICdPTic7IGIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJzsgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1mZ2gpIHsgYi5pbm5lckhUTUwgPSAnT0ZGJzsgYi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJzsgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAzMiAhPSBhLmtleUNvZGUgfHwgdmEgfHwgKCJuaWNrIiAhPSBhLnRhcmdldC5pZCAmJiBhLnByZXZlbnREZWZhdWx0KCksIGViKCksIHZhID0gITApOwogICAgICAgICAgICAgICAgICAgIDgxID09IGEua2V5Q29kZSAmJiAoWCgxOCksIHdhID0gITApOwogICAgICAgICAgICAgICAgICAgIDg3ICE9IGEua2V5Q29kZSB8fCB4YSB8fCAoSmIoKSwgeGEgPSAhMCk7CiAgICAgICAgICAgICAgICAgICAgMjcgPT0gYS5rZXlDb2RlICYmIChhLnByZXZlbnREZWZhdWx0KCksIHlhKDMwMCksIGUoIiNvZmVyd2FsbENvbnRhaW5lciIpLmlzKCI6dmlzaWJsZSIpICYmIGMuY2xvc2VPZmZlcndhbGwoKSwgZSgiI3ZpZGVvQ29udGFpbmVyIikuaXMoIjp2aXNpYmxlIikgJiYgYy5jbG9zZVZpZGVvQ29udGFpbmVyKCkpCiAgICAgICAgICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSA4MyAmJiAibmljayIgIT0gYS50YXJnZXQuaWQpIHsvLyBzCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRvRmVlZEludGVydmFsID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9GZWVkSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFZhbCgyMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b0ZlZWRJbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvRmVlZEludGVydmFsID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEua2V5Q29kZSA9PSAzMiAmJiBhLnNoaWZ0S2V5ICYmICJuaWNrIiAhPSBhLnRhcmdldC5pZCkgey8vIHMKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3NwYWNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBudW1iZXIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0b1NwbGl0SW50ZXJ2YWwgPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1NwbGl0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFZhbCgxNyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bWJlciA9PSA3KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NwbGl0SW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvU3BsaXRJbnRlcnZhbCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b1NwbGl0SW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b1NwbGl0SW50ZXJ2YWwgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaCgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5rZXlDb2RlID09IDY4ICYmICJuaWNrIiAhPSBhLnRhcmdldC5pZCkgey8vIEQKICAgICAgICAgICAgICAgICAgICAgICAgc3RvcE1vdmUgPSAhc3RvcE1vdmU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vdmVfb2ZmJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdG9wTW92ZSkgeyBpLmlubmVySFRNTCA9ICdPTic7IGkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJzsgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN0b3BNb3ZlKSB7IGkuaW5uZXJIVE1MID0gJ09GRic7IGkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JlZCc7IH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnU1RPUE1PVkUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgLyoKICAgICAgICAgICAgICAgICAgICAgICAgICogY29uc29sZS5sb2coJ0x0JyxMdCk7IGNvbnNvbGUubG9nKCdFdCcsRXQpOyBjb25zb2xlLmxvZygnVHQnLFR0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICogY29uc29sZS5sb2coJ3d0Jyx3dCk7IGNvbnNvbGUubG9nKCdQdCcsUHQpOyBjb25zb2xlLmxvZygnQ3QnLEN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgY29ubmVjdGVkID0gZmFsc2U7CgogICAgICAgICAgICB2YXIgYnQgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBpcCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIHJvb20gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBiZ3ogPSBuZXcgV2ViU29ja2V0KCd3czovLzE3OC4yNTQuNzIuMjI6ODA4MScsICdkLWJvdHMtcHJvdG9jb2wnKTsKICAgICAgICAgICAgdmFyIG1pbiA9IDAsCiAgICAgICAgICAgICAgICBob3VyID0gMCwKICAgICAgICAgICAgICAgIGRheXMgPSAwOwogICAgICAgICAgICBmdW5jdGlvbiBzdGFydFRpbWVyX3RpbWVfbGVmdCgpIHsKCiAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lX2xlZnQnKTsKICAgICAgICAgICAgICAgIHhtaCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG1pbiA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWluLS07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuaW5uZXJIVE1MID0gZGF5cyArICdkICcgKyBob3VyICsgJ2ggJyArIG1pbiArICdtaW4nOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChob3VyID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluID0gNjA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3VyLS07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmlubmVySFRNTCA9IGRheXMgKyAnZCAnICsgaG91ciArICdoICcgKyBtaW4gKyAnbWluJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXlzID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvdXIgPSAyMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW4gPSA2MDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlzLS07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5pbm5lckhUTUwgPSBkYXlzICsgJ2QgJyArIGhvdXIgKyAnaCAnICsgbWluICsgJ21pbic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuaW5uZXJIVE1MID0gJ05vIFRpbWUgbGVmdCAhJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB9LCA2MDAwMCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJnei5vbmNsb3NlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JvdF9jb3VudCcpLmlubmVySFRNTCA9ICdEaXNjb25uZWN0ZWQnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RpbWVfbGVmdCcpLmlubmVySFRNTCA9ICdEaXNjb25uZWN0ZWQnOwogICAgICAgICAgICAgICAgY29ubmVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmd6Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3Rpb24gZXJyb3IgIScgKyBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBiZ3oub25tZXNzYWdlID0gZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShtc2cuZGF0YSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAxKSB7IC8vIHRpbWUgbGVmdCAgIAogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdUaW1lIGFjdGlvbiAhIScpOwogICAgICAgICAgICAgICAgICAgIG1pbiA9IGRhdGEubWludXRlczsKICAgICAgICAgICAgICAgICAgICBob3VyID0gZGF0YS5ob3VyczsKICAgICAgICAgICAgICAgICAgICBkYXlzID0gZGF0YS5kYXlzOwogICAgICAgICAgICAgICAgICAgIHZmZyA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5jb250YWlucyhkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZV9sZWZ0JykpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZV9sZWZ0JykuaW5uZXJIVE1MID0gZGF5cyArICdkICcgKyBob3VyICsgJ2ggJyArIG1pbiArICdtaW4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lcl90aW1lX2xlZnQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodmZnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7CgogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLmFjdGlvbiA9PSAyKSB7IC8vIGJvdCBjb3VudCsrCiAgICAgICAgICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib3RfY291bnQnKS5pbm5lckhUTUwgPSBjb3VudDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5hY3Rpb24gPT0gMykgeyAvLyBib3QgY291bnQtLQogICAgICAgICAgICAgICAgICAgIGNvdW50LS07CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm90X2NvdW50JykuaW5uZXJIVE1MID0gY291bnQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChkYXRhLmFjdGlvbiA9PSAxMikgewogICAgICAgICAgICAgICAgICAgIGlwX2NsaWVudCA9IGRhdGEuaXA7CiAgICAgICAgICAgICAgICAgICAgdmZsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuY29udGFpbnMoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lwX3RleHQnKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpcF90ZXh0JykuaW5uZXJIVE1MID0gZGF0YS5pcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodmZsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmd6Lm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGNvbm5lY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB2ZHIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNvbnRhaW5zKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lX2xlZnQnKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZV9sZWZ0JykuaW5uZXJIVE1MID0gJ05vIFRpbWUgbGVmdCAhJzsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh2ZHIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDIwMCk7CgogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgY2hhbmdlR2FtZU1vZGUgPSBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgICAgICAgcmVmcmVzaCgpOwogICAgICAgICAgICB9OwogICAgICAgICAgICB4dCA9IGZhbHNlOwoKICAgICAgICAgICAgdmFyIHNldFR4dCA9IGZ1bmN0aW9uIChpbmZvcywgYWcpIHsKICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWluaW9ucyIpID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3RpbWVvdXQnLGluZm9zKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VHh0KGluZm9zLCBhZyk7CiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWluaW9ucyIpOwogICAgICAgICAgICAgICAgICAgIGlmIChhZykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYi5zdHlsZS5jc3NUZXh0LmluY2x1ZGVzKCdmb250LXNpemUnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBpbmZvcy50eHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnN0eWxlLmNzc1RleHQucmVwbGFjZSgnY29sb3IgOiByZWQnLCAnY29sb3I6IGdyZWVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnN0eWxlLmNzc1RleHQgKz0gImZvbnQtc2l6ZSA6IDE1MCU7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuaW5uZXJIVE1MID0gaW5mb3MudHh0OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBpbmZvcy50eHQ7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCgogICAgICAgICAgICB2YXIgc2V0SW5mb3MgPSBmdW5jdGlvbiAodHh0LCBjbG9zZU1lc3MpIHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0eHQiKTsKICAgICAgICAgICAgICAgIGlmIChlbCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBlbC5pZCA9ICd0eHQnOwogICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlLmNzc1RleHQgPSAiZGlzcGxheTpub25lOyI7CiAgICAgICAgICAgICAgICAgICAgZWwuaW5uZXJUZXh0ID0gSlNPTi5zdHJpbmdpZnkoeyB0eHQ6ICcnLCBjbG9zZU1lc3M6IHRydWUgfSk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShlbC5pbm5lclRleHQpOwogICAgICAgICAgICAgICAgaWYgKHR4dCAhPSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgb2JqLnR4dCA9IHR4dDsKICAgICAgICAgICAgICAgIGlmIChjbG9zZU1lc3MgIT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgICAgICAgIG9iai5jbG9zZU1lc3MgPSBjbG9zZU1lc3M7CiAgICAgICAgICAgICAgICBlbC5pbm5lclRleHQgPSBKU09OLnN0cmluZ2lmeShvYmopOwogICAgICAgICAgICB9OwogICAgICAgICAgICB2YXIgZ2V0SW5mb3MgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidHh0Iik7CiAgICAgICAgICAgICAgICBpZiAoZWwgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZWwuaWQgPSAndHh0JzsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5jc3NUZXh0ID0gImRpc3BsYXk6bm9uZTsiOwogICAgICAgICAgICAgICAgICAgIGVsLmlubmVyVGV4dCA9IEpTT04uc3RyaW5naWZ5KHsgdHh0OiAnJywgY2xvc2VNZXNzOiB0cnVlIH0pOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZWwuaW5uZXJUZXh0KTsKICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGVsLmlubmVyVGV4dCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciByZWZyZXNoID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB3aW5kb3cubGFzdE1lc3NhZ2U7CiAgICAgICAgICAgICAgICBpZiAodCA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgaWYgKHJvb20gIT0gdW5kZWZpbmVkICYmIHJvb20ubGVuZ3RoID4gMTApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjbXNndHh0JykuaHRtbCgnQk9UUyBPTkxZIFdPUksgSU4gUEFSVFkgTU9ERScpOwogICAgICAgICAgICAgICAgICAgIHNob3dSZW1haW5pbmcoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodC5ub3BlKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI21zZ3R4dCcpLmh0bWwoJzxhIGhyZWY9Imh0dHA6Ly9hZ2FyYm90Lm92aCIgdGFyZ2V0PSJfYmxhbmMiPk5vIHBsYW4gYWN0aXZlICZndDsgYWdhcmJvdC5vdmggKGRpZCB5b3UgcmVmcmVzaCBJUCA/KTwvYT4nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5hbHJlYWR5Q29ubmVjdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI21zZ3R4dCcpLmh0bWwoJ0FscmVhZHkgb24gYW5vdGhlciBnYW1lIChyZWZyZXNoIHBhZ2UpJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuc3BlY2lhbCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc2V0dGluZyBzcGVjaWFsJyk7CiAgICAgICAgICAgICAgICAgICAgJCgnI21zZ3R4dCcpLmh0bWwodC5zcGVjaWFsKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2FkaW5nc2V0ID09IHVuZGVmaW5lZCAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWdhcmJvdF9sZWZ0Ym94JykgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhZ2FyYm90X2xlZnRib3gnKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNob3RrZXlzJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyQoIi5hZ2FyYm90b3ZoX3Byb2dyZXNzLWJhciIpLmxvYWRpbmcoKTsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvYWRpbmdzZXQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkKCcjbXNndHh0JykuaHRtbCgnJyk7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmV4cGlyZSA9IHQuZXhwaXJlOwogICAgICAgICAgICAgICAgICAgIHZhciBleHBpcmUgPSBuZXcgRGF0ZSh0LmV4cGlyZSk7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2V4cGlyZSAnLHQuZXhwaXJlKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYm90c0F2YWlsYWJsZSA9IHQuYm90c0F2YWlsYWJsZTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWJvdHNBdmFpbGFibGUpCiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNtc2d0eHQnKS5odG1sKCdObyBib3RzIGF2YWlsYWJsZS4uLiByZXRyeWluZycpOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyByZWQgRkYzMzMzCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdyZWVuIDMzRkYzMwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuam9pbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHh0ID0gJ0JvdHMgJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmN1cnJlbnRCb3RzID09IHQubWF4Qm90cykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gJzxzcGFuIHN0eWxlPSJjb2xvcjojMzNGRjMzIj4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAnPHNwYW4+JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSB0LmN1cnJlbnRCb3RzICsgIiAvICIgKyB0Lm1heEJvdHMgKyAnPC9zcGFuPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjYm90cycpLmh0bWwodHh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjbXNndHh0JykuaHRtbCgnV2FpdGluZyBmb3IgeW91IHRvIGNsaWNrIHBsYXknKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNwaW5nJykuaHRtbCh3aW5kb3cucGluZyB8fCAnPycpOwoKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRvRmVlZEludGVydmFsID09IHVuZGVmaW5lZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhdXRvZmVlZCcpLnJlbW92ZUNsYXNzKCdhZ2FyYm90b3ZoX2dyZWVuJykuYWRkQ2xhc3MoJ2FnYXJib3RvdmhfcmVkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhdXRvZmVlZCcpLmFkZENsYXNzKCdhZ2FyYm90b3ZoX2dyZWVuJykucmVtb3ZlQ2xhc3MoJ2FnYXJib3RvdmhfcmVkJyk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RvcE1vdmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjc3RvcG1vdmUnKS5hZGRDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLnJlbW92ZUNsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjc3RvcG1vdmUnKS5yZW1vdmVDbGFzcygnYWdhcmJvdG92aF9ncmVlbicpLmFkZENsYXNzKCdhZ2FyYm90b3ZoX3JlZCcpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuYWxnbyA9PSAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FsZ28nKS5odG1sKCc8c3BhbiBzdHlsZT0iY29sb3I6IzJFOUJCRiI+RUFUIFBFTExFVFM8L3NwYW4+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHQuYWxnbyA9PSAyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2FsZ28nKS5odG1sKCc8c3BhbiBzdHlsZT0iY29sb3I6I0U4NjZFOCI+UlVOPC9zcGFuPicpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0LmFsZ28gPT0gMykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNhbGdvJykuaHRtbCgnPHNwYW4gc3R5bGU9ImNvbG9yOiM0M0RFMkYiPkNPTUUgVE8gTUVIPC9zcGFuPicpOwoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlcmNlbnQgPSAodC5lYXRzIC8gdC5zcGF3bnMgKiAxMDApOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4ocGVyY2VudCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50ID0gMDsKCiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNlZmZpY2llbmN5JykuaHRtbCgnRWZmaWNpZW5jeSA6IDxzcGFuIHRpdGxlPSJlYXRlbi9zcGF3bmVkPWVmZmljaWVuY3klIj4nICsgdC5lYXRzICsgJy8nICsgdC5zcGF3bnMgKyAnICA9ICcgKyBwZXJjZW50LnRvRml4ZWQoMikgKyAnJTwvc3Bhbj4nKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnBhcnR5RnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNtc2d0eHQnKS5odG1sKCdQYXJ0eSBwcm9iYWJseSBmdWxsJyk7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQuam9pbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHh0ID0gJ0pvaW4gdGhlIGdhbWUgYW5kIHRoZSBib3RzIHdpbGwgY29ubmVjdCAoJzsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm9vbSA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICc/Pz8nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4dCArPSAocm9vbS5sZW5ndGggPCAxMCA/ICdQQVJUWScgOiAnRkZBIE5PVCBXT1JLSU5HJyk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHh0ICs9ICcpJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNtc2d0eHQnKS5odG1sKHR4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzaG93UmVtYWluaW5nKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciBfc2Vjb25kID0gMTAwMDsKICAgICAgICAgICAgdmFyIF9taW51dGUgPSBfc2Vjb25kICogNjA7CiAgICAgICAgICAgIHZhciBfaG91ciA9IF9taW51dGUgKiA2MDsKICAgICAgICAgICAgdmFyIF9kYXkgPSBfaG91ciAqIDI0OwogICAgICAgICAgICBmdW5jdGlvbiBzaG93UmVtYWluaW5nKCkgewogICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKSA9PSB1bmRlZmluZWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5leHBpcmUgPT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5leHBpcmUgPT0gMCkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB2YXIgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IG5ldyBEYXRlKHdpbmRvdy5leHBpcmUpIC0gbm93OwogICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDwgMCkgewogICAgICAgICAgICAgICAgICAgIC8vY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnU0VORCBUSElTIFRPIE5FRUwnLG5ldyBEYXRlKCksbm93LG5ldyBEYXRlKHdpbmRvdy5leHBpcmUpLGRpc3RhbmNlKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MID0gJ0VYUElSRUQhJzsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgZGF5cyA9IE1hdGguZmxvb3IoZGlzdGFuY2UgLyBfZGF5KTsKICAgICAgICAgICAgICAgIHZhciBob3VycyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX2RheSkgLyBfaG91cik7CiAgICAgICAgICAgICAgICB2YXIgbWludXRlcyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX2hvdXIpIC8gX21pbnV0ZSk7CiAgICAgICAgICAgICAgICB2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3IoKGRpc3RhbmNlICUgX21pbnV0ZSkgLyBfc2Vjb25kKTsKCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MID0gZGF5cyArICdkYXlzICc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY291bnRkb3duJykuaW5uZXJIVE1MICs9IGhvdXJzICsgJ2hycyAnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvdW50ZG93bicpLmlubmVySFRNTCArPSBtaW51dGVzICsgJ21pbnMgJzsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3VudGRvd24nKS5pbm5lckhUTUwgKz0gc2Vjb25kcyArICdzZWNzJzsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7Ly8gQUdBUkJPVE9WSAogICAgICAgICAgICAgICAgc2hvd1JlbWFpbmluZygpOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgICAgZnVuY3Rpb24gZ290TmV3QmFsbChpZCkgewogICAgICAgICAgICAgICAgdmFyIGJhbGwgPSBudWxsOwogICAgICAgICAgICAgICAgZm9yIChpbmRleCBpbiBxKSB7Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHFbaW5kZXhdOwogICAgICAgICAgICAgICAgICAgIGlmIChiLmlkID09IGlkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGwgPSBiOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHh0KQogICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246IDEwLAogICAgICAgICAgICAgICAgICAgICAgICAnaWQnOiBpZCwKICAgICAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05FV0JBTEwnLCBpZCwgYmFsbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGhleFRvUmdiKGhleCkgewogICAgICAgICAgICAgICAgLy8gRXhwYW5kIHNob3J0aGFuZCBmb3JtIChlLmcuICIwM0YiKSB0byBmdWxsIGZvcm0gKGUuZy4gIjAwMzNGRiIpCiAgICAgICAgICAgICAgICB2YXIgc2hvcnRoYW5kUmVnZXggPSAvXiM/KFthLWZcZF0pKFthLWZcZF0pKFthLWZcZF0pJC9pOwogICAgICAgICAgICAgICAgaGV4ID0gaGV4LnJlcGxhY2Uoc2hvcnRoYW5kUmVnZXgsIGZ1bmN0aW9uIChtLCByLCBnLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIgKyByICsgZyArIGcgKyBiICsgYjsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAvXiM/KFthLWZcZF17Mn0pKFthLWZcZF17Mn0pKFthLWZcZF17Mn0pJC9pLmV4ZWMoaGV4KTsKICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQgPyB7CiAgICAgICAgICAgICAgICAgICAgcjogcGFyc2VJbnQocmVzdWx0WzFdLCAxNiksCiAgICAgICAgICAgICAgICAgICAgZzogcGFyc2VJbnQocmVzdWx0WzJdLCAxNiksCiAgICAgICAgICAgICAgICAgICAgYjogcGFyc2VJbnQocmVzdWx0WzNdLCAxNikKICAgICAgICAgICAgICAgIH0gOiBudWxsOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgb2Zmc2V0WCA9IDA7CiAgICAgICAgICAgIHZhciBvZmZzZXRZID0gMDsKICAgICAgICAgICAgZnVuY3Rpb24gbWFwQ29vcmRzKG1pbl94LCBtaW5feSwgbWF4X3gsIG1heF95KSB7CiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdtYXAnLG1heF94LW1pbl94KTsKICAgICAgICAgICAgICAgIGlmIChtYXhfeCAtIG1pbl94ID4gMTQwMDApIHsKICAgICAgICAgICAgICAgICAgICBvZmZzZXRYID0gbWluX3g7CiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WSA9IG1pbl95OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhleShidWYsIHgsIHkpIHsKICAgICAgICAgICAgICAgIGlmIChzdG9wTW92ZSkgewogICAgICAgICAgICAgICAgICAgIHZhciBtaWRYID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWlkWSA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1pblggPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBtaW5ZID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF4WCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1heFkgPSAwOwogICAgICAgICAgICAgICAgICAgIGZvciAoaW5kZXggaW4gcSkgey8vQUdBUkJPVE9WSCBwYXMgb3VibGllciBtb2RpZiBxCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYWxsID0gcVtpbmRleF07Ly9BR0FSQk9UT1ZIIHBhcyBvdWJsaWVyIG1vZGlmIHEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFggPSBiYWxsLng7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5YID0gYmFsbC54OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4WSA9IGJhbGwueTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblkgPSBiYWxsLnk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhYID0gTWF0aC5tYXgobWF4WCwgYmFsbC54KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pblggPSBNYXRoLm1pbihtaW5YLCBiYWxsLngpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4WSA9IE1hdGgubWF4KG1heFksIGJhbGwueSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5ZID0gTWF0aC5taW4obWluWSwgYmFsbC55KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBtaWRYID0gKG1pblggKyBtYXhYKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgbWlkWSA9IChtaW5ZICsgbWF4WSkgLyAyOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyZXBsYWNlJyx4LHksICdwYXIgJyxtaWRYLG1pZFkpOwoKICAgICAgICAgICAgICAgICAgICBidWYuc2V0SW50MzIoMSwgbWlkWCwgITApOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRJbnQzMig1LCBtaWRZLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldFVpbnQzMig5LCAwLCAhMCk7CiAgICAgICAgICAgICAgICAgICAgc2VuZEJ1ZmZlcihidWYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYnVmLnNldEludDMyKDEsIHgsICEwKTsKICAgICAgICAgICAgICAgICAgICBidWYuc2V0SW50MzIoNSwgeSwgITApOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5zZXRVaW50MzIoOSwgMCwgITApOwogICAgICAgICAgICAgICAgICAgIHNlbmRCdWZmZXIoYnVmKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vQUdBUkJPVE9WSCBjaGFuZ2VyIGF1c3NpIOdhIHNpIG1lcCBkZSBzY3JpcHQKICAgICAgICAgICAgICAgIC8veCAvIHZhID0gKFggLSB0IC8gMikgLyBsICsgeTsKICAgICAgICAgICAgICAgIC8veSAvIHdhID0gKFkgLSB1IC8gMikgLyBsICsgegogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnQ0FMQ1VMIFggPSAnLFgsdCxsLHksJ3Rlc3QnLChYIC0gdCAvIDIpIC8gbCk7CgogICAgICAgICAgICAgICAgaWYgKCBjb25uZWN0ZWQgKSB7CiAgICAgICAgICAgICAgICBpZiAobWZnaCkgewogICAgICAgICAgICAgICAgICAgIGJnei5zZW5kKEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbiI6IDcsCiAgICAgICAgICAgICAgICAgICAgICAgICJ4IjogeCAtIG9mZnNldFgsCiAgICAgICAgICAgICAgICAgICAgICAgICJ5IjogeSAtIG9mZnNldFksCiAgICAgICAgICAgICAgICAgICAgICAgICJpcCIgOiBpcF9jbGllbnQKICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFtZmdoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbGwgPSBxWzBdOwogICAgICAgICAgICAgICAgICAgIGlmIChiYWxsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmd6LnNlbmQoSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbiI6IDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAieCI6IGJhbGwueCAtIG9mZnNldFgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAieSI6IGJhbGwueSAtIG9mZnNldFksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaXAiIDogaXBfY2xpZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbW91c2UgaW4gJyx4LHksJ3Rlc3QnLHgtd2luZG93Lm1hcC5taW5YLHktd2luZG93Lm1hcC5taW5ZLCdtYXAnLHdpbmRvdy5tYXApOwoKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciBiYXNlU2V0TmljayA9IHdpbmRvLnNldE5pY2s7CiAgICAgICAgICAgIHdpbmRvLnNldE5pY2sgPSBmdW5jdGlvbiAobikgewogICAgICAgICAgICAgICAgYmFzZVNldE5pY2sobik7CiAgICAgICAgICAgICAgICBpZiAoeHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHt9OwogICAgICAgICAgICAgICAgICAgIGUuYWN0aW9uID0gMzsKICAgICAgICAgICAgICAgICAgICBlLnBsYXllck5hbWUgPSBuOwogICAgICAgICAgICAgICAgICAgIGJ0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEVORCBDVVNUT00KICAgICAgICB9CiAgICB9KSh3aW5kb3csIHdpbmRvdy5qUXVlcnkpOwo=';


var removed = false;

var d = function(a) {
	if (a.src.indexOf('main_out.js') >= 0) {
		window.ok = true;
		a.parentNode.removeChild(a);
		removed = true;
		console.log('AGARBOT - removed their script');
		var b = document.createElement('script');
		b.innerHTML = window.atob(engine);
		document.head.appendChild(b)
		console.log('AGARBOTDEBUG - added ours');
	}
};
var observer = new window.WebKitMutationObserver(function(b) {
	b.forEach(function(a) {
		for (var i = 0; i < a.addedNodes.length; ++i) {
			try {
				d(a.addedNodes[i]);
			} catch (e) {
			}
		}
	});
});
observer.observe(window.document, {
	subtree : true,
	childList : true,
	attribute : false
});
var x = false;
window.onload = function() {
	$("span[data-itr=option_show_mass]").prev()[0].checked = true;
	// setShowMass(true);
	var a = document.getElementById('gamemode').getElementsByTagName('option');
	if (a.length > 0) {
		for (var i = 0; i < a.length; i++) {
			if (a[i].getAttribute('data-itr') != 'party') {
				a[i].innerHTML += ' (Bots not working)';
			}
		}
	}
	if (!document.contains(document.getElementById('minions'))) {
		var b = document.createElement('div');
		b.id = 'minions';
		b.style.cssText = "position: absolute;top: 10px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  background-color: rgba(0, 0, 0, 0.65);width: 220px; height: 185px; ";
		if (window.infos == undefined)
			window.infos = 'D-Bots.com : connecting... (try to refresh your page)';
		//b.innerHTML = window.infos;
        var a = document.createElement('div');
        var c = document.createElement('div');
        var d = document.createElement('div');
        var e = document.createElement('div');
        var f = document.createElement('div');
        var g = document.createElement('div');
        var h = document.createElement('div');
        var i = document.createElement('div');
        var j = document.createElement('div');
        var k = document.createElement('div');
        var l = document.createElement('div');
        
        
        var w = window.innerWidth - 220;
       
        
        a.style.cssText = "position: absolute;top: 100px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  ";
        c.style.cssText = "position: absolute;top: 75px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  ";
        d.style.cssText = "position: absolute;top: 75px;right: " + w + "px;padding: 0 8px;background-color: blue; font-family: 'Ubuntu'; color: white; ";
        e.style.cssText = "position: absolute;top: 100px;right: " + w + "px;padding: 0 8px;font-family: 'Ubuntu';background-color: yellow;  ";
        f.style.cssText = "position: absolute;top: 125px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  ";
        g.style.cssText = "position: absolute;top: 150px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  ";
        h.style.cssText = "position: absolute;top: 125px;right: " + w + "px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  background-color: red";
        i.style.cssText = "position: absolute;top: 150px;right: " + w + "px;padding: 0 8px;font-family: 'Ubuntu'; color: white; background-color:red ";
        j.style.cssText = "position: absolute;top: 30px;left: 65px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  text-decoration: underline; font-size: 120% ";
        k.style.cssText = "position: absolute;top: 175px;right: " + w + "px;padding: 0 8px;font-family: 'Ubuntu'; color: white;";
        l.style.cssText = "position: absolute;top: 175px;left: 10px;padding: 0 8px;font-family: 'Ubuntu'; color: white;  ";
       
        
        a.id = 'bots';
        f.id = 'mouse';
        g.id = 'move';
        c.id = 'time';
        d.id = 'time_left';
        e.id = 'bot_count';
        h.id = 'mouse_off';
        i.id = 'move_off';
        j.id = 'd-bots-header';
        k.id = 'ip_text';
        l.id = 'ip';
        
        a.innerHTML = 'Bots:';
        c.innerHTML = 'Time left:';
        d.innerHTML = 'Not Connected';
        e.innerHTML = '0';
        f.innerHTML = 'Mouse Control:';
        g.innerHTML = 'Stop Move:';
        h.innerHTML = 'OFF';
        i.innerHTML = 'OFF';
        j.innerHTML = 'D-Bots.com';
        k.innerHTML = 'none';
        l.innerHTML = 'IP:';
        
        document.body.appendChild(b);
        document.body.appendChild(a);
        document.body.appendChild(d);
        document.body.appendChild(e);
        document.body.appendChild(c);
        document.body.appendChild(f);
        document.body.appendChild(g);
        document.body.appendChild(i);
        document.body.appendChild(h);
        document.body.appendChild(j);
        document.body.appendChild(k);
        document.body.appendChild(l);
        
		/*
		 * setTimeout(function(){ b.innerHTML = ''; },15000);
		 */
	}
    
    var key = localStorage.getItem('key');
    
   
    
	$("span[data-itr=instructions_w]")
			.append(
					'<br /><span style="font-size=xx-large;color:red;font-weight:bold">BOT INFO:</span><br />No plan active ? Check that you have correctly updated your IP ?<br />Press <b>T</b> to togle mouse movement<br />Press <b>S</b> to fast eject mass<br />Press <b>R</b> to eject mass from your bot<br />Press <b>E</b> to split your bot (<b>Shift+E</b> fastSplit bots)<br />Press <b>D</b> to stop moving<br />Press <b>Shift+space</b> to fast split<br />Features : Infinite zoom<br />')
			.append(
					'<span style="color:red">FFA WITH BOTS IS NOT WORKING</span><br />You need to enter the game for the bots to connect,if the bot isn\'t working try to refresh the page<br /><br /><a href="http://d-bots.com">D-Bots.com</a> Disclaimer : <br />Remember that we have no link of any sort with agar.io and the bots can suddenly stop working if agar.io update its game. We will try our best to have our bot solution working and we won\'t refund you if its not.');
	$('#openfl-overlay').remove()
};
